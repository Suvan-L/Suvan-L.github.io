<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
    
  
  <link href="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />




  
  
  
  

  

  

  

  

  

  






  

<link href="https://cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="MyProject," />





  <link rel="alternate" href="/atom.xml" title="Suvan" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="前言用时2天半左右，写了一个批量生成目录文件的 demo（BatchCreate_file【自动生成】）不算太简洁，目的是为了重点巩固基础，还有很大进步的空间 自己写了一些基础,常用的 method，封装进不同的类里 一.用于测试的主方法: testMain.java二.任务流程: TaskFlow.java三.连接，操作数据库：UseDB四.操作文件,目录：IOFile.java五.创建文件，改">
<meta name="keywords" content="MyProject">
<meta property="og:type" content="article">
<meta property="og:title" content="BatchCreate file">
<meta property="og:url" content="http://suvan-l.github.io/2017/01/09/MyProject_ BatchCreate file/index.html">
<meta property="og:site_name" content="Suvan">
<meta property="og:description" content="前言用时2天半左右，写了一个批量生成目录文件的 demo（BatchCreate_file【自动生成】）不算太简洁，目的是为了重点巩固基础，还有很大进步的空间 自己写了一些基础,常用的 method，封装进不同的类里 一.用于测试的主方法: testMain.java二.任务流程: TaskFlow.java三.连接，操作数据库：UseDB四.操作文件,目录：IOFile.java五.创建文件，改">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-01-17T03:24:04.301Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BatchCreate file">
<meta name="twitter:description" content="前言用时2天半左右，写了一个批量生成目录文件的 demo（BatchCreate_file【自动生成】）不算太简洁，目的是为了重点巩固基础，还有很大进步的空间 自己写了一些基础,常用的 method，封装进不同的类里 一.用于测试的主方法: testMain.java二.任务流程: TaskFlow.java三.连接，操作数据库：UseDB四.操作文件,目录：IOFile.java五.创建文件，改">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://suvan-l.github.io/2017/01/09/MyProject_ BatchCreate file/"/>





  <title>BatchCreate file | Suvan</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Suvan</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">blog</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://suvan-l.github.io/2017/01/09/MyProject_ BatchCreate file/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="刘淑玮">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/suvan-min.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Suvan">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">BatchCreate file</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-09T18:21:23+08:00">
                2017-01-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MyProject/" itemprop="url" rel="index">
                    <span itemprop="name">MyProject</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  36,334
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  179
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>用时2天半左右，写了一个批量生成目录文件的 demo（BatchCreate_file【自动生成】）<br>不算太简洁，目的是为了重点巩固基础，还有很大进步的空间</p>
<p>自己写了一些基础,常用的 method，封装进不同的类里</p>
<p>一.用于测试的主方法: <em>testMain.java</em><br>二.任务流程: <em>TaskFlow.java</em><br>三.连接，操作数据库：<em>UseDB</em><br>四.操作文件,目录：<em>IOFile.java</em><br>五.创建文件，改变文件内容: <em>ChangeFile.java</em><br>六.两套相关模版:<br>七.设计数据库:</p>
<p>如果有错误或者逻辑比较混乱的地方，欢迎探讨指出^_^</p>
<hr>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><ul>
<li>版本1.0【2016.8.27】</li>
<li>版本2.0【2016.11.15】</li>
<li>版本【3.0】 2016.11.27</li>
<li>5.3版【2017.1.9】</li>
<li>5.4版【2017.1.9下午】</li>
</ul>
<h2 id="版本1-0【2016-8-27】"><a href="#版本1-0【2016-8-27】" class="headerlink" title="版本1.0【2016.8.27】"></a>版本1.0【2016.8.27】</h2><h3 id="1-testMain-java"><a href="#1-testMain-java" class="headerlink" title="1.testMain.java"></a>1.testMain.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">package review;</div><div class="line"></div><div class="line">public class testMain &#123;</div><div class="line">  </div><div class="line"></div><div class="line">  //main()方法，测试</div><div class="line">  public static void main(String [] args)&#123;</div><div class="line">  </div><div class="line">    //创建任务流程对象</div><div class="line">    TaskFlow tf= new TaskFlow();</div><div class="line">    </div><div class="line">    //执行流程(参数:路径,目录名)</div><div class="line">    tf.GO(&quot;C:/Users/Liu-shuwei/Desktop\\&quot;,&quot;刘淑玮-第二批(03069-03127)&quot;,&quot;SX&quot;);</div><div class="line"></div><div class="line">      </div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="2-TaskFlow-java"><a href="#2-TaskFlow-java" class="headerlink" title="2. TaskFlow.java"></a>2. TaskFlow.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">package review;</div><div class="line"></div><div class="line">public class TaskFlow &#123;</div><div class="line">  </div><div class="line">  public static long  useTime()&#123;</div><div class="line">    return System.currentTimeMillis();</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  //无参构造方法</div><div class="line">  public TaskFlow()&#123;</div><div class="line">    </div><div class="line">    </div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  //任务流程</div><div class="line">  public void GO(String path,String name,String province) &#123;</div><div class="line">    //开始时间</div><div class="line">    long beginTime=useTime();</div><div class="line">    </div><div class="line">    //执行任务流程</div><div class="line">    try&#123;</div><div class="line">      UseDB udb = new UseDB();</div><div class="line">      IOFile iof=new IOFile();</div><div class="line">      </div><div class="line">      udb.connDatabase();//连接数据库</div><div class="line">      </div><div class="line">      //一.往数据库插入模版数据</div><div class="line">      String content=null;                                      //注意，路径的话用/或者\\都可以</div><div class="line">      content=iof.readFileContent(&quot;C:/Users/Liu-shuwei/Desktop/模版文档(修改过)/BackupTask.java&quot;,&quot;UTF-8&quot;); //数据库的默认编码是GBK,如果是UTF-8\</div><div class="line">      udb.insertTXT(&quot;article&quot;,&quot;model,detail&quot;,&quot;BackupTask&amp;&amp;&amp;&amp;&amp;&quot;+content,&quot;?,?&quot;);</div><div class="line">      content=iof.readFileContent(&quot;C:/Users/Liu-shuwei/Desktop/模版文档(修改过)/ZhaobGgServiceModel.java&quot;,&quot;UTF-8&quot;); </div><div class="line">      udb.insertTXT(&quot;article&quot;,&quot;model,detail&quot;,&quot;ZhaobGgServiceModel&amp;&amp;&amp;&amp;&amp;&quot;+content,&quot;?,?&quot;);</div><div class="line"></div><div class="line">      </div><div class="line">      //二.创建整体目录</div><div class="line">      iof.cList(path,name,province);</div><div class="line">      </div><div class="line">      //关闭资源</div><div class="line">      udb.closeAll();</div><div class="line">      </div><div class="line">    &#125;catch(Exception e)&#123;</div><div class="line">      e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //结束时间</div><div class="line">    long endTime=useTime();</div><div class="line">    System.out.println(&quot;总共用时:&quot;+(endTime-beginTime)+&quot;毫秒！&quot;);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="3-UseDB-java"><a href="#3-UseDB-java" class="headerlink" title="3. UseDB.java"></a>3. UseDB.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div></pre></td><td class="code"><pre><div class="line">package review;</div><div class="line"></div><div class="line">import java.sql.Connection;</div><div class="line">import java.sql.DriverManager;</div><div class="line">import java.sql.PreparedStatement;</div><div class="line">import java.sql.ResultSet;</div><div class="line">import java.sql.ResultSetMetaData;</div><div class="line">import java.sql.SQLException;</div><div class="line">import java.sql.Statement;</div><div class="line"></div><div class="line">public class UseDB &#123;</div><div class="line">  </div><div class="line">  </div><div class="line">  private String drive=&quot;com.mysql.jdbc.Driver&quot;;           //数据库驱动</div><div class="line">  private String link=&quot;jdbc:mysql://127.0.0.1:3306/&quot;;     //mysql—JDBC链接+IP地址+端口</div><div class="line">  private String database=&quot;my_blog&quot;;                      //数据库</div><div class="line">  </div><div class="line">  private String username=&quot;root&quot;;                         //用户名</div><div class="line">  private String password=&quot;123&quot;;            //密码</div><div class="line">  </div><div class="line">  private Connection conn;</div><div class="line">  private Statement st;</div><div class="line">  private PreparedStatement pst;</div><div class="line">  private ResultSet rs;</div><div class="line">  private ResultSetMetaData rsmd;//获取列的信息</div><div class="line">  </div><div class="line">  private String sql; //sql语句</div><div class="line">  </div><div class="line"></div><div class="line">  //无参构造方法，创建UseDB对象时候，直接连接数据库</div><div class="line">  public UseDB()&#123; </div><div class="line"></div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  //调用该方法时候连接数据库</div><div class="line">  public void connDatabase()  throws Exception&#123;</div><div class="line">     Class.forName(drive);</div><div class="line">     conn=DriverManager.getConnection(link+database,username,password); </div><div class="line">     st=conn.createStatement();</div><div class="line">     System.out.println(&quot;数据库连接成功......&quot;);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">    //功能1: 使用database数据库                                </div><div class="line">    public void useDatabase(String database)&#123;//参数: 数据库名称</div><div class="line">      sql=&quot;USE &quot;+database+&quot;;&quot;;</div><div class="line">      try&#123;</div><div class="line">        rs=st.executeQuery(sql);</div><div class="line">      &#125;catch(Exception e)&#123;</div><div class="line">        e.printStackTrace();</div><div class="line">      &#125;</div><div class="line">      System.out.println(sql+&quot; 执行完毕！-------------------------------------&quot;);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //功能2:查询table表中record字段满足condition条件的值</div><div class="line">    public String select(String table,String record,String condition)&#123;//参数: 表名,字段名,WHERE条件</div><div class="line">      </div><div class="line">      StringBuilder sb= new StringBuilder();</div><div class="line">      sql=&quot;SELECT &quot;+record+&quot; FROM &quot; +table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">      </div><div class="line">      try&#123;</div><div class="line">        rs=st.executeQuery(sql);</div><div class="line">           ResultSetMetaData rsm =rs.getMetaData(); //获得列集</div><div class="line">        while(rs.next())&#123;</div><div class="line">          sb.append(rs.getString(record));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">      &#125;catch(Exception e)&#123;</div><div class="line">        e.printStackTrace();</div><div class="line">      &#125;</div><div class="line">      System.out.println(sql+&quot; 执行完毕！-------------------------------------&quot;);</div><div class="line">      return sb.toString();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //功能3:查询table所有数据的数据,打印到控制台</div><div class="line">    public String selectAll(String table)&#123;//参数: 表名</div><div class="line">      </div><div class="line">      StringBuilder sb= new StringBuilder();</div><div class="line">      sql=&quot;SELECT * FROM &quot; +table+&quot;;&quot;;</div><div class="line">      </div><div class="line">      try&#123;</div><div class="line">        rs=st.executeQuery(sql);</div><div class="line">        rsmd =rs.getMetaData(); //获得列集</div><div class="line">        while(rs.next())&#123;</div><div class="line">          for(int i=1;i&lt;rsmd.getColumnCount();i++)&#123;</div><div class="line">            System.out.print(rs.getString(i)+&quot;\t&quot;);</div><div class="line">          &#125;</div><div class="line">          System.out.println();//换行</div><div class="line">        &#125;</div><div class="line"></div><div class="line">      &#125;catch(Exception e)&#123;</div><div class="line">        e.printStackTrace();</div><div class="line">      &#125;</div><div class="line">      System.out.println(sql+&quot; 执行完毕！-------------------------------------&quot;);</div><div class="line">      return sb.toString();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    </div><div class="line">    //功能4:查询webapi表,判断招标预告到控制价字段的记录值是否存在URL  ,返回有URL记录的字段名(例如:zbgg)</div><div class="line">    public String checktable(String num)&#123;//参数: 编号</div><div class="line">      StringBuilder sb= new StringBuilder();</div><div class="line">      sql=&quot;SELECT * FROM webapi WHERE num=&apos;&quot;+num+&quot;&apos;;&quot;;</div><div class="line">      String content=null;</div><div class="line">      try&#123;</div><div class="line">        rs=st.executeQuery(sql);</div><div class="line">        rsmd=rs.getMetaData();</div><div class="line">        while(rs.next())&#123;</div><div class="line">          for(int i=10;i&lt;18;i++)&#123;</div><div class="line">            content=rs.getString(i);</div><div class="line">            if(content.length()&lt;5) continue;</div><div class="line">              </div><div class="line">              sb.append(rsmd.getColumnName(i)+&quot;&amp;&quot;); </div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      </div><div class="line">      &#125;catch(SQLException e)&#123;</div><div class="line">        e.printStackTrace();</div><div class="line">      &#125;</div><div class="line">      System.out.println(sql+&quot; 执行完毕！-------------------------------------&quot;);</div><div class="line">      return sb.toString();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">    //功能5:查询table表,record字段的所有记录值(所有行)</div><div class="line">    public String selectNum(String table,String record) throws SQLException&#123;</div><div class="line">      StringBuilder sb= new StringBuilder();</div><div class="line">      </div><div class="line">       sql=&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot;;&quot;;</div><div class="line">       rs=st.executeQuery(sql);</div><div class="line">       while(rs.next())&#123;</div><div class="line">         sb.append(rs.getString(1)+&quot;&amp;&quot;);</div><div class="line">       &#125;</div><div class="line">       </div><div class="line">      System.out.println(sql+&quot; 执行完毕！-------------------------------------&quot;);</div><div class="line">      return sb.toString();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">    //功能6: 插入数据--少量数据(标题，日期等)</div><div class="line">    public void insert(String table,String record,String content)&#123;//参数: 表名,字段(多的话用,分割),内容(多的话用,号分割)</div><div class="line">        String sql=&quot;INSERT INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+content+&quot;);&quot;;</div><div class="line">          int i=0;</div><div class="line">          try&#123;</div><div class="line">            i=st.executeUpdate(sql);</div><div class="line">            </div><div class="line">          &#125;catch(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">          &#125;</div><div class="line"></div><div class="line">          if(i!=-1)&#123;</div><div class="line">            System.out.println(&quot;插入成功&quot;);</div><div class="line">          &#125;</div><div class="line">        System.out.println(sql+&quot;执行完毕！&quot;);</div><div class="line">      &#125;</div><div class="line">    </div><div class="line">    //功能7:插入数据--大量数据(文章，文本内容)</div><div class="line">    public void insertTXT(String table,String record,String content,String mark)&#123;//参数值: 表名,字段,内容(多个内容用&amp;号分割),?号(多个?用,分割)</div><div class="line">      </div><div class="line">      sql=&quot;INSERT INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+mark+&quot;);&quot;;</div><div class="line">      </div><div class="line">      String [] strA=content.split(&quot;&amp;&amp;&amp;&amp;&amp;&quot;);</div><div class="line">      //判断是否存在相同记录，如果存在则不执行插入</div><div class="line">      String ifwhere=record.substring(0,record.indexOf(&quot;,&quot;));</div><div class="line">      String ifexist=&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot; WHERE &quot;+ifwhere+&quot;=&apos;&quot;+strA[0]+&quot;&apos;;&quot;;</div><div class="line">        </div><div class="line">      try&#123;</div><div class="line">        rs=st.executeQuery(ifexist);</div><div class="line">        System.out.println(ifexist+&quot; 执行完毕！================================&quot;);</div><div class="line">        </div><div class="line">        if(rs.next())&#123;//存在相同记录</div><div class="line">          System.out.println(&quot;数据库中已经存在相同&quot;+strA[0]+&quot;模版,不进行重复插入!&quot;);</div><div class="line">        &#125;else&#123;</div><div class="line">          //不存在相同记录</div><div class="line">          System.out.println(&quot;数据库不存在&quot;+strA[0]+&quot;模版,正在进行插入......&quot;);</div><div class="line">          pst=conn.prepareStatement(sql);</div><div class="line">          </div><div class="line">          for(int i=1;i&lt;=strA.length;i++)&#123;//循环次数: ?号个数      </div><div class="line">            pst.setString(i,strA[i-1]);</div><div class="line">          &#125;</div><div class="line">          </div><div class="line">          pst.executeUpdate();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">      &#125;catch(Exception e)&#123;</div><div class="line">        e.printStackTrace();</div><div class="line">      &#125;</div><div class="line">      </div><div class="line">      System.out.println(sql+&quot; 执行完毕！================================&quot;);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">  </div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">    //功能8: 查询数据库weiabi表中对应num编号整行记录的需求字段的信息(区域，省份，城市，区县，网站名称，信息来源)</div><div class="line">    public String selectNeedInformation_num(String num)&#123;</div><div class="line">        StringBuilder sb= new StringBuilder();</div><div class="line">      </div><div class="line">      sql=&quot;SELECT * FROM webapi WHERE num=&apos;&quot;+num+&quot;&apos;;&quot;;</div><div class="line">      try&#123;</div><div class="line">        rs=st.executeQuery(sql);</div><div class="line">        while(rs.next())&#123;</div><div class="line">          for(int i=2;i&lt;=8;i++)&#123; //区域-信息来源</div><div class="line">            if(i==7) continue; //网站网址</div><div class="line">            sb.append(rs.getString(i)+&quot;&amp;&quot;);</div><div class="line">          &#125;   </div><div class="line">        &#125;</div><div class="line">      &#125;catch(Exception e)&#123;</div><div class="line">        e.printStackTrace();</div><div class="line">      &#125;</div><div class="line">      </div><div class="line">      System.out.println(sql+&quot; 执行完毕！-------------------------------------&quot;);</div><div class="line">      return sb.toString(); </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //关闭数据库连接</div><div class="line">    public void closeAll()&#123;</div><div class="line">      </div><div class="line">      //关闭Result</div><div class="line">       try&#123;</div><div class="line">                if(rs!=null)</div><div class="line">                     rs.close();</div><div class="line">             &#125;catch(Exception e)&#123;</div><div class="line">                 e.printStackTrace(System.err);</div><div class="line">             &#125;</div><div class="line">       </div><div class="line">       </div><div class="line">      //关闭PreparedStatement</div><div class="line">      try&#123;</div><div class="line">      if(pst!=null)</div><div class="line">                  pst.close();</div><div class="line">            &#125;catch(Exception e)&#123;</div><div class="line">               e.printStackTrace(System.err);</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">      </div><div class="line">      //关闭Statement</div><div class="line">       try&#123;</div><div class="line">                 if(st!=null)</div><div class="line">                     st.close();</div><div class="line">             &#125;catch(Exception e)&#123;</div><div class="line">                 e.printStackTrace(System.err);</div><div class="line">             &#125;</div><div class="line">      </div><div class="line">       </div><div class="line">       //关闭Connection</div><div class="line">           try&#123;</div><div class="line">               if(conn!=null)</div><div class="line">                   conn.close();</div><div class="line">           &#125;catch(Exception e)&#123;</div><div class="line">               e.printStackTrace(System.err);</div><div class="line">           &#125;</div><div class="line">    </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="4-IOFile-java"><a href="#4-IOFile-java" class="headerlink" title="4. IOFile.java"></a>4. IOFile.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div></pre></td><td class="code"><pre><div class="line">package review;</div><div class="line"></div><div class="line">import java.io.File;</div><div class="line">import java.io.FileInputStream;</div><div class="line">import java.io.FileOutputStream;</div><div class="line">import java.io.IOException;</div><div class="line">import java.io.InputStream;</div><div class="line">import java.io.InputStreamReader;</div><div class="line">import java.io.OutputStreamWriter;</div><div class="line"></div><div class="line">public class IOFile &#123;</div><div class="line">  </div><div class="line">    //功能1:(字节流)读取文件内容--只适用与读取英文，数字，无法设置编码格式</div><div class="line">    public String readFileContent2(String path) throws IOException&#123; //参数:路径</div><div class="line">      String content=&quot;&quot;;</div><div class="line">      </div><div class="line">      InputStream inf=new FileInputStream(path);</div><div class="line">      int size=inf.available();</div><div class="line">      for(int i=0;i&lt;size;i++)&#123;</div><div class="line">        content+=(char)inf.read();</div><div class="line">      &#125;</div><div class="line">      </div><div class="line">      return &quot;\&apos;&quot;+content+&quot;\&apos;&quot;; </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //功能2:(字符流)读取文件内容--可以设置编码，读取中文，英文，数字</div><div class="line">      public String readFileContent(String path,String encoding) throws IOException&#123; //参数: 路径,编码格式</div><div class="line">        StringBuilder sb =new StringBuilder();</div><div class="line">          </div><div class="line">          //定位文件</div><div class="line">          File f=new File(path);</div><div class="line">          FileInputStream fip=new FileInputStream(f);</div><div class="line">          InputStreamReader reader=new InputStreamReader(fip,encoding);</div><div class="line">          </div><div class="line">          while(reader.ready())&#123;</div><div class="line">            sb.append((char)reader.read());</div><div class="line">          &#125;</div><div class="line">          </div><div class="line">        return sb.toString(); </div><div class="line">       &#125;    </div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">    //功能3: 获得路径，创建目录</div><div class="line">    public void createFile(String path)&#123;</div><div class="line">      File d=new File(path);</div><div class="line">          d.mkdir();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //功能4: 创建文件,写入内容</div><div class="line">    public void cFile(String path,String fileName,String encoding,String content) throws IOException&#123; //参数：路径,文件名.格式,编码格式,文件内容</div><div class="line">      File f=new File(path+&quot;/&quot;+fileName);</div><div class="line">      FileOutputStream fop= new FileOutputStream(f);</div><div class="line">      OutputStreamWriter writer=new OutputStreamWriter(fop,&quot;UTF-8&quot;);</div><div class="line">      </div><div class="line">      writer.append(content);</div><div class="line">      </div><div class="line">      writer.close();</div><div class="line">      fop.close();</div><div class="line">      System.out.println(&quot;文件创建完毕&quot;);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //功能5: 自定义创建目录(标准格式提交,例如:刘淑玮-第二批(02307-02370))</div><div class="line">    public void cList(String path,String fileName,String province) throws Exception&#123; //参数：路径 ,文件名</div><div class="line">      </div><div class="line">        //一.创建对象  1.连接数据库  2.改变文件</div><div class="line">        UseDB u =new UseDB();</div><div class="line">        u.connDatabase();</div><div class="line">        ChangeFile cf=new ChangeFile(u);</div><div class="line">      </div><div class="line">        //二.创建父目录</div><div class="line">        String dir=path+&quot;/&quot;+fileName;</div><div class="line">        createFile(dir);</div><div class="line">            </div><div class="line">        //三.获得编号,储存起始编号，终止编号</div><div class="line">            String number=fileName.substring(fileName.indexOf(&quot;(&quot;)+1,fileName.lastIndexOf(&quot;)&quot;));</div><div class="line">            String [] num=number.split(&quot;-&quot;);</div><div class="line">            int first=Integer.parseInt(num[0]);</div><div class="line">            int last=Integer.parseInt(num[1]);</div><div class="line">            </div><div class="line">            //获取使用者名字</div><div class="line">            String username=fileName.substring(0,fileName.indexOf(&quot;-&quot;));</div><div class="line">              </div><div class="line">            </div><div class="line">            //四.查询webapi表里num字段所有记录，将其保存在数组里</div><div class="line">            u.useDatabase(&quot;my_blog&quot;);//使用my_blog数据库</div><div class="line">            String allNum=u.selectNum(&quot;webapi&quot;,&quot;num&quot;);</div><div class="line">          String [] allNumA=allNum.split(&quot;&amp;&quot;);</div><div class="line">           </div><div class="line">          //五.计算webapi中num个数(包括带-的)</div><div class="line">          int sum=0;</div><div class="line">          String allNumber=u.selectNum(&quot;webapi&quot;,&quot;num&quot;);</div><div class="line">          String [] allNumber_Arrays=allNumber.split(&quot;&amp;&quot;);</div><div class="line">          for(int i=0;i&lt;allNumber_Arrays.length;i++)&#123;</div><div class="line">            if(i&gt;1)&#123;</div><div class="line">              if(!allNumber_Arrays[i].substring(0,5).equals(allNumber_Arrays[i-1].substring(0,5)))</div><div class="line">                sum++;</div><div class="line">              else</div><div class="line">                continue;</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">            </div><div class="line">            //六.生成1级子目录      规格:&quot;接口(n个)&amp;入库(n个)&amp;入库-增量(n个)&quot;</div><div class="line">                </div><div class="line">                String [] str=&#123;&quot;接口&quot;,&quot;入库&quot;,&quot;入库-增量&quot;&#125;;</div><div class="line">                String sonFile=null;//1级子目录</div><div class="line">                String sonFile2=null;//2级子目录</div><div class="line">                String ifNum=null;//2级目录判定编号</div><div class="line">                </div><div class="line">                for(int i=0;i&lt;str.length;i++)&#123;   </div><div class="line">                  sonFile=dir+&quot;/&quot;+str[i]+&quot;(&quot;+sum+&quot;)&quot;;//路径</div><div class="line">                  this.createFile(sonFile);  //循环创建1级子目录</div><div class="line">                  </div><div class="line">                  //进入含有&quot;入库&quot;字样的二级字目录</div><div class="line">                  if(str[i].indexOf(&quot;入库&quot;)!=-1)&#123;</div><div class="line">                    //生成入库编号</div><div class="line">                    for(int j=first;j&lt;=last;j++)&#123; //循环次数：终止编号-起始编号</div><div class="line">                      for(int k=0;k&lt;allNumA.length;k++)&#123; //循环次数：数据库webapi表里num记录的数量</div><div class="line">                        </div><div class="line">                        ifNum=allNumA[k].substring(1,5);</div><div class="line">                        if(ifNum.equals(j+&quot;&quot;))&#123;   //对比输入编号和Excel表里的编号</div><div class="line">                          </div><div class="line">                          sonFile2=sonFile+&quot;/入库-0&quot;+j; </div><div class="line">                          createFile(sonFile2); //创建2级子目录</div><div class="line">                          </div><div class="line">                          if(k==0)</div><div class="line">                            cf.createBackupTask(sonFile2+&quot;/&quot;,province,allNumA[k],allNumA[0]);//创建BackupTask.java</div><div class="line">                          else</div><div class="line">                            cf.createBackupTask(sonFile2+&quot;/&quot;,province,allNumA[k],allNumA[k-1]);//创建BackupTask.java</div><div class="line">                          </div><div class="line">                          sonFile2=sonFile2+&quot;/imp&quot;;</div><div class="line">                          createFile(sonFile2);//创建3级子目录</div><div class="line">                          if(str[i].indexOf(&quot;入库-增量&quot;)!=-1) continue;  //增量不生成入库代码</div><div class="line">                          cf.combineCreateRukuCoding(sonFile2+&quot;/&quot;,province,allNumA[k],username);</div><div class="line">                        &#125;</div><div class="line">                      &#125;</div><div class="line"></div><div class="line">                    &#125;</div><div class="line">                  &#125;</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">           System.out.println(fileName+&quot;目录生成完毕!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&quot;);</div><div class="line">           u.closeAll();//关闭资源</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line"></div><div class="line">    </div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="5-ChangeFile-java"><a href="#5-ChangeFile-java" class="headerlink" title="5. ChangeFile.java"></a>5. ChangeFile.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div></pre></td><td class="code"><pre><div class="line">package review;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line"></div><div class="line"></div><div class="line">public class ChangeFile &#123;</div><div class="line">  </div><div class="line">  private String zhaobYgService=&quot;zhaobYgService&quot;;     //招标预告</div><div class="line">  private String zhaobGgService=&quot;zhaobGgService&quot;;   //招标公告</div><div class="line">  private String zisJgService=&quot;zisJgService&quot;;     //咨审结果</div><div class="line">  private String zhaobWjService=&quot;zhaobWjService&quot;;   //招标文件</div><div class="line">  private String gonggBgService=&quot;gonggBgService&quot;;   //公告变更</div><div class="line">  private String zhaobDyService=&quot;zhaobDyService&quot;;     //招标答疑</div><div class="line">  private String zhongbXxService=&quot;zhongbXxService&quot;; //中标信息</div><div class="line">  private String kongZjService=&quot;kongZjService&quot;;   //控制价</div><div class="line">  </div><div class="line">  private String model; //BackupTask模版语句</div><div class="line"></div><div class="line">  </div><div class="line">  private UseDB udb;</div><div class="line">  private IOFile iof;</div><div class="line">  </div><div class="line">  //getter和Setter方法</div><div class="line">  public String getModel()&#123;</div><div class="line">    return model;</div><div class="line">  &#125;</div><div class="line">  public void setModel(String model)&#123;</div><div class="line">    this.model=model;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  </div><div class="line">  //无参构造方法</div><div class="line">  public ChangeFile(UseDB u) throws Exception&#123;</div><div class="line">    String model=&quot;NameA=(NameB) ac.getBean(\&quot;fileName\&quot;);&quot;;</div><div class="line">    String model2=&quot;NameA.initNameB();&quot;;</div><div class="line">    this.setModel(&quot;\n\t\t&quot;+model+&quot;\n\t\t&quot;+model2+&quot;\n\t\t&quot;);//换行和空格Tab</div><div class="line">    </div><div class="line">    udb=u;</div><div class="line">    iof=new IOFile();</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  </div><div class="line">  //工具1:将首字母变为大写</div><div class="line">  public String UpFirstString(String content)&#123; //参数: 内容</div><div class="line">    String firstLetter=content.substring(0,1);</div><div class="line">    //替换首字母</div><div class="line">    content=content.replaceFirst(firstLetter,firstLetter.toUpperCase());</div><div class="line">    return content;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  //工具1-2:将首字母变为小写</div><div class="line">  public String LowFirstString(String content)&#123; //参数: 内容</div><div class="line">    String firstLetter=content.substring(0,1);</div><div class="line">    //替换首字母</div><div class="line">    content=content.replaceFirst(firstLetter,firstLetter.toLowerCase());</div><div class="line">    return content;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  //工具2:自动生成文件名    </div><div class="line">  public String cFileName(String province,String num,String attributeName)&#123;//参数:省份拼音缩写(大写),编号,相应的属性名</div><div class="line">    StringBuilder sb= new StringBuilder();</div><div class="line">    </div><div class="line">    num=num.replace(&quot;-&quot;,&quot;_&quot;);</div><div class="line">    attributeName=UpFirstString(attributeName);</div><div class="line">    sb.append(LowFirstString(province)+&quot;_&quot;+num+&quot;_&quot;+attributeName);</div><div class="line">    </div><div class="line">    return sb.toString();</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  //工具3:根据BackupTask模版语句,生成相应字符串</div><div class="line">  public String cModelString(String province,String num,String attributeName)&#123;//参数: 省份,编号,相应的属性名</div><div class="line">    StringBuilder sb=new StringBuilder();</div><div class="line">    </div><div class="line">    </div><div class="line">    String fileName=cFileName(province,num,attributeName);</div><div class="line">    String cStr=getModel();</div><div class="line">    cStr=cStr.replace(&quot;NameA&quot;,attributeName).replace(&quot;NameB&quot;,UpFirstString(attributeName)).replace(&quot;fileName&quot;,fileName);</div><div class="line">    </div><div class="line">    sb.append(cStr);</div><div class="line">    return sb.toString();</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  //工具4:生成内容注解</div><div class="line">  public String cContentNode(String infSource,String modelName,String num)&#123;</div><div class="line">    StringBuilder sb= new StringBuilder();</div><div class="line">    </div><div class="line">    //根据模版名字判断类型</div><div class="line">    String type=&quot;&quot;;</div><div class="line">    </div><div class="line">    if(modelName.equals(&quot;zbyg&quot;))&#123;</div><div class="line">      type=&quot;招标预告&quot;;</div><div class="line">    &#125;else if(modelName.equals(&quot;zbgg&quot;))&#123;</div><div class="line">      type=&quot;招标公告&quot;;</div><div class="line">    &#125;else if(modelName.equals(&quot;zsjg&quot;))&#123;</div><div class="line">      type=&quot;咨审结果&quot;;</div><div class="line">    &#125;else if(modelName.equals(&quot;ggbg&quot;))&#123;</div><div class="line">      type=&quot;公告变更&quot;;</div><div class="line">    &#125;else if(modelName.equals(&quot;zbwj&quot;))&#123;</div><div class="line">      type=&quot;招标文件&quot;;</div><div class="line">    &#125;else if(modelName.equals(&quot;zbdy&quot;))&#123;</div><div class="line">      type=&quot;招标答疑&quot;;</div><div class="line">    &#125;else if(modelName.equals(&quot;zbxx&quot;))&#123;</div><div class="line">      type=&quot;中标信息&quot;;</div><div class="line">    &#125;else if(modelName.equals(&quot;kzj&quot;))&#123;</div><div class="line">      type=&quot;招标控制价&quot;;</div><div class="line">    &#125; </div><div class="line">    </div><div class="line">    sb.append(&quot;东软一期-&quot;+infSource+&quot;-&quot;+type+&quot;-&quot;+num);</div><div class="line">    </div><div class="line">    return sb.toString();</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  </div><div class="line">  //工具5: 判断一个编号有需要创建哪些入库代码，循环调用createRukuCoding方法进行</div><div class="line">  public void combineCreateRukuCoding(String path,String province,String num,String username)&#123;//路径,省份拼音首字母(大写),编号，程旭猿</div><div class="line">    </div><div class="line">    </div><div class="line">    //查询数据库，确认类型</div><div class="line">    String type=&quot;&quot;;</div><div class="line">    </div><div class="line">    String ifURL=udb.checktable(num);</div><div class="line">    String [] ifURL_Arrays=ifURL.split(&quot;&amp;&quot;);</div><div class="line">    for(int i=0;i&lt;ifURL_Arrays.length;i++)&#123;</div><div class="line">      createRukuCoding(path,province,num,ifURL_Arrays[i],username);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  </div><div class="line">  //功能1:创建BackupTask.java                                                        (上一个编号，用来处理-)</div><div class="line">  public void createBackupTask (String path,String province,String num,String ageNum)&#123;//参数: 路径,省份拼音缩写,编号,上一个编号</div><div class="line"></div><div class="line">    //一.检查数据库webapi表,对应num(编号)的整条记录，招标预告-招标公告哪个字段有URL</div><div class="line">    String ifURL=udb.checktable(num);</div><div class="line">    String [] ownURLArrays=ifURL.split(&quot;&amp;&quot;);</div><div class="line">    </div><div class="line">    //二.生成相应内容</div><div class="line">    String content=&quot;&quot;; //储存总体字符串</div><div class="line">    String str=&quot;&quot;;     //中转字符串</div><div class="line">    if(ownURLArrays.length==0)&#123;</div><div class="line">      System.out.println(&quot;这个编号为空，不存在url，跳过&quot;);</div><div class="line">    &#125;else&#123;</div><div class="line">      for(int i=0;i&lt;ownURLArrays.length;i++)  //webapi表格里有url的字段</div><div class="line">      &#123;</div><div class="line">        </div><div class="line">        if(ownURLArrays[i].equals(&quot;zbyg&quot;))&#123;</div><div class="line">          str=cModelString(province,num,zhaobYgService);</div><div class="line">        &#125;else if(ownURLArrays[i].equals(&quot;zbgg&quot;))&#123;</div><div class="line">          str=cModelString(province,num,zhaobGgService);</div><div class="line">        &#125;else if(ownURLArrays[i].equals(&quot;zsjg&quot;))&#123;</div><div class="line">          str=cModelString(province,num,zisJgService);</div><div class="line">        &#125;else if(ownURLArrays[i].equals(&quot;ggbg&quot;))&#123;</div><div class="line">          str=cModelString(province,num,gonggBgService);</div><div class="line">        &#125;else if(ownURLArrays[i].equals(&quot;zbwj&quot;))&#123;</div><div class="line">          str=cModelString(province,num,zhaobWjService);</div><div class="line">        &#125;else if(ownURLArrays[i].equals(&quot;zbdy&quot;))&#123;</div><div class="line">          str=cModelString(province,num,zhaobDyService);</div><div class="line">        &#125;else if(ownURLArrays[i].equals(&quot;zbxx&quot;))&#123;</div><div class="line">          str=cModelString(province,num,zhongbXxService);</div><div class="line">        &#125;else if(ownURLArrays[i].equals(&quot;kzj&quot;))&#123;</div><div class="line">          str=cModelString(province,num,kongZjService);</div><div class="line">        &#125;</div><div class="line">                </div><div class="line">        content+=str;</div><div class="line">      &#125;</div><div class="line">      content+=&quot;//ok;&quot;;</div><div class="line">     &#125;</div><div class="line"></div><div class="line">    //三.判断当前编号是否和上一个编号相同</div><div class="line">    boolean sign=false;//设立标示</div><div class="line">    if(num.equals(ageNum) || !num.substring(0,5).equals(ageNum.substring(0,5)))&#123;</div><div class="line">      sign=true;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //四.根据数据库表article表中模版，生成相应编号的文件</div><div class="line">    try&#123;</div><div class="line">      String dbModelBackupTask=udb.select(&quot;article&quot;,&quot;detail&quot;,&quot;model=&apos;BackupTask&apos;&quot;); //储存数据库article表中,BackupTask模版</div><div class="line">    </div><div class="line">      if(sign)&#123;</div><div class="line">        //与上一个编号完全不同(号码不同,且不带-)</div><div class="line">        dbModelBackupTask=dbModelBackupTask.replace(&quot;//changeModel;&quot;,content);</div><div class="line">        iof.cFile(path,&quot;BackupTask.java&quot;,&quot;UTF-8&quot;,dbModelBackupTask);//路径,文件名,编码格式,内容</div><div class="line">      </div><div class="line">      &#125;else&#123;</div><div class="line">        //带-的编号,在上一个文件基础上进行叠加</div><div class="line">        String ageContent=iof.readFileContent(path+&quot;/BackupTask.java&quot;,&quot;UTF-8&quot;);//前一个编号的内容   </div><div class="line">        String changeContent=ageContent.replace(&quot;//ok;&quot;,content);</div><div class="line">        iof.cFile(path,&quot;BackupTask.java&quot;,&quot;UTF-8&quot;,changeContent);</div><div class="line">      &#125;</div><div class="line">      </div><div class="line">    &#125;catch(Exception e)&#123;</div><div class="line">      e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  //功能1:创建相应编号,类型的入库代码</div><div class="line">  public void createRukuCoding(String path,String province,String num,String type,String username)&#123;//参数: 路径,省份拼音首字母缩写,编号,类型,程序猿</div><div class="line">    </div><div class="line">        //一.生成文件名</div><div class="line">        String fileName=&quot;&quot;; //注解名</div><div class="line">        String typeSpell=&quot;&quot;;</div><div class="line">        String typeService=&quot;&quot;;</div><div class="line">        </div><div class="line">          for(int i=0;i&lt;8;i++)  //共8种类型</div><div class="line">          &#123;       </div><div class="line">            if(type.equals(&quot;zbyg&quot;))&#123;</div><div class="line">              fileName=cFileName(province,num,zhaobYgService);</div><div class="line">              typeSpell=&quot;zhaoBiaoYuGao&quot;;</div><div class="line">              typeService=&quot;zhaobYgService&quot;;</div><div class="line">            &#125;else if(type.equals(&quot;zbgg&quot;))&#123;</div><div class="line">              fileName=cFileName(province,num,zhaobGgService);</div><div class="line">              typeSpell=&quot;zhaoBiaoGongGao&quot;;</div><div class="line">              typeService=&quot;zhaobGgService&quot;;</div><div class="line">            &#125;else if(type.equals(&quot;zsjg&quot;))&#123;</div><div class="line">              fileName=cFileName(province,num,zisJgService);</div><div class="line">              typeSpell=&quot;ziShenJieGuo&quot;;</div><div class="line">              typeService=&quot;zisJgService&quot;;</div><div class="line">            &#125;else if(type.equals(&quot;ggbg&quot;))&#123;</div><div class="line">              fileName=cFileName(province,num,gonggBgService);</div><div class="line">              typeSpell=&quot;gongGaoBianGeng&quot;;</div><div class="line">              typeService=&quot;gonggBgService&quot;;</div><div class="line">            &#125;else if(type.equals(&quot;zbwj&quot;))&#123;</div><div class="line">              fileName=cFileName(province,num,zhaobWjService);</div><div class="line">              typeSpell=&quot;&quot;;</div><div class="line">              typeService=&quot;zhaobWjService&quot;;</div><div class="line">            &#125;else if(type.equals(&quot;zbdy&quot;))&#123;</div><div class="line">              fileName=cFileName(province,num,zhaobDyService);</div><div class="line">              typeSpell=&quot;zhaoBiaoWenJian&quot;;</div><div class="line">              typeService=&quot;zhaobDyService&quot;;</div><div class="line">            &#125;else if(type.equals(&quot;zbxx&quot;))&#123;</div><div class="line">              fileName=cFileName(province,num,zhongbXxService);</div><div class="line">              typeSpell=&quot;zhongBiaoXinXi&quot;;</div><div class="line">              typeService=&quot;zhongbXxService&quot;;</div><div class="line">            &#125;else if(type.equals(&quot;kzj&quot;))&#123;</div><div class="line">              fileName=cFileName(province,num,kongZjService);</div><div class="line">              typeSpell=&quot;kongZhiJia&quot;;</div><div class="line">              typeService=&quot;kongZjService&quot;;</div><div class="line">            &#125;       </div><div class="line">         &#125;</div><div class="line">          </div><div class="line">        //首字母变为小写</div><div class="line">        String fileNameL=LowFirstString(fileName);</div><div class="line">        </div><div class="line">        //首字母变为大写</div><div class="line">        String typeSpellUp=UpFirstString(typeSpell);</div><div class="line">        String typeServiceUp=UpFirstString(typeService);</div><div class="line">          </div><div class="line">        //二.查询数据库模版</div><div class="line">        String modelName=fileName.substring(fileName.lastIndexOf(&quot;_&quot;)+1);</div><div class="line">        String modelContent=udb.select(&quot;article&quot;,&quot;detail&quot;,&quot;model=&apos;ZhaobGgServiceModel&apos;&quot;);</div><div class="line">        </div><div class="line">        //三.查询数据库num编号的整行记录,所需要要的信息</div><div class="line">        String information_num=udb.selectNeedInformation_num(num);</div><div class="line">        String [] information_Arrays=information_num.split(&quot;&amp;&quot;);</div><div class="line">        </div><div class="line">        String area=information_Arrays[0];                      //区域</div><div class="line">        String provinceDB=information_Arrays[1].replace(&quot;省&quot;,&quot;&quot;);          //省份(不要省字)</div><div class="line">        String city=information_Arrays[2].replace(&quot;市&quot;,&quot;&quot;);              //城市(不要市字)</div><div class="line">        String county=information_Arrays[3].replace(&quot;区&quot;,&quot;&quot;).replace(&quot;县&quot;,&quot;&quot;);    //区县(不要区,县字)</div><div class="line">        String webname=information_Arrays[4];                   //网站名称</div><div class="line">        String infsource=information_Arrays[5];                   //信息来源</div><div class="line">        </div><div class="line">        //三.生成顶部内容注解</div><div class="line">        String contentNode=cContentNode(infsource,type,num);</div><div class="line">        </div><div class="line">        //四.修改模版</div><div class="line">        String rukuContent=modelContent.replace(&quot;zhaoBiaoGongGao&quot;,typeSpell).replace(&quot;ZhaoBiaoGongGao&quot;,typeSpellUp).replace(&quot;ZhaobGgService&quot;,typeServiceUp).replace(&quot;zhaobGgService&quot;,typeService).replace(&quot;zbgg&quot;,type);</div><div class="line">        //程序猿;</div><div class="line">        rukuContent=rukuContent.replaceFirst(&quot;//程序猿;&quot;,username).replaceFirst(&quot;//注解内容;&quot;,contentNode);</div><div class="line">        rukuContent=rukuContent.replaceFirst(&quot;//注解;&quot;,fileNameL).replaceFirst(&quot;//类名;&quot;,fileName);</div><div class="line">        </div><div class="line">        rukuContent=rukuContent.replaceFirst(&quot;//编号;&quot;,num);</div><div class="line">        </div><div class="line">        rukuContent=rukuContent.replaceFirst(&quot;//area;&quot;,area);</div><div class="line">        rukuContent=rukuContent.replaceFirst(&quot;//provinceDB;&quot;,provinceDB);</div><div class="line">        rukuContent=rukuContent.replaceFirst(&quot;//city;&quot;,city);</div><div class="line">        rukuContent=rukuContent.replaceFirst(&quot;//county;&quot;,county);</div><div class="line">        rukuContent=rukuContent.replaceFirst(&quot;//webname;&quot;,webname);</div><div class="line">        rukuContent=rukuContent.replaceFirst(&quot;//infsource;&quot;,infsource);</div><div class="line">        </div><div class="line">        try&#123;</div><div class="line">          //创建文件</div><div class="line">          iof.cFile(path,fileName+&quot;.java&quot;,&quot;UTF-8&quot;,rukuContent);//路径,文件名,编码格式,内容</div><div class="line">        &#125;catch(IOException e)&#123;</div><div class="line">          e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="6-两套java文件模版"><a href="#6-两套java文件模版" class="headerlink" title="6. 两套java文件模版"></a>6. 两套java文件模版</h3><h4 id="a-BackupTaskt-java"><a href="#a-BackupTaskt-java" class="headerlink" title="a. BackupTaskt.java"></a>a. BackupTaskt.java</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">package com.bonait.dataextract.scheduler;</div><div class="line"></div><div class="line">import org.quartz.JobExecutionContext;</div><div class="line">import org.quartz.JobExecutionException;</div><div class="line">import org.springframework.context.ApplicationContext;</div><div class="line">import org.springframework.context.support.ClassPathXmlApplicationContext;</div><div class="line">import org.springframework.scheduling.quartz.QuartzJobBean;</div><div class="line"></div><div class="line">import com.bonait.dataextract.service.GonggBgService;</div><div class="line">import com.bonait.dataextract.service.KongZjService;</div><div class="line">import com.bonait.dataextract.service.ZhaobDyService;</div><div class="line">import com.bonait.dataextract.service.ZhaobGgService;</div><div class="line">import com.bonait.dataextract.service.ZhaobWjService;</div><div class="line">import com.bonait.dataextract.service.ZhaobYgService;</div><div class="line">import com.bonait.dataextract.service.ZhongbXxService;</div><div class="line">import com.bonait.dataextract.service.ZisJgService;</div><div class="line"></div><div class="line">public class BackupTask extends QuartzJobBean &#123;</div><div class="line"></div><div class="line">  private static ZhaobGgService zhaobGgService;</div><div class="line">  private static ZhongbXxService zhongbXxService;</div><div class="line">  private static ZhaobWjService zhaobWjService;</div><div class="line">  private static ZhaobDyService zhaobDyService;</div><div class="line">  private static ZisJgService zisJgService;</div><div class="line">  private static GonggBgService gonggBgService;</div><div class="line">  private static KongZjService kongZjService;</div><div class="line">  private static ZhaobYgService zhaobYgService;</div><div class="line">  </div><div class="line"></div><div class="line">  @Override</div><div class="line">  protected void executeInternal(JobExecutionContext arg0)</div><div class="line">      throws JobExecutionException &#123;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  public static void main(String[] args) &#123;</div><div class="line">    ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;);</div><div class="line">    </div><div class="line">    //changeModel;</div><div class="line">    </div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h4 id="b-ZhaobGgServiceModel-java"><a href="#b-ZhaobGgServiceModel-java" class="headerlink" title="b. ZhaobGgServiceModel.java"></a>b. ZhaobGgServiceModel.java</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div></pre></td><td class="code"><pre><div class="line">package com.bonait.dataextract.service.impl;</div><div class="line">import javax.annotation.Resource;</div><div class="line"></div><div class="line">import java.text.SimpleDateFormat;</div><div class="line">import java.util.Date;</div><div class="line">import java.util.Iterator;</div><div class="line">import java.util.List;</div><div class="line">import java.util.UUID;</div><div class="line"></div><div class="line"></div><div class="line">import net.sf.json.JSONArray;</div><div class="line">import net.sf.json.JSONObject;</div><div class="line"></div><div class="line">import org.hibernate.Query;</div><div class="line">import org.hibernate.Session;</div><div class="line">import org.hibernate.SessionFactory;</div><div class="line">import org.hibernate.Transaction;</div><div class="line">import org.springframework.stereotype.Service;</div><div class="line"></div><div class="line">import com.bonait.dataextract.dao.BaseDao;</div><div class="line">import com.bonait.dataextract.domain.*;</div><div class="line">import com.bonait.dataextract.service.*;</div><div class="line">import com.bonait.dataextract.util.Util;</div><div class="line">import com.bonait.dataextract.vo.*;</div><div class="line"></div><div class="line"></div><div class="line">/**</div><div class="line"> * @程序猿：//程序猿;</div><div class="line"> * </div><div class="line"> * @内容：//注解内容;</div><div class="line"> */</div><div class="line">@Service(&quot;//注解;&quot;)</div><div class="line">public class //类名; implements ZhaobGgService&#123;</div><div class="line"></div><div class="line">  @Resource</div><div class="line">  private SessionFactory sf ;</div><div class="line">  private Query query;</div><div class="line">  private ZhaoBiaoGongGao zbgg;</div><div class="line">  //列表页接口地址</div><div class="line">  private String listUrl=&quot;&quot;;</div><div class="line">  //内容页接口地址</div><div class="line">  private String detailUrl=&quot;&quot;;</div><div class="line">  //入库编码</div><div class="line">  private String sourceNo=&quot;//编号;&quot;;</div><div class="line">  @Override</div><div class="line">  public void initZhaobGgService() &#123;</div><div class="line">    try&#123;</div><div class="line">            //获取总页数</div><div class="line">          String s=Util.sendGet(listUrl,&quot;1&quot;);</div><div class="line">          JSONObject obj =JSONObject.fromObject(s);</div><div class="line">          while (null == obj.get(&quot;pageCount&quot;))&#123;</div><div class="line">           s = Util.sendGet(listUrl, &quot;1&quot;);</div><div class="line">           obj = JSONObject.fromObject(s);</div><div class="line">          &#125;</div><div class="line">    int maxPage=Integer.parseInt(obj.get(&quot;pageCount&quot;).toString());</div><div class="line"></div><div class="line"></div><div class="line">    Session session=sf.openSession();</div><div class="line">    session.beginTransaction();</div><div class="line"></div><div class="line">    //清空数据库里</div><div class="line">//    query=session.createSQLQuery(&quot;DELETE FROM t_zhao_biao_gong_gao t where t.WEB_SOURCE_NO=&apos;&quot;+sourceNo+&quot;&apos;&quot;);</div><div class="line">//    query.executeUpdate();</div><div class="line">//    session.getTransaction().commit();</div><div class="line">//    session.beginTransaction();</div><div class="line"></div><div class="line"></div><div class="line">    int KK=0;</div><div class="line">      flag:</div><div class="line">      for(int i=1;i&lt;=maxPage;i++)&#123;//maxPage</div><div class="line">        String jsonList=Util.sendGet(listUrl,i+&quot;&quot;);</div><div class="line">        JSONObject objList =JSONObject.fromObject(jsonList);</div><div class="line"></div><div class="line">        while(null == objList.get(&quot;list&quot;))&#123;</div><div class="line">          jsonList = Util.sendGet(listUrl, i + &quot;&quot;);</div><div class="line">          objList = JSONObject.fromObject(jsonList);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        JSONArray temp=(JSONArray) objList.get(&quot;list&quot;);</div><div class="line">        List list = (List)JSONArray.toList(temp,ListVO.class);</div><div class="line">        Iterator it = list.iterator();</div><div class="line"></div><div class="line">        int rows = 1;</div><div class="line">        for(int row =1;row &lt; rows;row++)&#123;</div><div class="line">          it.next();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        while(it.hasNext())&#123;</div><div class="line">          ListVO listvo =(ListVO) it.next();</div><div class="line">          query=session.createSQLQuery(&quot;SELECT ID FROM t_zhao_biao_gong_gao t where t.WEB_SOURCE_NO=&apos;&quot;+sourceNo+&quot;&apos; and t.RECORD_ID=&apos;&quot;+listvo.getId()+&quot;&apos;&quot;);</div><div class="line">          String getDate=listvo.getDate();</div><div class="line">          //获取页数，便于插入数据异常时，先跳过该页</div><div class="line">          System.out.println(i+&quot;:&quot;+getDate+&quot;:&quot;+maxPage);</div><div class="line">          </div><div class="line">              int date = Integer.parseInt(getDate.substring(0, 4));</div><div class="line">              //只取2014年至今的不重复数据 </div><div class="line">            if(query.executeUpdate()&lt;=0&amp;&amp;date&gt;=2014)&#123;</div><div class="line">              KK+=1;</div><div class="line">              String detail = null;</div><div class="line">            JSONObject o = null;</div><div class="line">            String content = null;</div><div class="line">            while (content == null || content.length() &lt; 10) &#123;</div><div class="line">              detail = Util.sendGet(detailUrl, listvo.getId());</div><div class="line">              if (null != detail)</div><div class="line">                o = JSONObject.fromObject(detail);</div><div class="line">              else</div><div class="line">                continue;</div><div class="line">              if (null != o&amp;&amp;null != o.get(&quot;content&quot;))</div><div class="line">                content = o.get(&quot;content&quot;).toString();</div><div class="line">              else</div><div class="line">                continue;</div><div class="line">              System.out.println(&quot;runing..&quot;);</div><div class="line">            &#125;</div><div class="line">              //过滤掉无效数据</div><div class="line">              if(content==null||content.length()&lt;10||content.contains(&quot;出错&quot;)||content.contains(&quot;找不到文件&quot;))&#123;continue;&#125;</div><div class="line">              zbgg=new ZhaoBiaoGongGao();</div><div class="line">              zbgg.setWebSourceNo(sourceNo);</div><div class="line">              zbgg.setArea(&quot;//area;&quot;);//区域</div><div class="line">              zbgg.setProvince(&quot;//provinceDB;&quot;);//省份</div><div class="line">              zbgg.setCity(&quot;//city;&quot;);//城市，没有可不填</div><div class="line">              zbgg.setDistrict(&quot;//county;&quot;);// 区县 不要“区”字符</div><div class="line">//              zbgg.setCity(listvo.getCiy());</div><div class="line">              zbgg.setWebSourceName(&quot;//webname;&quot;);//网站名称，写完整的名称</div><div class="line">              zbgg.setInfoSource(&quot;//infsource;&quot;);//信息来源</div><div class="line">              //未匹配到工程或服务的，都标识为货物</div><div class="line">                String infoType=Util.getInfoType(content);</div><div class="line">                if(infoType!=null&amp;&amp;infoType.length()&gt;0)</div><div class="line">                zbgg.setInfoType(Util.getInfoType(content));</div><div class="line">                else &#123;zbgg.setInfoType(&quot;货物&quot;);&#125;</div><div class="line">//              zbgg.setInfoType(&quot;服务&quot;);//信息类型</div><div class="line">//              zbgg.setIndustry(&quot;建筑建材&quot;); //行业分类</div><div class="line">//              zbgg.setIndustry(Util.getIndustry(content));//行业分类</div><div class="line">              zbgg.setRecordId(listvo.getId());</div><div class="line">              zbgg.setId(UUID.randomUUID().toString());</div><div class="line">              zbgg.setPageTitle(listvo.getTitle());</div><div class="line">              zbgg.setPageTime(getDate);</div><div class="line">              zbgg.setPageContent(content);</div><div class="line">              zbgg.setPageAttachments(&quot;&quot;);//附件url，暂不需要</div><div class="line">              zbgg.setCreateTime(new Date());</div><div class="line">            session.save(zbgg);</div><div class="line">             &#125;else if(date&lt;=2013)&#123;break flag;&#125;//到2013年的页码时，断掉循环</div><div class="line">            if(KK%1==0)&#123;</div><div class="line">              session.flush();  </div><div class="line">              session.clear();</div><div class="line">              session.getTransaction().commit();</div><div class="line">              session.beginTransaction();</div><div class="line">            &#125;</div><div class="line">        &#125;  </div><div class="line">      &#125; </div><div class="line"></div><div class="line">      </div><div class="line">    session.getTransaction().commit();</div><div class="line">    session.close();</div><div class="line">    System.out.println(&quot;000000000&quot;);</div><div class="line">    </div><div class="line">    &#125; catch (Exception e) &#123;</div><div class="line">      System.out.println(sourceNo+&quot;接口出错，请检查&quot;);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="7-设计数据库"><a href="#7-设计数据库" class="headerlink" title="7.设计数据库"></a>7.设计数据库</h3><p>数据库:Mysql 5.7<br>数据库工具:Navicat for MySQL10.7<br>JDBC-Mysql驱动包版本:mysql-connector-java-5.1.38-bin.jar</p>
<ol>
<li>创建速据库<br><code>create database my_blog</code></li>
</ol>
<ol>
<li><p>创建表article(用于保存模版)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> CREATE TABLE article(             </div><div class="line">    id INT  AUTO_INCREMENT primary key,</div><div class="line">    model VARCHAR(30) NOT NULL,</div><div class="line">    detail VARCHAR(20000) NOT NULL,</div><div class="line">    date DATETIME DEFAULT NOW()</div><div class="line">)ENGINE = innoDB DEFAULT CHARSET=utf8;</div></pre></td></tr></table></figure>
</li>
<li><p>创建webapi(导入excel表格数据,保存进该表)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">CREATE TABLE webapi(             </div><div class="line">    num VARCHAR(20) primary key,</div><div class="line">    area VARCHAR(255) NOT NULL,</div><div class="line">    province VARCHAR(255) NOT NULL,</div><div class="line">    city VARCHAR(255) NOT NULL,</div><div class="line">    county VARCHAR(255) NOT NULL,</div><div class="line">    webname VARCHAR(255)  NOT NULL,</div><div class="line">    weburl  VARCHAR(255)  NOT NULL,</div><div class="line">    infsource VARCHAR(255) NOT NULL,</div><div class="line">    inftype   VARCHAR(255),</div><div class="line">    worktype VARCHAR(255),</div><div class="line">    zbyg  VARCHAR(255),</div><div class="line">    zbgg    VARCHAR(255),</div><div class="line">    zsjg  VARCHAR(255),</div><div class="line">    ggbg VARCHAR(255),</div><div class="line">    zbwj VARCHAR(255),</div><div class="line">    zbdy VARCHAR(255),</div><div class="line">    zbxx VARCHAR(255),</div><div class="line">    kzj VARCHAR(255),</div><div class="line">)ENGINE = innoDB DEFAULT CHARSET=utf8;</div></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<p>3-2使用 navicat for MySQL工具导入Excel表格到数据库自动生成</p>
<blockquote>
<p>操作步骤：</p>
<blockquote>
<p>打开工具—&gt;连接数据库—&gt;左键双击选择数据库—&gt;右键子菜单的表—-&gt;导入向导—-&gt;<br>——–&gt;选择Excel文件(2007或者以上版本)(*.xlsx)，下一步,之后根据提示操作即可</p>
</blockquote>
</blockquote>
<p>查看webapi表结构的命令：<br><code>show create table webapi;</code></p>
<hr>
<p><br><br></p>
<h2 id="版本2-0【2016-11-15】"><a href="#版本2-0【2016-11-15】" class="headerlink" title="版本2.0【2016.11.15】"></a>版本2.0【2016.11.15】</h2><p><br><br></p>
<ul>
<li>2.0升级版,只生成入库目录,webapi表增加三列字段,创建新的数据库batchcreate_file</li>
<li>分成了review包和Utils包，主要修改了ChnageFile.java,IOFile和UseDB.java</li>
<li>可自动获取区域名的拼音首字母缩写【GetFirstLetter】，入库模版发生了变化，代码大幅度修改，整体思路不变</li>
<li>Macicat for MySQL导入2013的Excel表格会出错，所以需要将excel表另存为【Excel 97-2003工作蒲(*.xls)】</li>
<li>耗时6个小时左右，脑子还是不够灵活，最近犹如咸鱼一般，加油吧，骚年</li>
</ul>
<p><br><br><br></p>
<h2 id="1-testMain-java和TaskFlow-java"><a href="#1-testMain-java和TaskFlow-java" class="headerlink" title="1. testMain.java和TaskFlow.java"></a>1. testMain.java和TaskFlow.java</h2><p>1.testMain<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">package review;</div><div class="line"></div><div class="line"></div><div class="line">public class testMain &#123;</div><div class="line">    </div><div class="line"></div><div class="line">    //main()方法，测试</div><div class="line">    public static void main(String [] args)&#123;</div><div class="line">    </div><div class="line">        //创建任务流程对象</div><div class="line">        TaskFlow tf= new TaskFlow();</div><div class="line">        </div><div class="line">        //执行流程(参数:路径,目录名)</div><div class="line">        tf.GO(&quot;C:/Users/Liu-shuwei/Desktop\\&quot;,&quot;02053-02873&quot;,&quot;某男子&quot;);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>2.TaskFlow<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">package review;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseDB;</div><div class="line"></div><div class="line">public class TaskFlow &#123;</div><div class="line">    </div><div class="line">    public static long  useTime()&#123;</div><div class="line">        return System.currentTimeMillis();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //无参构造方法</div><div class="line">    public TaskFlow()&#123;</div><div class="line">        </div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //任务流程</div><div class="line">    public void GO(String path,String numberArea,String username) &#123;</div><div class="line">        //开始时间</div><div class="line">        long beginTime=useTime();</div><div class="line">        </div><div class="line">        //执行任务流程</div><div class="line">        try&#123;</div><div class="line">            UseDB udb = new UseDB();</div><div class="line">            IOFile iof=new IOFile();</div><div class="line">            </div><div class="line">            udb.connDatabase();//连接数据库</div><div class="line">            </div><div class="line">            //一.往数据库插入模版数据</div><div class="line">            String content=null;                                                                            //注意，路径的话用/或者\\都可以</div><div class="line">            content=iof.readFileContent(&quot;model_file/BackupTask.java&quot;,&quot;GBK&quot;); //数据库的默认编码是GBK,如果是UTF-8\</div><div class="line">            udb.insertTXT(&quot;article&quot;,&quot;model,detail&quot;,&quot;BackupTask&amp;&amp;&amp;&amp;&amp;&quot;+content,&quot;?,?&quot;);</div><div class="line">            content=iof.readFileContent(&quot;model_file/ZhaobGgServiceModel.java&quot;,&quot;GBK&quot;); </div><div class="line">            udb.insertTXT(&quot;article&quot;,&quot;model,detail&quot;,&quot;ZhaobGgServiceModel&amp;&amp;&amp;&amp;&amp;&quot;+content,&quot;?,?&quot;);</div><div class="line"></div><div class="line">            </div><div class="line">            //二.创建整体目录</div><div class="line">            iof.cList(path,numberArea,username);</div><div class="line">            </div><div class="line">            //关闭资源</div><div class="line">            udb.closeAll();</div><div class="line">            </div><div class="line">        &#125;catch(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //结束时间</div><div class="line">        long endTime=useTime();</div><div class="line">        System.out.println(&quot;总共用时:&quot;+(endTime-beginTime)+&quot;毫秒！&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><br></p>
<hr>
<h2 id="2-UseDB-java-IOFile-java和ChangeFile-java"><a href="#2-UseDB-java-IOFile-java和ChangeFile-java" class="headerlink" title="2. UseDB.java,IOFile.java和ChangeFile.java"></a>2. UseDB.java,IOFile.java和ChangeFile.java</h2><p>1.UseDb<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div></pre></td><td class="code"><pre><div class="line">package Utils;</div><div class="line"></div><div class="line">import java.sql.Connection;</div><div class="line">import java.sql.DriverManager;</div><div class="line">import java.sql.PreparedStatement;</div><div class="line">import java.sql.ResultSet;</div><div class="line">import java.sql.ResultSetMetaData;</div><div class="line">import java.sql.SQLException;</div><div class="line">import java.sql.Statement;</div><div class="line"></div><div class="line">public class UseDB &#123;</div><div class="line">    </div><div class="line">    </div><div class="line">    private String drive=&quot;com.mysql.jdbc.Driver&quot;;           //数据库驱动</div><div class="line">    private String link=&quot;jdbc:mysql://127.0.0.1:3306/&quot;;     //mysql—JDBC链接+IP地址+端口</div><div class="line">    private String database=&quot;batchcreate_file&quot;;                      //数据库</div><div class="line">    </div><div class="line">    private String username=&quot;root&quot;;                         //用户名</div><div class="line">    private String password=&quot;liushuwei&quot;;                    //密码</div><div class="line">    </div><div class="line">    private Connection conn;</div><div class="line">    private Statement st;</div><div class="line">    private PreparedStatement pst;</div><div class="line">    private ResultSet rs;</div><div class="line">    private ResultSetMetaData rsmd;//获取列的信息</div><div class="line">    </div><div class="line">    private String sql; //sql语句</div><div class="line">    </div><div class="line"></div><div class="line">    //无参构造方法，创建UseDB对象时候，直接连接数据库</div><div class="line">    public UseDB()&#123; </div><div class="line"></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //调用该方法时候连接数据库</div><div class="line">    public void connDatabase()  throws Exception&#123;</div><div class="line">         Class.forName(drive);</div><div class="line">         conn=DriverManager.getConnection(link+database,username,password); </div><div class="line">         st=conn.createStatement();</div><div class="line">         System.out.println(&quot;数据库连接成功......&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">        //功能1: 使用database数据库                                </div><div class="line">        public void useDatabase(String database)&#123;//参数: 数据库名称</div><div class="line">            sql=&quot;USE &quot;+database+&quot;;&quot;;</div><div class="line">            try&#123;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">            &#125;catch(Exception e)&#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">            System.out.println(sql+&quot; 执行完毕！-------------------------------------&quot;);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //功能2:查询table表中record字段满足condition条件的值</div><div class="line">        public String select(String table,String record,String condition)&#123;//参数: 表名,字段名,WHERE条件</div><div class="line">            </div><div class="line">            StringBuilder sb= new StringBuilder();</div><div class="line">            sql=&quot;SELECT &quot;+record+&quot; FROM &quot; +table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">            </div><div class="line">            try&#123;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                   ResultSetMetaData rsm =rs.getMetaData(); //获得列集</div><div class="line">                while(rs.next())&#123;</div><div class="line">                    sb.append(rs.getString(record));</div><div class="line">                &#125;</div><div class="line"></div><div class="line">            &#125;catch(Exception e)&#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">            System.out.println(sql+&quot; 执行完毕！-------------------------------------&quot;);</div><div class="line">            return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //功能3:查询table所有数据的数据,打印到控制台</div><div class="line">        public String selectAll(String table)&#123;//参数: 表名</div><div class="line">            </div><div class="line">            StringBuilder sb= new StringBuilder();</div><div class="line">            sql=&quot;SELECT * FROM &quot; +table+&quot;;&quot;;</div><div class="line">            </div><div class="line">            try&#123;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                rsmd =rs.getMetaData(); //获得列集</div><div class="line">                while(rs.next())&#123;</div><div class="line">                    for(int i=1;i&lt;rsmd.getColumnCount();i++)&#123;</div><div class="line">                        System.out.print(rs.getString(i)+&quot;\t&quot;);</div><div class="line">                    &#125;</div><div class="line">                    System.out.println();//换行</div><div class="line">                &#125;</div><div class="line"></div><div class="line">            &#125;catch(Exception e)&#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">            System.out.println(sql+&quot; 执行完毕！-------------------------------------&quot;);</div><div class="line">            return sb.toString();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        </div><div class="line">        //功能4:查询webapi表,判断招标预告到控制价字段的记录值是否存在URL  ,返回有URL记录的字段名(例如:zbgg)</div><div class="line">        public String checktable(String num)&#123;//参数: 编号        </div><div class="line">            StringBuilder sb= new StringBuilder();</div><div class="line">            sql=&quot;SELECT * FROM webapi WHERE num=&apos;&quot;+num+&quot;&apos;;&quot;;</div><div class="line">            String content=null;</div><div class="line">            try&#123;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                rsmd=rs.getMetaData();</div><div class="line">                while(rs.next())&#123;</div><div class="line">                    for(int i=10;i&lt;18;i++)&#123;</div><div class="line">                        content=rs.getString(i);</div><div class="line">                        if(content.length()&lt;3) continue;</div><div class="line">                            </div><div class="line">                        sb.append(rsmd.getColumnName(i)+&quot;&amp;&quot;);   </div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">            &#125;catch(SQLException e)&#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">            System.out.println(sql+&quot; 执行完毕！-------------------------------------&quot;);</div><div class="line">            return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        </div><div class="line">        //功能5:查询table表,record字段的所有记录值(所有行)</div><div class="line">        public String selectNum(String table,String record) throws SQLException&#123;</div><div class="line">            StringBuilder sb= new StringBuilder();</div><div class="line">            </div><div class="line">             sql=&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot;;&quot;;</div><div class="line">             rs=st.executeQuery(sql);</div><div class="line">             while(rs.next())&#123;</div><div class="line">                 sb.append(rs.getString(1)+&quot;&amp;&quot;);</div><div class="line">             &#125;</div><div class="line">             </div><div class="line">            System.out.println(sql+&quot; 执行完毕！-------------------------------------&quot;);</div><div class="line">            return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        </div><div class="line">        </div><div class="line">        //功能6: 插入数据--少量数据(标题，日期等)</div><div class="line">        public void insert(String table,String record,String content)&#123;//参数: 表名,字段(多的话用,分割),内容(多的话用,号分割)</div><div class="line">                String sql=&quot;INSERT INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+content+&quot;);&quot;;</div><div class="line">                    int i=0;</div><div class="line">                    try&#123;</div><div class="line">                        i=st.executeUpdate(sql);</div><div class="line">                        </div><div class="line">                    &#125;catch(Exception e)&#123;</div><div class="line">                        e.printStackTrace();</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    if(i!=-1)&#123;</div><div class="line">                        System.out.println(&quot;插入成功&quot;);</div><div class="line">                    &#125;</div><div class="line">                System.out.println(sql+&quot;执行完毕！&quot;);</div><div class="line">            &#125;</div><div class="line">        </div><div class="line">        //功能7:插入数据--大量数据(文章，文本内容)</div><div class="line">        public void insertTXT(String table,String record,String content,String mark)&#123;//参数值: 表名,字段,内容(多个内容用&amp;号分割),?号(多个?用,分割)</div><div class="line">            </div><div class="line">            sql=&quot;INSERT INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+mark+&quot;);&quot;;</div><div class="line">            </div><div class="line">            String [] strA=content.split(&quot;&amp;&amp;&amp;&amp;&amp;&quot;);</div><div class="line">            //判断是否存在相同记录，如果存在则不执行插入</div><div class="line">            String ifwhere=record.substring(0,record.indexOf(&quot;,&quot;));</div><div class="line">            String ifexist=&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot; WHERE &quot;+ifwhere+&quot;=&apos;&quot;+strA[0]+&quot;&apos;;&quot;;</div><div class="line">                </div><div class="line">            try&#123;</div><div class="line">                rs=st.executeQuery(ifexist);</div><div class="line">                System.out.println(ifexist+&quot; 执行完毕！================================&quot;);</div><div class="line">                </div><div class="line">                if(rs.next())&#123;//存在相同记录</div><div class="line">                    System.out.println(&quot;数据库中已经存在相同&quot;+strA[0]+&quot;模版,不进行重复插入!&quot;);</div><div class="line">                &#125;else&#123;</div><div class="line">                    //不存在相同记录</div><div class="line">                    System.out.println(&quot;数据库不存在&quot;+strA[0]+&quot;模版,正在进行插入......&quot;);</div><div class="line">                    pst=conn.prepareStatement(sql);</div><div class="line">                    </div><div class="line">                    for(int i=1;i&lt;=strA.length;i++)&#123;//循环次数: ?号个数            </div><div class="line">                        pst.setString(i,strA[i-1]);</div><div class="line">                    &#125;</div><div class="line">                    </div><div class="line">                    pst.executeUpdate();</div><div class="line">                &#125;</div><div class="line"></div><div class="line">            &#125;catch(Exception e)&#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            System.out.println(sql+&quot; 执行完毕！================================&quot;);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    </div><div class="line">        </div><div class="line">        </div><div class="line">        </div><div class="line">        //功能8: 查询数据库weiabi表中对应num编号整行记录的需求字段的信息(区域，省份，城市，区县，网站名称，信息来源)</div><div class="line">        public String selectNeedInformation_num(String num)&#123;</div><div class="line">                StringBuilder sb= new StringBuilder();</div><div class="line">            </div><div class="line">            sql=&quot;SELECT * FROM webapi WHERE num=&apos;&quot;+num+&quot;&apos;;&quot;;</div><div class="line">            try&#123;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                while(rs.next())&#123;</div><div class="line">                    for(int i=2;i&lt;=8;i++)&#123; //区域-信息来源</div><div class="line">                        if(i==7) continue; //网站网址</div><div class="line">                        sb.append(rs.getString(i)+&quot;&amp;&quot;);</div><div class="line">                    &#125;       </div><div class="line">                &#125;</div><div class="line">            &#125;catch(Exception e)&#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            System.out.println(sql+&quot; 执行完毕！-------------------------------------&quot;);</div><div class="line">            return sb.toString();   </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //关闭数据库连接</div><div class="line">        public void closeAll()&#123;</div><div class="line">            </div><div class="line">            //关闭Result</div><div class="line">             try&#123;</div><div class="line">                  if(rs!=null)</div><div class="line">                       rs.close();</div><div class="line">               &#125;catch(Exception e)&#123;</div><div class="line">                   e.printStackTrace(System.err);</div><div class="line">               &#125;</div><div class="line">             </div><div class="line">             </div><div class="line">            //关闭PreparedStatement</div><div class="line">            try&#123;</div><div class="line">            if(pst!=null)</div><div class="line">                  pst.close();</div><div class="line">            &#125;catch(Exception e)&#123;</div><div class="line">               e.printStackTrace(System.err);</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            </div><div class="line">            //关闭Statement</div><div class="line">             try&#123;</div><div class="line">                   if(st!=null)</div><div class="line">                       st.close();</div><div class="line">               &#125;catch(Exception e)&#123;</div><div class="line">                   e.printStackTrace(System.err);</div><div class="line">               &#125;</div><div class="line">            </div><div class="line">             </div><div class="line">           //关闭Connection</div><div class="line">           try&#123;</div><div class="line">               if(conn!=null)</div><div class="line">                   conn.close();</div><div class="line">           &#125;catch(Exception e)&#123;</div><div class="line">               e.printStackTrace(System.err);</div><div class="line">           &#125;</div><div class="line">        </div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>2.IOfile<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div></pre></td><td class="code"><pre><div class="line">package Utils;</div><div class="line"></div><div class="line">import java.io.File;</div><div class="line">import java.io.FileInputStream;</div><div class="line">import java.io.FileOutputStream;</div><div class="line">import java.io.IOException;</div><div class="line">import java.io.InputStream;</div><div class="line">import java.io.InputStreamReader;</div><div class="line">import java.io.OutputStreamWriter;</div><div class="line"></div><div class="line">public class IOFile &#123;</div><div class="line">    </div><div class="line">        //功能1:(字节流)读取文件内容--只适用与读取英文，数字，无法设置编码格式</div><div class="line">        public String readFileContent2(String path) throws IOException&#123; //参数:路径</div><div class="line">            String content=&quot;&quot;;</div><div class="line">            </div><div class="line">            InputStream inf=new FileInputStream(path);</div><div class="line">            int size=inf.available();</div><div class="line">            for(int i=0;i&lt;size;i++)&#123;</div><div class="line">                content+=(char)inf.read();</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            return &quot;\&apos;&quot;+content+&quot;\&apos;&quot;;   </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //功能2:(字符流)读取文件内容--可以设置编码，读取中文，英文，数字</div><div class="line">          public String readFileContent(String path,String encoding) throws IOException&#123; //参数: 路径,编码格式</div><div class="line">                StringBuilder sb =new StringBuilder();</div><div class="line">                    </div><div class="line">                    //定位文件</div><div class="line">                    File f=new File(path);</div><div class="line">                    FileInputStream fip=new FileInputStream(f);</div><div class="line">                    InputStreamReader reader=new InputStreamReader(fip,encoding);</div><div class="line">                    </div><div class="line">                    while(reader.ready())&#123;</div><div class="line">                        sb.append((char)reader.read());</div><div class="line">                    &#125;</div><div class="line">                    </div><div class="line">                return sb.toString();   </div><div class="line">           &#125;        </div><div class="line">        </div><div class="line">        </div><div class="line">        </div><div class="line">        //功能3: 获得路径，创建目录</div><div class="line">        public void createFile(String path)&#123;</div><div class="line">            File d=new File(path);</div><div class="line">            d.mkdir();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //功能4: 创建文件,写入内容</div><div class="line">        public void cFile(String path,String fileName,String encoding,String content) throws IOException&#123; //参数：路径,文件名.格式,编码格式,文件内容</div><div class="line">            File f=new File(path+&quot;/&quot;+fileName);</div><div class="line">            FileOutputStream fop= new FileOutputStream(f);</div><div class="line">            OutputStreamWriter writer=new OutputStreamWriter(fop,&quot;UTF-8&quot;);</div><div class="line">            </div><div class="line">            writer.append(content);</div><div class="line">            </div><div class="line">            writer.close();</div><div class="line">            fop.close();</div><div class="line">            System.out.println( &quot;********************************************&quot;+fileName+&quot;*****创建完毕&quot;);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //功能5: 创建入库目录</div><div class="line">        public void cList(String path,String numberArea,String username) throws Exception&#123; //参数：路径,编号A-编号B，程序猿姓名</div><div class="line">            </div><div class="line">                //一.创建对象  1.连接数据库  2.改变文件</div><div class="line">                UseDB udb =new UseDB();</div><div class="line">                udb.connDatabase();</div><div class="line">                udb.useDatabase(&quot;batchcreate_file&quot;);//使用batchcreate_file数据库</div><div class="line">                ChangeFile cf=new ChangeFile(udb);</div><div class="line">            </div><div class="line">                //二.创建父目录</div><div class="line">                String dir=path+&quot;/入库&quot;;</div><div class="line">                createFile(dir);</div><div class="line">                </div><div class="line">                //三.获得编号,储存起始编号，终止编号</div><div class="line"></div><div class="line">                String [] num=numberArea.split(&quot;-&quot;);</div><div class="line">                int first=Integer.parseInt(num[0]);//开始编号</div><div class="line">                int last=Integer.parseInt(num[1]);//终止编号</div><div class="line">                </div><div class="line">                </div><div class="line">                //四.查询webapi表里num字段所有记录，将其保存在数组里 </div><div class="line">                String allNum=udb.selectNum(&quot;webapi&quot;,&quot;num&quot;);</div><div class="line">                String [] allNumA=allNum.split(&quot;&amp;&quot;);</div><div class="line">               </div><div class="line">                //五.计算webapi中num个数(包括带-的)</div><div class="line">                int sum=0;</div><div class="line">                String allNumber=udb.selectNum(&quot;webapi&quot;,&quot;num&quot;);</div><div class="line">                String [] allNumber_Arrays=allNumber.split(&quot;&amp;&quot;);</div><div class="line">                for(int i=0;i&lt;allNumber_Arrays.length;i++)&#123;</div><div class="line">                    if(i&gt;1)&#123;</div><div class="line">                        if(!allNumber_Arrays[i].substring(0,5).equals(allNumber_Arrays[i-1].substring(0,5)))//判断是否有带-的编号</div><div class="line">                            sum++;</div><div class="line">                        else</div><div class="line">                            continue;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                </div><div class="line">                //六.生成1级子目录      规格:&quot;入库(n个)&quot;</div><div class="line">                    String [] str=&#123;&quot;入库&quot;&#125;;</div><div class="line">                    String sonFile=null;//1级子目录</div><div class="line">                    String sonFile2=null;//2级子目录</div><div class="line">                    String ifNum=null;//2级目录判定编号</div><div class="line">                    </div><div class="line">                    for(int i=0;i&lt;str.length;i++)&#123;   </div><div class="line">                        sonFile=dir+&quot;/&quot;+str[i]+&quot;(&quot;+sum+&quot;)&quot;;//路径</div><div class="line">                        this.createFile(sonFile);  //循环创建1级子目录(例子:入库(828))</div><div class="line">                        </div><div class="line">                        //进入含有&quot;入库&quot;字样的二级字目录</div><div class="line">                        if(str[i].indexOf(&quot;入库&quot;)!=-1)&#123;</div><div class="line">                            //生成入库编号</div><div class="line">                            for(int j=first;j&lt;=last;j++)&#123; //循环次数：终止编号-起始编号</div><div class="line">                                for(int k=0;k&lt;allNumA.length;k++)&#123; //循环次数：数据库webapi表里num记录的数量</div><div class="line">                                    </div><div class="line">                                    ifNum=allNumA[k].substring(1,5);</div><div class="line">                                    if(ifNum.equals(j+&quot;&quot;))&#123;   //对比输入编号和Excel表里的编号</div><div class="line">                                        </div><div class="line">                                        sonFile2=sonFile+&quot;/入库-0&quot;+j; </div><div class="line">                                        createFile(sonFile2); //创建2级子目录</div><div class="line">                                        </div><div class="line">                                        String provinceFirstLetter =udb.select(&quot;webapi&quot;,&quot;area&quot;,&quot;num=0&quot;+j) ;//省份</div><div class="line">                                        GetFirstLetter gfl = new GetFirstLetter();</div><div class="line">                                        String areaName=gfl.getFirstLetter(provinceFirstLetter).toUpperCase();//获取中文拼音的字母缩写，再转换为大写</div><div class="line">                                        if(k==0)</div><div class="line">                                            cf.createBackupTask(sonFile2+&quot;/&quot;, areaName,allNumA[k],allNumA[0]);//创建BackupTask.java</div><div class="line">                                        else</div><div class="line">                                            cf.createBackupTask(sonFile2+&quot;/&quot;, areaName,allNumA[k],allNumA[k-1]);//创建BackupTask.java,传入路径，编号，当前编号，上一个编号</div><div class="line">                                        </div><div class="line">                                        sonFile2=sonFile2+&quot;/imp&quot;;</div><div class="line">                                        createFile(sonFile2);//创建3级子目录              </div><div class="line">                                        cf.combineCreateRukuCoding(sonFile2+&quot;/&quot;, areaName,allNumA[k],username);//生成相应编号入库代码</div><div class="line">                                    &#125;</div><div class="line">                                &#125;</div><div class="line"></div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                </div><div class="line">               System.out.println(&quot;***************&quot;+numberArea+&quot;的入库代码目录生成完毕******************************&quot;);</div><div class="line">               udb.closeAll();//关闭资源</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>3.ChangeFile<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div></pre></td><td class="code"><pre><div class="line">package Utils;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line"></div><div class="line"></div><div class="line">public class ChangeFile &#123;</div><div class="line">    </div><div class="line">    private String zhaobYgService=&quot;zhaobYgService&quot;;     //招标预告</div><div class="line">    private String zhaobGgService=&quot;zhaobGgService&quot;;     //招标公告</div><div class="line">    private String zisJgService=&quot;zisJgService&quot;;         //咨审结果</div><div class="line">    private String zhaobWjService=&quot;zhaobWjService&quot;;     //招标文件</div><div class="line">    private String gonggBgService=&quot;gonggBgService&quot;;     //公告变更</div><div class="line">    private String zhaobDyService=&quot;zhaobDyService&quot;;     //招标答疑</div><div class="line">    private String zhongbXxService=&quot;zhongbXxService&quot;;   //中标信息</div><div class="line">    private String kongZjService=&quot;kongZjService&quot;;       //控制价</div><div class="line">    </div><div class="line">    private String model;   //BackupTask模版语句</div><div class="line"></div><div class="line">    </div><div class="line">    private UseDB udb;</div><div class="line">    private IOFile iof;</div><div class="line">    </div><div class="line">    //getter和Setter方法</div><div class="line">    public String getModel()&#123;</div><div class="line">        return model;</div><div class="line">    &#125;</div><div class="line">    public void setModel(String model)&#123;</div><div class="line">        this.model=model;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    </div><div class="line">    //无参构造方法</div><div class="line">    public ChangeFile(UseDB u) throws Exception&#123;  //用于给模版语句赋值</div><div class="line">        String model=&quot;NameA=(NameB) ac.getBean(\&quot;fileName\&quot;);&quot;;</div><div class="line">        String model2=&quot;NameA.initNameB();&quot;;</div><div class="line">        this.setModel(&quot;\n\t\t&quot;+model+&quot;\n\t\t&quot;+model2+&quot;\n\t\t&quot;);//换行和空格Tab</div><div class="line">        </div><div class="line">        udb=u;</div><div class="line">        iof=new IOFile();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //工具1:将首字母变为大写</div><div class="line">    public String UpFirstString(String content)&#123; //参数: 内容</div><div class="line">        String firstLetter=content.substring(0,1);</div><div class="line">        //替换首字母</div><div class="line">        content=content.replaceFirst(firstLetter,firstLetter.toUpperCase());</div><div class="line">        return content;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //工具1-2:将首字母变为小写</div><div class="line">    public String LowFirstString(String content)&#123; //参数: 内容</div><div class="line">        String firstLetter=content.substring(0,1);</div><div class="line">        //替换首字母</div><div class="line">        content=content.replaceFirst(firstLetter,firstLetter.toLowerCase());</div><div class="line">        return content;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //工具2:自动生成文件名    </div><div class="line">    public String cFileName(String province,String num,String attributeName)&#123;//参数:省份拼音缩写(大写),编号,相应的属性名</div><div class="line">        StringBuilder sb= new StringBuilder();</div><div class="line">        </div><div class="line">        province =province.substring(0,2);//例如东北，为DB,防止出现DBDB之类的重复</div><div class="line">        </div><div class="line">        num=num.replace(&quot;-&quot;,&quot;_&quot;);</div><div class="line">        sb.append(province+&quot;_&quot;+num+&quot;_&quot;+attributeName);//拼接文件名</div><div class="line">        </div><div class="line">        return sb.toString();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //工具3:根据BackupTask模版语句,生成相应字符串</div><div class="line">    public String cModelString(String province,String num,String attributeName)&#123;//参数: 省份,编号,相应的属性名</div><div class="line">        StringBuilder sb=new StringBuilder();</div><div class="line">        </div><div class="line">        </div><div class="line">        String fileName=cFileName(province,num,this.UpFirstString(attributeName)); //调用工具2,生成文件名</div><div class="line">        String cStr=getModel();</div><div class="line">        cStr=cStr.replace(&quot;NameA&quot;,attributeName).replace(&quot;NameB&quot;,UpFirstString(attributeName)).replace(&quot;fileName&quot;,fileName);</div><div class="line">        </div><div class="line">        sb.append(cStr);</div><div class="line">        return sb.toString();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //工具4:生成内容注解</div><div class="line">    public String cContentNode(String infSource,String modelName,String num)&#123;</div><div class="line">        StringBuilder sb= new StringBuilder();</div><div class="line">        </div><div class="line">        //根据模版名字判断类型</div><div class="line">        String type=&quot;&quot;;</div><div class="line">        </div><div class="line">        if(modelName.equals(&quot;zbyg&quot;))&#123;</div><div class="line">            type=&quot;招标预告&quot;;</div><div class="line">        &#125;else if(modelName.equals(&quot;zbgg&quot;))&#123;</div><div class="line">            type=&quot;招标公告&quot;;</div><div class="line">        &#125;else if(modelName.equals(&quot;zsjg&quot;))&#123;</div><div class="line">            type=&quot;咨审结果&quot;;</div><div class="line">        &#125;else if(modelName.equals(&quot;ggbg&quot;))&#123;</div><div class="line">            type=&quot;公告变更&quot;;</div><div class="line">        &#125;else if(modelName.equals(&quot;zbwj&quot;))&#123;</div><div class="line">            type=&quot;招标文件&quot;;</div><div class="line">        &#125;else if(modelName.equals(&quot;zbdy&quot;))&#123;</div><div class="line">            type=&quot;招标答疑&quot;;</div><div class="line">        &#125;else if(modelName.equals(&quot;zbxx&quot;))&#123;</div><div class="line">            type=&quot;中标信息&quot;;</div><div class="line">        &#125;else if(modelName.equals(&quot;kzj&quot;))&#123;</div><div class="line">            type=&quot;招标控制价&quot;;</div><div class="line">        &#125;   </div><div class="line">        </div><div class="line">        sb.append(&quot;东软一期-&quot;+infSource+&quot;-&quot;+type+&quot;-&quot;+num);</div><div class="line">        </div><div class="line">        return sb.toString();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //工具5: 判断一个编号有需要创建哪些入库代码，循环调用createRukuCoding方法进行</div><div class="line">    public void combineCreateRukuCoding(String path,String province,String num,String username)&#123;//路径,省份拼音首字母(大写),编号，程旭猿</div><div class="line">        </div><div class="line">        </div><div class="line">        //查询数据库，确认类型</div><div class="line">        String type=&quot;&quot;;</div><div class="line">        Boolean ifUseFilter = true; //是否在入库代码使用title自动判断，默认是true</div><div class="line">        String ifURL=udb.checktable(num);</div><div class="line">        </div><div class="line">        </div><div class="line">        //判断对应编号的备注是否是 &quot;含招标、中标&quot;,这种则需要招标，答疑，变更，中标都需要生成</div><div class="line">        String sRemark=udb.select(&quot;webapi&quot;,&quot;remark&quot;, &quot;num=&apos;&quot;+num+&quot;&apos;&quot;);</div><div class="line">        if(sRemark.indexOf(&quot;含招标&quot;) !=-1)&#123;</div><div class="line">            ifURL+=&quot;zbdy&amp;ggbg&amp;zbxx&quot;;</div><div class="line">        &#125;else&#123;</div><div class="line">            ifUseFilter =false;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        String [] ifURL_Arrays=ifURL.split(&quot;&amp;&quot;);</div><div class="line">        for(int i=0;i&lt;ifURL_Arrays.length;i++)&#123;</div><div class="line">            createRukuCoding(path,province,num,ifURL_Arrays[i],username,ifUseFilter);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //功能1:创建BackupTask.java                                                        (上一个编号，用来处理-)</div><div class="line">    public void createBackupTask (String path,String province,String num,String ageNum)&#123;//参数: 路径,省份拼音缩写,编号,上一个编号</div><div class="line"></div><div class="line">        //一.检查数据库webapi表,对应num(编号)的整条记录，招标预告-招标公告哪个字段有URL</div><div class="line">        String ifURL=udb.checktable(num); //返回有URL的字段名</div><div class="line">        </div><div class="line">        //判断对应编号的备注是否是 &quot;含招标、中标&quot;,这种则需要招标，答疑，变更，中标都需要生成</div><div class="line">        String sRemark=udb.select(&quot;webapi&quot;,&quot;remark&quot;, &quot;num=&apos;&quot;+num+&quot;&apos;&quot;);</div><div class="line">        if(sRemark.indexOf(&quot;含招标&quot;) !=-1)&#123;</div><div class="line">            ifURL+=&quot;zbdy&amp;ggbg&amp;zbxx&quot;;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        String [] ownURLArrays=ifURL.split(&quot;&amp;&quot;);</div><div class="line">        </div><div class="line">    </div><div class="line">        //二.生成相应内容</div><div class="line">        String content=&quot;&quot;; //储存总体字符串</div><div class="line">        String str=&quot;&quot;;     //中转字符串</div><div class="line">        if(ownURLArrays.length==0)&#123;</div><div class="line">            System.out.println(&quot;这个编号为空，不存在url，跳过&quot;);</div><div class="line">        &#125;else&#123;</div><div class="line">            for(int i=0;i&lt;ownURLArrays.length;i++)  //webapi表格里有url的字段</div><div class="line">            &#123;</div><div class="line">                </div><div class="line">                if(ownURLArrays[i].equals(&quot;zbyg&quot;))&#123;</div><div class="line">                    str=cModelString(province,num,zhaobYgService); //调用工具三,生成模版语句</div><div class="line">                &#125;else if(ownURLArrays[i].equals(&quot;zbgg&quot;))&#123;</div><div class="line">                    str=cModelString(province,num,zhaobGgService);</div><div class="line">                &#125;else if(ownURLArrays[i].equals(&quot;zsjg&quot;))&#123;</div><div class="line">                    str=cModelString(province,num,zisJgService);</div><div class="line">                &#125;else if(ownURLArrays[i].equals(&quot;ggbg&quot;))&#123;</div><div class="line">                    str=cModelString(province,num,gonggBgService);</div><div class="line">                &#125;else if(ownURLArrays[i].equals(&quot;zbwj&quot;))&#123;</div><div class="line">                    str=cModelString(province,num,zhaobWjService);</div><div class="line">                &#125;else if(ownURLArrays[i].equals(&quot;zbdy&quot;))&#123;</div><div class="line">                    str=cModelString(province,num,zhaobDyService);</div><div class="line">                &#125;else if(ownURLArrays[i].equals(&quot;zbxx&quot;))&#123;</div><div class="line">                    str=cModelString(province,num,zhongbXxService);</div><div class="line">                &#125;else if(ownURLArrays[i].equals(&quot;kzj&quot;))&#123;</div><div class="line">                    str=cModelString(province,num,kongZjService);</div><div class="line">                &#125;</div><div class="line">                                </div><div class="line">                content+=str;</div><div class="line">            &#125;</div><div class="line">            content+=&quot;//ok;&quot;;</div><div class="line">         &#125;</div><div class="line"></div><div class="line">        //三.判断当前编号是否和上一个编号相同</div><div class="line">        boolean sign=false;//设立标示</div><div class="line">        if(num.equals(ageNum) || !num.substring(0,5).equals(ageNum.substring(0,5)))&#123;</div><div class="line">            sign=true;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //四.根据数据库表article表中模版，生成相应编号的文件</div><div class="line">        try&#123;</div><div class="line">            String dbModelBackupTask=udb.select(&quot;article&quot;,&quot;detail&quot;,&quot;model=&apos;BackupTask&apos;&quot;); //储存数据库article表中,BackupTask模版</div><div class="line">        </div><div class="line">            if(sign)&#123;</div><div class="line">                //与上一个编号完全不同(号码不同,且不带-)</div><div class="line">                dbModelBackupTask=dbModelBackupTask.replace(&quot;//changeModel;&quot;,content);</div><div class="line">                iof.cFile(path,&quot;BackupTask.java&quot;,&quot;UTF-8&quot;,dbModelBackupTask);//路径,文件名,编码格式,内容</div><div class="line">            </div><div class="line">            &#125;else&#123;</div><div class="line">                //带-的编号,在上一个文件基础上进行叠加</div><div class="line">                String ageContent=iof.readFileContent(path+&quot;/BackupTask.java&quot;,&quot;UTF-8&quot;);//前一个编号的内容       </div><div class="line">                String changeContent=ageContent.replace(&quot;//ok;&quot;,content);</div><div class="line">                iof.cFile(path,&quot;BackupTask.java&quot;,&quot;UTF-8&quot;,changeContent);</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">        &#125;catch(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">    //功能1:创建相应编号,类型的入库代码</div><div class="line">    public void createRukuCoding(String path,String province,String num,String type,String username,Boolean ifUseFilter)&#123;//参数: 路径,省份拼音首字母缩写,编号,类型,程序猿,是否使用自动判断</div><div class="line">        </div><div class="line">                //一.生成文件名</div><div class="line">                String fileName=&quot;&quot;; //注解名</div><div class="line">                String typeSpell=&quot;&quot;;</div><div class="line">                String typeService=&quot;&quot;;</div><div class="line">                String typeChinese=&quot;&quot;;//类型中文名</div><div class="line">                String tableName=&quot;&quot;;//入库表名</div><div class="line">                int tNumber =5; //自动识别判定条件</div><div class="line">                </div><div class="line">                    for(int i=0;i&lt;8;i++)  //共8种类型</div><div class="line">                    &#123;               </div><div class="line">                        if(type.equals(&quot;zbyg&quot;))&#123;</div><div class="line">                            fileName=cFileName(province,num,&quot;ZhaobYgService&quot;);</div><div class="line">                            typeSpell=&quot;zhaoBiaoYuGao&quot;;</div><div class="line">                            typeService=&quot;zhaobYgService&quot;;</div><div class="line">                            typeChinese=&quot;招标预告&quot;;</div><div class="line">                            tableName=&quot;t_zhao_biao_yu_gao&quot;;</div><div class="line">                        &#125;else if(type.equals(&quot;zbgg&quot;))&#123;</div><div class="line">                            fileName=cFileName(province,num,&quot;ZhaobGgService&quot;);</div><div class="line">                            typeSpell=&quot;zhaoBiaoGongGao&quot;;</div><div class="line">                            typeService=&quot;zhaobGgService&quot;;</div><div class="line">                            typeChinese=&quot;招标公告&quot;;</div><div class="line">                            tableName=&quot;t_zhao_biao_gong_gao&quot;;</div><div class="line">                            tNumber=1;</div><div class="line">                        &#125;else if(type.equals(&quot;zsjg&quot;))&#123;</div><div class="line">                            fileName=cFileName(province,num,&quot;ZisJgService&quot;);</div><div class="line">                            typeSpell=&quot;ziShenJieGuo&quot;;</div><div class="line">                            typeService=&quot;zisJgService&quot;;</div><div class="line">                            typeChinese=&quot;咨审结果&quot;;</div><div class="line">                            tableName=&quot;t_zi_shen_jie_guo&quot;;</div><div class="line">                        &#125;else if(type.equals(&quot;ggbg&quot;))&#123;</div><div class="line">                            fileName=cFileName(province,num,&quot;GonggBgService&quot;);</div><div class="line">                            typeSpell=&quot;gongGaoBianGeng&quot;;</div><div class="line">                            typeService=&quot;gonggBgService&quot;;</div><div class="line">                            typeChinese=&quot;公告变更&quot;;</div><div class="line">                            tableName=&quot;t_gong_gao_bian_geng&quot;;</div><div class="line">                            tNumber=3;</div><div class="line">                        &#125;else if(type.equals(&quot;zbwj&quot;))&#123;</div><div class="line">                            fileName=cFileName(province,num,&quot;ZhaobWjService&quot;);</div><div class="line">                            typeSpell=&quot;zhaoBiaoWenJian&quot;;</div><div class="line">                            typeService=&quot;zhaobWjService&quot;;</div><div class="line">                            typeChinese=&quot;招标文件&quot;;</div><div class="line">                            tableName=&quot;t_zhao_biao_wen_jian&quot;;</div><div class="line">                        &#125;else if(type.equals(&quot;zbdy&quot;))&#123;</div><div class="line">                            fileName=cFileName(province,num,&quot;ZhaobDyService&quot;);</div><div class="line">                            typeSpell=&quot;ZhaoBiaoDaYi&quot;;</div><div class="line">                            typeService=&quot;zhaobDyService&quot;;</div><div class="line">                            typeChinese=&quot;招标答疑&quot;;</div><div class="line">                            tableName=&quot;t_zhao_biao_da_yi&quot;;</div><div class="line">                            tNumber=4;</div><div class="line">                        &#125;else if(type.equals(&quot;zbxx&quot;))&#123;</div><div class="line">                            fileName=cFileName(province,num,&quot;ZhongbXxService&quot;);</div><div class="line">                            typeSpell=&quot;zhongBiaoXinXi&quot;;</div><div class="line">                            typeService=&quot;zhongbXxService&quot;;</div><div class="line">                            typeChinese=&quot;中标信息&quot;;</div><div class="line">                            tableName=&quot;t_zhong_biao_xin_xi&quot;;</div><div class="line">                            tNumber=2;</div><div class="line">                        &#125;else if(type.equals(&quot;kzj&quot;))&#123;</div><div class="line">                            fileName=cFileName(province,num,&quot;KongZjService&quot;);</div><div class="line">                            typeSpell=&quot;kongZhiJia&quot;;</div><div class="line">                            typeService=&quot;kongZjService&quot;;</div><div class="line">                            typeChinese=&quot;控制价&quot;;</div><div class="line">                            tableName=&quot;t_kong_zhi_jia&quot;;</div><div class="line">                        &#125;               </div><div class="line">                 &#125;</div><div class="line">                    </div><div class="line">                </div><div class="line">                //首字母变为大写</div><div class="line">                String typeSpellUp=UpFirstString(typeSpell);</div><div class="line">                String typeServiceUp=UpFirstString(typeService);</div><div class="line">                    </div><div class="line">                //二.查询数据库模版</div><div class="line">                String modelName=fileName.substring(fileName.lastIndexOf(&quot;_&quot;)+1);</div><div class="line">                String modelContent=udb.select(&quot;article&quot;,&quot;detail&quot;,&quot;model=&apos;ZhaobGgServiceModel&apos;&quot;);</div><div class="line">                </div><div class="line">                //三.查询数据库num编号的整行记录,所需要要的信息</div><div class="line">                String information_num=udb.selectNeedInformation_num(num);</div><div class="line">                String [] information_Arrays=information_num.split(&quot;&amp;&quot;);</div><div class="line">                </div><div class="line">                String area=information_Arrays[0];                                          //区域</div><div class="line">                String provinceDB=information_Arrays[1].replace(&quot;省&quot;,&quot;&quot;);                    //省份(不要省字)</div><div class="line">                String city=information_Arrays[2].replace(&quot;市&quot;,&quot;&quot;);                          //城市(不要市字)</div><div class="line">                String county=information_Arrays[3].replace(&quot;区&quot;,&quot;&quot;).replace(&quot;县&quot;,&quot;&quot;).replace(&quot;市&quot;,&quot;&quot;);        //区县(不要区,县字)</div><div class="line">                String webname=information_Arrays[4];                                       //网站名称</div><div class="line">                String infsource=information_Arrays[5];                                     //信息来源</div><div class="line">                </div><div class="line">                </div><div class="line">                //四.修改模版</div><div class="line">                String rukuContent=modelContent.replace(&quot;zhaoBiaoGongGao&quot;,typeSpell).replace(&quot;ZhaoBiaoGongGao&quot;,typeSpellUp).replace(&quot;ZhaobGgService&quot;,typeServiceUp).replace(&quot;zhaobGgService&quot;,typeService).replace(&quot;zbgg&quot;,type);</div><div class="line">                //程序猿;</div><div class="line">                rukuContent=rukuContent.replaceFirst(&quot;//程序猿;&quot;,username);</div><div class="line">                //注解内容</div><div class="line">                rukuContent=rukuContent.replaceFirst(&quot;//注解内容;&quot;,area+&quot;_&quot;+information_Arrays[1]+&quot;_&quot;+information_Arrays[2]+&quot;_&quot;+information_Arrays[3]+&quot;_&quot;+typeChinese+&quot;_&quot;+num);</div><div class="line">                </div><div class="line">                rukuContent=rukuContent.replaceFirst(&quot;//注解;&quot;,fileName).replaceFirst(&quot;//类名;&quot;,fileName);</div><div class="line">                 </div><div class="line">                rukuContent=rukuContent.replaceFirst(&quot;//编号;&quot;,num);</div><div class="line">                </div><div class="line">                //是否使用自动判断</div><div class="line">                if(ifUseFilter)&#123;</div><div class="line">                rukuContent=rukuContent.replaceFirst(&quot;//使用自动工具类;&quot;,&quot;int t = Utils.judge(listvo.getTitle());&quot;)</div><div class="line">                        .replaceFirst(&quot;//判断1;&quot;,&quot;if(t != //生成编号;)&#123;&quot;).replaceFirst(&quot;//判断2;&quot;,&quot;continue;&quot;).replaceFirst(&quot;//判断3;&quot;, &quot;&#125;&quot;);</div><div class="line">                rukuContent=rukuContent.replaceFirst(&quot;//生成编号;&quot;,tNumber+&quot;&quot;);</div><div class="line">                &#125;else&#123;</div><div class="line">                    rukuContent=rukuContent.replaceFirst(&quot;//使用自动工具类;&quot;,&quot;&quot;)</div><div class="line">                            .replaceFirst(&quot;//判断1;&quot;,&quot;&quot;).replaceFirst(&quot;//判断2;&quot;,&quot;&quot;).replaceFirst(&quot;//判断3;&quot;, &quot;&quot;);</div><div class="line">                &#125;</div><div class="line">                </div><div class="line">                </div><div class="line">                </div><div class="line">                rukuContent=rukuContent.replaceFirst(&quot;//area;&quot;,area);</div><div class="line">                rukuContent=rukuContent.replaceFirst(&quot;//provinceDB;&quot;,provinceDB);</div><div class="line">                rukuContent=rukuContent.replaceFirst(&quot;//city;&quot;,city);</div><div class="line">                rukuContent=rukuContent.replaceFirst(&quot;//county;&quot;,county);</div><div class="line">                rukuContent=rukuContent.replaceFirst(&quot;//webname;&quot;,webname);</div><div class="line">                rukuContent=rukuContent.replaceFirst(&quot;//infsource;&quot;,infsource);</div><div class="line">                rukuContent=rukuContent.replace(&quot;//表名;&quot;,tableName);</div><div class="line">                </div><div class="line">                try&#123;</div><div class="line">                    //创建文件</div><div class="line">                    iof.cFile(path,fileName+&quot;.java&quot;,&quot;UTF-8&quot;,rukuContent);//路径,文件名,编码格式,内容</div><div class="line">                &#125;catch(IOException e)&#123;</div><div class="line">                    e.printStackTrace();</div><div class="line">                &#125;</div><div class="line">                </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>4.GetFirstLetter<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line">package Utils;</div><div class="line"></div><div class="line">public class GetFirstLetter &#123;</div><div class="line">    private static int BEGIN = 45217;</div><div class="line">    private static int END = 63486;</div><div class="line">    </div><div class="line">    //按照声母表示，这个表是在GB2312中的出现的第一个汉字，也就是说“啊”是代表首字母a的第一个汉字</div><div class="line">    // 二十六个字母区间对应二十七个端点    // GB2312码汉字区间十进制表示</div><div class="line">    private static char[] chartable = &#123;&apos;啊&apos;, &apos;芭&apos;, &apos;擦&apos;, &apos;搭&apos;, &apos;蛾&apos;, &apos;发&apos;, &apos;噶&apos;, &apos;哈&apos;,        &apos;哈&apos;, &apos;击&apos;, &apos;喀&apos;, &apos;垃&apos;, &apos;妈&apos;, &apos;拿&apos;, &apos;哦&apos;, &apos;啪&apos;, &apos;期&apos;, &apos;然&apos;, &apos;撒&apos;, &apos;塌&apos;, &apos;塌&apos;,        &apos;塌&apos;, &apos;挖&apos;, &apos;昔&apos;, &apos;压&apos;, &apos;匝&apos;,&#125;; </div><div class="line">    private static int [] table = new int[27]; // 对应首字母区间表</div><div class="line"></div><div class="line">    // 对应首字母区间表</div><div class="line">    private static char[] initialtable = &#123;&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos;,        &apos;h&apos;, &apos;h&apos;, &apos;j&apos;, &apos;k&apos;, &apos;l&apos;, &apos;m&apos;, &apos;n&apos;, &apos;o&apos;, &apos;p&apos;, &apos;q&apos;, &apos;r&apos;, &apos;s&apos;, &apos;t&apos;,        &apos;t&apos;, &apos;t&apos;, &apos;w&apos;, &apos;x&apos;, &apos;y&apos;, &apos;z&apos;,&#125;;</div><div class="line">    </div><div class="line">    //1.初始化</div><div class="line">     static &#123;        </div><div class="line">         for (int i = 0; i &lt; 26; i++) &#123;            </div><div class="line">             table[i] = gbValue(chartable[i]);// 得到GB2312码的首字母区间端点表，十进制。 </div><div class="line">         &#125;</div><div class="line">         table[26] = END;// 区间表结尾</div><div class="line">     &#125;</div><div class="line"></div><div class="line">     /* 根据一个包含汉字的字符串返回一个汉字拼音首字母的字符串 最重要的一个方法，思路如下：一个个字符读入、判断、输出     */</div><div class="line">     public static String getFirstLetter(String sourceStr) &#123;        </div><div class="line">            String result = &quot;&quot;;        </div><div class="line">            String str = sourceStr.toLowerCase();       </div><div class="line">            int StrLength = str.length();        </div><div class="line">            int i;       </div><div class="line">            try &#123;            </div><div class="line">                for (i = 0; i &lt; StrLength; i++) &#123;                </div><div class="line">                    result += Char2Initial(str.charAt(i));            </div><div class="line">                    &#125;        </div><div class="line">                &#125; catch (Exception e) &#123;            </div><div class="line">                    result = &quot;&quot;;        </div><div class="line">                    &#125;        </div><div class="line">            return result;   </div><div class="line">        &#125;</div><div class="line">     </div><div class="line">      /* 输入字符,得到他的声母,英文字母返回对应的大写字母,其他非简体汉字返回 &apos;0&apos;     */  </div><div class="line">     private static char Char2Initial(char ch) &#123;    </div><div class="line">                // 对英文字母的处理：小写字母转换为大写，大写的直接返回</div><div class="line">              if (ch &gt;= &apos;a&apos; &amp;&amp; ch &lt;= &apos;z&apos;) &#123;            </div><div class="line">                  return ch;        </div><div class="line">               &#125;        </div><div class="line">              if (ch &gt;= &apos;A&apos; &amp;&amp; ch &lt;= &apos;Z&apos;) &#123;</div><div class="line">                  return ch;  </div><div class="line">                &#125;</div><div class="line">         </div><div class="line">              // 对非英文字母的处理：转化为首字母，然后判断是否在码表范围内，        // 若不是，则直接返回。        // 若是，则在码表内的进行判断。   </div><div class="line">              int gb = gbValue(ch);// 汉字转换首字母</div><div class="line">              if ((gb &lt; BEGIN) || (gb &gt; END))&#123;            </div><div class="line">                  return ch;        </div><div class="line">                 &#125;</div><div class="line">    </div><div class="line">              int i;       </div><div class="line">              for (i = 0; i &lt; 26; i++) &#123; // 判断匹配码表区间，匹配到就break,判断区间形如“[,)”</div><div class="line">                  if ((gb &gt;= table[i]) &amp;&amp; (gb &lt; table[i + 1])) &#123;</div><div class="line">                      break;            </div><div class="line">                      &#125;        </div><div class="line">              &#125;</div><div class="line">              if (gb == END) &#123; //补上GB2312区间最右端    </div><div class="line">                     i = 25;        </div><div class="line">                &#125;      </div><div class="line">            return initialtable[i]; // 在码表区间中，返回首字母    &#125;</div><div class="line">         &#125;</div><div class="line"></div><div class="line">     </div><div class="line">     /* 取出汉字的编码 cn 汉字     */  </div><div class="line">    private static int gbValue(char ch) &#123;</div><div class="line">        String str = new String();        </div><div class="line">        str += ch;       </div><div class="line">        try &#123;           </div><div class="line">            byte[] bytes = str.getBytes(&quot;GB2312&quot;);            </div><div class="line">            if (bytes.length &lt; 2) &#123;               </div><div class="line">                    return 0;           </div><div class="line">            &#125;            </div><div class="line">            return (bytes[0] &lt;&lt; 8 &amp; 0xff00) + (bytes[1] &amp; 0xff);      </div><div class="line">        &#125; catch (Exception e) &#123;          </div><div class="line">            return 0;        </div><div class="line">            &#125;    </div><div class="line">    &#125;   </div><div class="line">    </div><div class="line">//  public static void main(String [] args)&#123;</div><div class="line">//      //在main方法中调用FirstLetterUtil类的getFirstLetter()方法，获取姓名的首字母。如：“刘德华”获取首字母是“ldh”。</div><div class="line">//       System.out.print(getFirstLetter(&quot;日你仙人掌&quot;));//获取文字首字母的拼音</div><div class="line">//  &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<h3 id="3-BackupTask-java和ZhaobGgServiceModel-java模版"><a href="#3-BackupTask-java和ZhaobGgServiceModel-java模版" class="headerlink" title="3. BackupTask.java和ZhaobGgServiceModel.java模版"></a>3. BackupTask.java和ZhaobGgServiceModel.java模版</h3><p>BackupTask<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">package com.bonait.dataextract.scheduler;</div><div class="line"></div><div class="line">import java.util.Date;</div><div class="line"></div><div class="line">import org.quartz.JobExecutionContext;</div><div class="line">import org.quartz.JobExecutionException;</div><div class="line">import org.springframework.context.ApplicationContext;</div><div class="line">import org.springframework.context.support.ClassPathXmlApplicationContext;</div><div class="line">import org.springframework.scheduling.quartz.QuartzJobBean;</div><div class="line"></div><div class="line">import com.bonait.dataextract.service.GonggBgService;</div><div class="line">import com.bonait.dataextract.service.KongZjService;</div><div class="line">import com.bonait.dataextract.service.ZhaobDyService;</div><div class="line">import com.bonait.dataextract.service.ZhaobGgService;</div><div class="line">import com.bonait.dataextract.service.ZhaobWjService;</div><div class="line">import com.bonait.dataextract.service.ZhaobYgService;</div><div class="line">import com.bonait.dataextract.service.ZhongbXxService;</div><div class="line">import com.bonait.dataextract.service.ZisJgService;</div><div class="line"></div><div class="line">public class BackupTask extends QuartzJobBean &#123;</div><div class="line"></div><div class="line">    private static ZhaobGgService zhaobGgService;</div><div class="line">    private static ZhongbXxService zhongbXxService;</div><div class="line">    private static ZhaobWjService zhaobWjService;</div><div class="line">    private static ZhaobDyService zhaobDyService;</div><div class="line">    private static ZisJgService zisJgService;</div><div class="line">    private static GonggBgService gonggBgService;</div><div class="line">    private static KongZjService kongZjService;</div><div class="line">    private static ZhaobYgService zhaobYgService;</div><div class="line">    </div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void executeInternal(JobExecutionContext arg0)</div><div class="line">            throws JobExecutionException &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public static void main(String[] args) &#123;    </div><div class="line">        System.out.println(&quot;bxkc_Test start time is&quot;+new Date());</div><div class="line"></div><div class="line">        ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;);</div><div class="line">        </div><div class="line">        //changeModel;</div><div class="line">        </div><div class="line">        System.out.println(&quot;bxkc_Test end time is&quot;+new Date());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>ZhaobGgServiceModel<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div></pre></td><td class="code"><pre><div class="line">package com.bonait.dataextract.service.impl;</div><div class="line">import java.util.Date;</div><div class="line">import java.util.Iterator;</div><div class="line">import java.util.List;</div><div class="line">import java.util.UUID;</div><div class="line"></div><div class="line">import javax.annotation.Resource;</div><div class="line"></div><div class="line">import net.sf.json.JSONArray;</div><div class="line">import net.sf.json.JSONObject;</div><div class="line"></div><div class="line">import org.hibernate.Query;</div><div class="line">import org.hibernate.Session;</div><div class="line">import org.hibernate.SessionFactory;</div><div class="line">import org.springframework.stereotype.Service;</div><div class="line"></div><div class="line">import com.bonait.dataextract.domain.ZhaoBiaoGongGao;</div><div class="line">import com.bonait.dataextract.service.ZhaobGgService;</div><div class="line">import com.bonait.dataextract.util.Util;</div><div class="line">import com.bonait.dataextract.util.Utils;</div><div class="line">import com.bonait.dataextract.vo.ListVO;</div><div class="line"></div><div class="line"></div><div class="line">/**</div><div class="line"> * @程序猿：//程序猿;</div><div class="line"> * </div><div class="line"> * @内容：//注解内容;</div><div class="line"> */</div><div class="line">@Service(&quot;//注解;&quot;)</div><div class="line">public class //类名; implements ZhaobGgService&#123;</div><div class="line"></div><div class="line">    @Resource</div><div class="line">    private SessionFactory sf ;</div><div class="line">    private Query query;</div><div class="line">    private ZhaoBiaoGongGao zbgg;</div><div class="line">    //列表页接口地址</div><div class="line">    private String listUrl=&quot;&quot;;</div><div class="line">    //内容页接口地址</div><div class="line">    private String detailUrl=&quot;&quot;;</div><div class="line">    //入库编码</div><div class="line">    private String sourceNo=&quot;//编号;&quot;;</div><div class="line">    @Override</div><div class="line">    public void initZhaobGgService() &#123;</div><div class="line">        Session session=sf.openSession();</div><div class="line">        session.beginTransaction();</div><div class="line">        try&#123;</div><div class="line">            //获取总页数</div><div class="line">              String s=Util.sendGet(listUrl,&quot;1&quot;);</div><div class="line">              JSONObject obj =JSONObject.fromObject(s);</div><div class="line">              int maxPage=Integer.parseInt(obj.get(&quot;pageCount&quot;).toString());</div><div class="line"></div><div class="line"></div><div class="line">        //清空数据库里</div><div class="line">//      query=session.createSQLQuery(&quot;DELETE FROM //表名; t where t.WEB_SOURCE_NO=&apos;&quot;+sourceNo+&quot;&apos;&quot;);</div><div class="line">//      query.executeUpdate();</div><div class="line">//      session.getTransaction().commit();</div><div class="line">//      session.beginTransaction();</div><div class="line"></div><div class="line">        int KK=0;</div><div class="line">            flag:</div><div class="line">            for(int i=1;i&lt;=maxPage;i++)&#123;//maxPage</div><div class="line">                String jsonList=Util.sendGet(listUrl,i+&quot;&quot;);</div><div class="line">                JSONObject objList =JSONObject.fromObject(jsonList);</div><div class="line">                </div><div class="line">                JSONArray temp=(JSONArray) objList.get(&quot;list&quot;);</div><div class="line">                List list = (List)JSONArray.toList(temp,ListVO.class);</div><div class="line">                Iterator it = list.iterator();</div><div class="line">                </div><div class="line">                while(it.hasNext())&#123;</div><div class="line">                    ListVO listvo = (ListVO) it.next();</div><div class="line">                    //使用自动工具类;</div><div class="line">                    </div><div class="line">                    //判断1;</div><div class="line">                        //判断2;</div><div class="line">                    //判断3;</div><div class="line">                    </div><div class="line">                    query=session.createSQLQuery(&quot;SELECT ID FROM //表名; t where t.WEB_SOURCE_NO=&apos;&quot;+sourceNo+&quot;&apos; and t.RECORD_ID=&apos;&quot;+listvo.getId()+&quot;&apos;&quot;);</div><div class="line">                    String getDate=listvo.getDate();</div><div class="line">                    //获取页数，便于插入数据异常时，先跳过该页</div><div class="line">//                  System.out.println(i+&quot;:&quot;+getDate+&quot;:&quot;+maxPage);</div><div class="line">                    </div><div class="line">                    int date = Integer.parseInt(getDate.substring(0, 4));</div><div class="line">                    //只取2014年至今的不重复数据   </div><div class="line">                    if(query.executeUpdate()&lt;=0&amp;&amp;date&gt;=2014)&#123;</div><div class="line">                        KK+=1;</div><div class="line">                        String detail=Util.sendGet(detailUrl,listvo.getId());</div><div class="line">//                      String detail=Util.sendGet(listvo.getUrl(),&quot;&quot;);</div><div class="line">                        JSONObject o=JSONObject.fromObject(detail);</div><div class="line">                         String content=o.get(&quot;content&quot;).toString();</div><div class="line">                         </div><div class="line">                        //过滤掉无效数据</div><div class="line">                        if(content==null||content.length()&lt;10||content.contains(&quot;出错&quot;)||content.contains(&quot;找不到文件&quot;))&#123;continue;&#125;</div><div class="line">                        zbgg=new ZhaoBiaoGongGao();</div><div class="line">                        zbgg.setWebSourceNo(sourceNo);</div><div class="line">                        zbgg.setArea(&quot;//area;&quot;);//区域</div><div class="line">                        zbgg.setProvince(&quot;//provinceDB;&quot;);//省份</div><div class="line">                        zbgg.setCity(&quot;//city;&quot;);//城市，没有可不填</div><div class="line">                        zbgg.setDistrict(&quot;//county;&quot;);// 区县 不要“区”字符</div><div class="line">//                      zbgg.setCity(listvo.getCiy());</div><div class="line">                        zbgg.setWebSourceName(&quot;//webname;&quot;);//网站名称，写完整的名称</div><div class="line">                        zbgg.setInfoSource(&quot;//infsource;&quot;);//信息来源</div><div class="line">                        //未匹配到工程或服务的，都标识为货物</div><div class="line">                        String infoType=Util.getInfoType(content);</div><div class="line">                        if(infoType!=null&amp;&amp;infoType.length()&gt;0)</div><div class="line">                        zbgg.setInfoType(Util.getInfoType(content));</div><div class="line">                        else &#123;zbgg.setInfoType(&quot;货物&quot;);&#125;</div><div class="line">//                       zbgg.setInfoType(Util.getInfoType(content));//信息类型</div><div class="line">//                      zbgg.setIndustry(&quot;建筑建材&quot;); //行业分类</div><div class="line">                        zbgg.setIndustry(Util.getIndustry(content));//行业分类</div><div class="line">                        zbgg.setRecordId(listvo.getId());</div><div class="line">                        zbgg.setId(UUID.randomUUID().toString());</div><div class="line">                        zbgg.setPageTitle(listvo.getTitle());</div><div class="line">                        zbgg.setPageTime(getDate);</div><div class="line">                        zbgg.setPageContent(content);</div><div class="line">                        zbgg.setPageAttachments(&quot;&quot;);//附件url，暂不需要</div><div class="line">                        zbgg.setCreateTime(new Date());</div><div class="line">                        session.save(zbgg);</div><div class="line">                     &#125;else&#123;break flag;&#125;//到2013年的页码时，断掉循环</div><div class="line">                    if(KK%1==0)&#123;</div><div class="line">                        session.flush();  </div><div class="line">                        session.clear();</div><div class="line">                        session.getTransaction().commit();</div><div class="line">                        session.beginTransaction();</div><div class="line">                    &#125;</div><div class="line">                &#125;  </div><div class="line">            &#125;   </div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            System.out.println(sourceNo+&quot; is error, please cheak ZhaobGgService !!!!!!!&quot;);</div><div class="line">        &#125;</div><div class="line">        session.getTransaction().commit();</div><div class="line">        session.close();</div><div class="line">        System.out.println(&quot;000000000&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<h3 id="4-两个表webapi和article"><a href="#4-两个表webapi和article" class="headerlink" title="4.两个表webapi和article"></a>4.两个表webapi和article</h3><p>···</p>
<p> CREATE TABLE article(<br>    id INT  AUTO_INCREMENT primary key,<br>    model VARCHAR(30) NOT NULL,<br>    detail VARCHAR(20000) NOT NULL,<br>    date DATETIME DEFAULT NOW()<br>)ENGINE = innoDB DEFAULT CHARSET=utf8;</p>
<p>CREATE TABLE webapi(<br>    num VARCHAR(20) primary key,<br>    area VARCHAR(255) NOT NULL,<br>    province VARCHAR(255) NOT NULL,<br>    city VARCHAR(255) NOT NULL,<br>    county VARCHAR(255) NOT NULL,<br>    webname VARCHAR(255)  NOT NULL,<br>    weburl  VARCHAR(255)  NOT NULL,<br>    infsource VARCHAR(255) NOT NULL,<br>    inftype   VARCHAR(255),<br>    worktype VARCHAR(255),<br>    zbyg  VARCHAR(255),<br>    zbgg    VARCHAR(255),<br>    zsjg  VARCHAR(255),<br>    ggbg VARCHAR(255),<br>    zbwj VARCHAR(255),<br>    zbdy VARCHAR(255),<br>    zbxx VARCHAR(255),<br>    kzj VARCHAR(255),<br>    lot VARCHAR(255),<br>    webtype VARCHAR(255),<br>    remark VARCHAR(255)<br>)ENGINE = innoDB DEFAULT CHARSET=utf8;<br>···</p>
<p><br><br><br></p>
<hr>
<p><br><br><br></p>
<h1 id="版本【3-0】-2016-11-27"><a href="#版本【3-0】-2016-11-27" class="headerlink" title="版本【3.0】 2016.11.27"></a>版本【3.0】 2016.11.27</h1><p>优化了程序，更加简洁效率，归纳调理，可移植性和修改性高<br>有用到ArrayList和HashMap，重构了个人工具类</p>
<p><br><br></p>
<h3 id="1-目录结构："><a href="#1-目录结构：" class="headerlink" title="1. 目录结构："></a>1. 目录结构：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">BatchCreate_file</div><div class="line">    src</div><div class="line">        extend.example </div><div class="line">            GetFirstLetter.java</div><div class="line">        main</div><div class="line">            AlterContent.java</div><div class="line">            CreateFile.java</div><div class="line">            GetTableData.java</div><div class="line">            NumBean.java</div><div class="line">            GoTask.java</div><div class="line">            tset.java 【运行文件】</div><div class="line">        Utils</div><div class="line">            IOFile.java</div><div class="line">            UseDB.java</div><div class="line">            UseString.java</div></pre></td></tr></table></figure>
<hr>
<h3 id="2-代码"><a href="#2-代码" class="headerlink" title="2. 代码"></a>2. 代码</h3><p>a-1.GetFirstLetter.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line">package extend.example;</div><div class="line"></div><div class="line">public class GetFirstLetter &#123;</div><div class="line">    private static int BEGIN = 45217;</div><div class="line">    private static int END = 63486;</div><div class="line">    </div><div class="line">    //按照声母表示，这个表是在GB2312中的出现的第一个汉字，也就是说“啊”是代表首字母a的第一个汉字</div><div class="line">    // 二十六个字母区间对应二十七个端点    // GB2312码汉字区间十进制表示</div><div class="line">    private static char[] chartable = &#123;&apos;啊&apos;, &apos;芭&apos;, &apos;擦&apos;, &apos;搭&apos;, &apos;蛾&apos;, &apos;发&apos;, &apos;噶&apos;, &apos;哈&apos;,        &apos;哈&apos;, &apos;击&apos;, &apos;喀&apos;, &apos;垃&apos;, &apos;妈&apos;, &apos;拿&apos;, &apos;哦&apos;, &apos;啪&apos;, &apos;期&apos;, &apos;然&apos;, &apos;撒&apos;, &apos;塌&apos;, &apos;塌&apos;,        &apos;塌&apos;, &apos;挖&apos;, &apos;昔&apos;, &apos;压&apos;, &apos;匝&apos;,&#125;; </div><div class="line">    private static int [] table = new int[27]; // 对应首字母区间表</div><div class="line"></div><div class="line">    // 对应首字母区间表</div><div class="line">    private static char[] initialtable = &#123;&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos;,        &apos;h&apos;, &apos;h&apos;, &apos;j&apos;, &apos;k&apos;, &apos;l&apos;, &apos;m&apos;, &apos;n&apos;, &apos;o&apos;, &apos;p&apos;, &apos;q&apos;, &apos;r&apos;, &apos;s&apos;, &apos;t&apos;,        &apos;t&apos;, &apos;t&apos;, &apos;w&apos;, &apos;x&apos;, &apos;y&apos;, &apos;z&apos;,&#125;;</div><div class="line">    </div><div class="line">    //1.初始化</div><div class="line">     static &#123;        </div><div class="line">         for (int i = 0; i &lt; 26; i++) &#123;            </div><div class="line">             table[i] = gbValue(chartable[i]);// 得到GB2312码的首字母区间端点表，十进制。 </div><div class="line">         &#125;</div><div class="line">         table[26] = END;// 区间表结尾</div><div class="line">     &#125;</div><div class="line"></div><div class="line">     /* 根据一个包含汉字的字符串返回一个汉字拼音首字母的字符串 最重要的一个方法，思路如下：一个个字符读入、判断、输出     */</div><div class="line">     public static String getFirstLetter(String sourceStr) &#123;        </div><div class="line">            String result = &quot;&quot;;        </div><div class="line">            String str = sourceStr.toLowerCase();       </div><div class="line">            int StrLength = str.length();        </div><div class="line">            int i;       </div><div class="line">            try &#123;            </div><div class="line">                for (i = 0; i &lt; StrLength; i++) &#123;                </div><div class="line">                    result += Char2Initial(str.charAt(i));            </div><div class="line">                    &#125;        </div><div class="line">                &#125; catch (Exception e) &#123;            </div><div class="line">                    result = &quot;&quot;;        </div><div class="line">                    &#125;        </div><div class="line">            return result;   </div><div class="line">        &#125;</div><div class="line">     </div><div class="line">      /* 输入字符,得到他的声母,英文字母返回对应的大写字母,其他非简体汉字返回 &apos;0&apos;     */  </div><div class="line">     private static char Char2Initial(char ch) &#123;    </div><div class="line">                // 对英文字母的处理：小写字母转换为大写，大写的直接返回</div><div class="line">              if (ch &gt;= &apos;a&apos; &amp;&amp; ch &lt;= &apos;z&apos;) &#123;            </div><div class="line">                  return ch;        </div><div class="line">               &#125;        </div><div class="line">              if (ch &gt;= &apos;A&apos; &amp;&amp; ch &lt;= &apos;Z&apos;) &#123;</div><div class="line">                  return ch;  </div><div class="line">                &#125;</div><div class="line">         </div><div class="line">              // 对非英文字母的处理：转化为首字母，然后判断是否在码表范围内，        // 若不是，则直接返回。        // 若是，则在码表内的进行判断。   </div><div class="line">              int gb = gbValue(ch);// 汉字转换首字母</div><div class="line">              if ((gb &lt; BEGIN) || (gb &gt; END))&#123;            </div><div class="line">                  return ch;        </div><div class="line">                 &#125;</div><div class="line">    </div><div class="line">              int i;       </div><div class="line">              for (i = 0; i &lt; 26; i++) &#123; // 判断匹配码表区间，匹配到就break,判断区间形如“[,)”</div><div class="line">                  if ((gb &gt;= table[i]) &amp;&amp; (gb &lt; table[i + 1])) &#123;</div><div class="line">                      break;            </div><div class="line">                      &#125;        </div><div class="line">              &#125;</div><div class="line">              if (gb == END) &#123; //补上GB2312区间最右端    </div><div class="line">                     i = 25;        </div><div class="line">                &#125;      </div><div class="line">            return initialtable[i]; // 在码表区间中，返回首字母    &#125;</div><div class="line">         &#125;</div><div class="line"></div><div class="line">     </div><div class="line">     /* 取出汉字的编码 cn 汉字     */  </div><div class="line">    private static int gbValue(char ch) &#123;</div><div class="line">        String str = new String();        </div><div class="line">        str += ch;       </div><div class="line">        try &#123;           </div><div class="line">            byte[] bytes = str.getBytes(&quot;GB2312&quot;);            </div><div class="line">            if (bytes.length &lt; 2) &#123;               </div><div class="line">                    return 0;           </div><div class="line">            &#125;            </div><div class="line">            return (bytes[0] &lt;&lt; 8 &amp; 0xff00) + (bytes[1] &amp; 0xff);      </div><div class="line">        &#125; catch (Exception e) &#123;          </div><div class="line">            return 0;        </div><div class="line">            &#125;    </div><div class="line">    &#125;   </div><div class="line">    </div><div class="line">//  public static void main(String [] args)&#123;</div><div class="line">//      //在main方法中调用FirstLetterUtil类的getFirstLetter()方法，获取姓名的首字母。如：“刘德华”获取首字母是“ldh”。</div><div class="line">//       System.out.print(getFirstLetter(&quot;日你仙人掌&quot;));//获取文字首字母的拼音</div><div class="line">//  &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>b-1.AlterContent.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line">package main;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.HashMap;</div><div class="line">import java.util.Iterator;</div><div class="line">import java.util.Map;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseString;</div><div class="line"></div><div class="line">/**更新时间： 2016.11.27</div><div class="line"> * </div><div class="line"> *  获取模版内容，根据编号各个属性值，修改BackupTask.java和入库文件，创建文件</div><div class="line"> *          @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class AlterContent &#123;</div><div class="line">    </div><div class="line"></div><div class="line">        //方法1:修改BackupTask.java,并创建</div><div class="line">        public  void aBackupTask(String path,String fileName,String content,String sign,ArrayList&lt;String&gt; rukuName_list,CreateFile cf_RK,IOFile iof,UseString us) throws IOException&#123;//参数:路径，文件名，内容，标记【修改还是创建】,入库名,,项目类，工具类             </div><div class="line">                </div><div class="line">             //1.修改模版内容</div><div class="line">            String BackupTask_model=&quot;\n\t\t&quot;+&quot;NameA=(NameB) ac.getBean(\&quot;fileName\&quot;);&quot; +</div><div class="line">                                                              &quot;\n\t\t&quot; +&quot;NameA.initNameB();&quot;;</div><div class="line">                String attributeName=&quot;&quot;;//属性名</div><div class="line">                String cStr =&quot;&quot;;</div><div class="line">                StringBuilder sb = new StringBuilder();//储存各个所有内容</div><div class="line">                for(int i=0;i&lt;rukuName_list.size();i++)&#123;</div><div class="line">                    attributeName =rukuName_list.get(i).substring(rukuName_list.get(i).lastIndexOf(&quot;_&quot;)+1);</div><div class="line">                    cStr=BackupTask_model.replace(&quot;NameA&quot;,attributeName)</div><div class="line">                                                              .replace(&quot;NameB&quot;,us.UpFirstString(attributeName))</div><div class="line">                                                              .replace(&quot;fileName&quot;,rukuName_list.get(i));</div><div class="line">                    sb.append(cStr);</div><div class="line">                &#125;</div><div class="line">                sb.append(&quot;\n\t\t//ok;&quot;);//用于叠加补充</div><div class="line">                </div><div class="line">                //2.覆盖或者修改文件</div><div class="line">                if(&quot;cover&quot;.equals(sign))&#123;//覆盖 【与上一个编号完全不同(号码不同,且不带-)】</div><div class="line">                    content=content.replace(&quot;//changeModel;&quot;,sb.toString());</div><div class="line">                    cf_RK.cBackupTask_RK(path, &quot;BackupTask.java&quot;, content, iof);        </div><div class="line">                &#125;else if(&quot;alter&quot;.equals(sign))&#123; //修改 【带-的编号,在上一个文件基础上进行叠加修改】</div><div class="line">                    content=content.replace(&quot;//ok;&quot;,sb.toString());</div><div class="line">                    cf_RK.cBackupTask_RK(path, &quot;BackupTask.java&quot;, content, iof);</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2:修改入库文件</div><div class="line">        public void aRK(String path,String fileName,String content,String type,String username,NumBean numbean,CreateFile cf_RK,GetTableData gtd_RK,IOFile iof,UseString us) throws IOException&#123;</div><div class="line">            </div><div class="line"></div><div class="line">                //一.根据类型生成相应名称</div><div class="line">                HashMap&lt;String,String&gt; hm = gtd_RK.getTypeAllName(type);</div><div class="line"></div><div class="line">                </div><div class="line">                //二.根据需求修改content</div><div class="line">                        //A.判断信息类型</div><div class="line">                        String infType =numbean.getInftype();</div><div class="line">                        if(infType !=null  &amp;&amp; ! &quot;-0-&quot;.equals(infType))&#123;                                     //zbgg.setInfoType(&quot;服务&quot;);// 信息类型</div><div class="line">                            content=content.replaceFirst(&quot;//是否有信息类型;&quot;,&quot;zbgg.setInfoType(\&quot;&quot;+infType+&quot;\&quot;);//信息类型&quot;);</div><div class="line">                        &#125;else&#123;</div><div class="line">                            content=content.replaceFirst(&quot;//是否有信息类型;&quot;,&quot;//zbgg.setInfoType(\&quot;服务\&quot;);//信息类型&quot;);</div><div class="line">                        &#125;</div><div class="line">                    </div><div class="line">                        //B.判断行业分类</div><div class="line">                        String workType=numbean.getWorktype();</div><div class="line">                        if(workType==null &amp;&amp; ! &quot;-0-&quot;.equals(workType)) &#123;                                 //zbgg.setIndustry(&quot;建筑建材&quot;); // 行业分类</div><div class="line">                            content=content.replaceFirst(&quot;//是否有行业分类;&quot;,&quot;zbgg.setIndustry(\&quot;&quot;+workType+&quot;\&quot;); //行业分类&quot;);</div><div class="line">                        &#125;else&#123;</div><div class="line">                            content=content.replaceFirst(&quot;//是否有行业分类;&quot;,&quot;//zbgg.setIndustry(\&quot;建筑建材\&quot;); // 行业分类&quot;);</div><div class="line">                        &#125;</div><div class="line"></div><div class="line">                    </div><div class="line">                //三.修改模版</div><div class="line">                content=content.replace(&quot;zhaoBiaoGongGao&quot;,hm.get(&quot;typeSpell&quot;))</div><div class="line">                                                                             .replace(&quot;ZhaoBiaoGongGao&quot;,us.UpFirstString(hm.get(&quot;typeSpell&quot;)))</div><div class="line">                                                                             .replace(&quot;ZhaobGgService&quot;,us.UpFirstString(hm.get(&quot;typeService&quot;)))</div><div class="line">                                                                             .replace(&quot;zhaobGgService&quot;,hm.get(&quot;typeService&quot;))</div><div class="line">                                                                             .replace(&quot;zbgg&quot;,type);</div><div class="line">                content=content.replaceFirst(&quot;//@程序猿;&quot;,username)</div><div class="line">                                            .replaceFirst(&quot;//@内容;&quot;,numbean.getArea()+&quot;_&quot;+numbean.getProvince()+&quot;_&quot;+numbean.getCity()+&quot;_&quot;+numbean.getCounty()+&quot;_&quot;+hm.get(&quot;typeChinese&quot;)+&quot;_&quot;+numbean.getNum())                </div><div class="line">                                            .replaceFirst(&quot;//编号;&quot;,numbean.getNum());        </div><div class="line">                String className =fileName.substring(0,fileName.lastIndexOf(&quot;.&quot;));</div><div class="line">                content=content.replaceFirst(&quot;//注解;&quot;,className)</div><div class="line">                                            .replaceFirst(&quot;//类名;&quot;,className);</div><div class="line">                content=content.replaceFirst(&quot;//Area;&quot;,numbean.getArea())</div><div class="line">                                            .replaceFirst(&quot;//Province;&quot;,numbean.getProvince())</div><div class="line">                                            .replaceFirst(&quot;//City;&quot;,numbean.getCity())</div><div class="line">                                            .replaceFirst(&quot;//County;&quot;,numbean.getCounty())</div><div class="line">                                            .replaceFirst(&quot;//Webname;&quot;,numbean.getWebname())</div><div class="line">                                            .replaceFirst(&quot;//Infsource;&quot;,numbean.getInfsource())</div><div class="line">                                            .replace(&quot;//表名;&quot;,hm.get(&quot;tableName&quot;));</div><div class="line"></div><div class="line">                </div><div class="line">                            </div><div class="line">                //四.创建编号相应类型的入库文件</div><div class="line">                cf_RK.c_RK(path,fileName, content, iof);</div><div class="line">        &#125;       </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>b-2.CreateFile.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">package main;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line">import java.sql.SQLException;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseDB;</div><div class="line"></div><div class="line">/**更新时间： 2016.11.27</div><div class="line"> * </div><div class="line"> *  创建文件【入库目录，BackupTask.java,相应编号入库文件】</div><div class="line"> *          @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class CreateFile &#123;</div><div class="line">        </div><div class="line">    //方法1：创建入库目录</div><div class="line">    public void cCatalog_RK(String path,String catalogName,IOFile iof) throws IOException&#123;//参数：路径，编号，工具类对象</div><div class="line">        iof.createCatalog(path, catalogName);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法2：BackupTask.java</div><div class="line">    public void cBackupTask_RK(String path,String fileName,String modelContent,IOFile iof) throws IOException&#123;//参数：路径，文件名，模版内容，工具类对象</div><div class="line">         iof.cFile(path, fileName, &quot;UTF-8&quot;, modelContent);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">    //方法3：入库文件【例如:HZ_02139_ZhaobGgService】</div><div class="line">    public void c_RK(String path,String fileName,String modelContent,IOFile iof) throws IOException&#123;//参数：路径，文件名，模版内容，工具类对象</div><div class="line">        iof.cFile(path, fileName, &quot;UTF-8&quot;, modelContent);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>b-3.GetTableData.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div></pre></td><td class="code"><pre><div class="line">package main;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line">import java.sql.SQLException;</div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.HashMap;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseDB;</div><div class="line"></div><div class="line">/**更新时间： 2016.11.27</div><div class="line"> * </div><div class="line"> *  获取数据，处理数据，归纳信息</div><div class="line"> *          @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class GetTableData &#123;</div><div class="line"></div><div class="line">    </div><div class="line">    //方法1：获取table表中，num编号的所有信息,储存进NumBean，返回NumBean</div><div class="line">    public  NumBean getNumInformation(String table,String num,UseDB udb) throws SQLException&#123;//参数：表名,编号,工具类</div><div class="line"></div><div class="line">            //查询table表，num字段所有数据，用&amp;分隔</div><div class="line">            String numInf = udb.select(table, &quot;num&quot;, &quot;num=&apos;&quot;+num+&quot;&apos;&quot;, &apos;*&apos;);</div><div class="line">            String [] numInf_arrays=numInf.split(&quot;&amp;&quot;);</div><div class="line">            </div><div class="line">            //表共21列，Numbean共21个属性，拥有Getters和Setters</div><div class="line">            NumBean nb = new NumBean();</div><div class="line">                nb.setNum(numInf_arrays[0]);</div><div class="line">                nb.setArea(numInf_arrays[1]);</div><div class="line">                nb.setProvince(numInf_arrays[2]);</div><div class="line">                nb.setCity(numInf_arrays[3]);</div><div class="line">                nb.setCounty(numInf_arrays[4]);</div><div class="line">                nb.setWebname(numInf_arrays[5]);</div><div class="line">                nb.setWeburl(numInf_arrays[6]);</div><div class="line">                nb.setInfsource(numInf_arrays[7]);</div><div class="line">                nb.setInftype(numInf_arrays[8]);</div><div class="line">                nb.setWorktype(numInf_arrays[9]);</div><div class="line">                nb.setZbyg(numInf_arrays[10]);</div><div class="line">                nb.setZbgg(numInf_arrays[11]);</div><div class="line">                nb.setZsjg(numInf_arrays[12]);</div><div class="line">                nb.setGgbg(numInf_arrays[13]);</div><div class="line">                nb.setZbwj(numInf_arrays[14]);</div><div class="line">                nb.setZbdy(numInf_arrays[15]);</div><div class="line">                nb.setZbxx(numInf_arrays[16]);</div><div class="line">                nb.setKzj(numInf_arrays[17]);</div><div class="line">                nb.setLot(numInf_arrays[18]);</div><div class="line">                nb.setWebtype(numInf_arrays[19]);</div><div class="line">                nb.setRemark(numInf_arrays[20]);</div><div class="line">        </div><div class="line">        return nb;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法2：获取table表的，所有编号</div><div class="line">    public ArrayList&lt;String&gt; getAllNum(String table,UseDB udb) throws SQLException&#123; //参数: 表名，工具类</div><div class="line">            ArrayList&lt;String&gt; numList = new  ArrayList&lt;String&gt;();</div><div class="line">            </div><div class="line">            String allNum =udb.selectAllColumn(table,&quot;num&quot;);</div><div class="line">            String [] allNum_arrays = allNum.split(&quot;##&quot;);</div><div class="line">            for(int i=0;i&lt;allNum_arrays.length;i++)&#123;</div><div class="line">                numList.add(allNum_arrays[i]);</div><div class="line">            &#125;</div><div class="line">            return numList;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法3:获取当前编号拥有URL的字段名</div><div class="line">    public ArrayList&lt;String&gt; getNum_HaveURLRecord(String table,String num,UseDB udb) throws SQLException&#123; //参数：表名，编号，工具类</div><div class="line"></div><div class="line">        //查询数据库table表，num字段的11-18行，得到拥有记录的列名的ArrayList</div><div class="line">        ArrayList&lt;String&gt; alist=udb.selectAskinformation_Scope(table,&quot;num=&apos;&quot;+num+&quot;&apos;&quot;, &quot;11-18&quot;);//【11-18是招标预告到控制价】</div><div class="line"></div><div class="line">        return alist;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    //方法4：根据列名，得到相应类型的字符串</div><div class="line">    public String getTypename(String columnName)&#123; //参数：列名</div><div class="line">                String type=&quot;&quot;;</div><div class="line"></div><div class="line">                if(columnName.equals(&quot;zbyg&quot;))&#123;</div><div class="line">                    type=&quot;ZhaobYgService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zbgg&quot;))&#123;</div><div class="line">                    type=&quot;ZhaobGgService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zsjg&quot;))&#123;</div><div class="line">                    type=&quot;ZisJgService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;ggbg&quot;))&#123;</div><div class="line">                    type=&quot;GonggBgService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zbwj&quot;))&#123;</div><div class="line">                    type=&quot;ZhaobWjService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zbdy&quot;))&#123;</div><div class="line">                    type=&quot;ZhaobDyService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zbxx&quot;))&#123;</div><div class="line">                    type=&quot;ZhongbXxService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;kzj&quot;))&#123;</div><div class="line">                    type=&quot;KongZjService&quot;;</div><div class="line">                &#125;</div><div class="line">        </div><div class="line">        return type;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法5:判断num编号属否在scope区间里面，返回布尔类型参数【true-属于，false-不属于】</div><div class="line">    public Boolean getMinMaxScope(String scope,int num)&#123;//参数：范围，编号</div><div class="line">            Boolean sign = false;//判断标识，默认为true</div><div class="line">            </div><div class="line">            String [] scope_arrays = scope.split(&quot;-&quot;);</div><div class="line">            int minScope =Integer.parseInt(scope_arrays[0]);</div><div class="line">            int maxScope =Integer.parseInt(scope_arrays[1]);</div><div class="line">            </div><div class="line">                if(minScope &lt;= num &amp;&amp; num &lt;= maxScope)&#123;</div><div class="line">                    sign =true;</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">            return sign;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法6：根据类型生成相应名称，返回HaspMap【无序键值队】</div><div class="line">    public HashMap&lt;String,String&gt; getTypeAllName(String type)&#123;  //参数：类型名，也是列名</div><div class="line">        HashMap&lt;String,String&gt; hm = new HashMap&lt;String,String&gt;();</div><div class="line"></div><div class="line">                if(type.equals(&quot;zbyg&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;zhaoBiaoYuGao&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhaobYgService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;招标预告&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhao_biao_yu_gao&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zbgg&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;zhaoBiaoGongGao&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhaobGgService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;招标公告&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhao_biao_gong_gao&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zsjg&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;ziShenJieGuo&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zisJgService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;咨审结果&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zi_shen_jie_guo&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;ggbg&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;gongGaoBianGeng&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;gonggBgService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;公告变更&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_gong_gao_bian_geng&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zbwj&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;zhaoBiaoWenJian&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhaobWjService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;招标文件&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhao_biao_wen_jian&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zbdy&quot;))&#123;</div><div class="line">                    hm.put(&quot;typeSpell&quot;, &quot;ZhaoBiaoDaYi&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhaobDyService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;招标答疑&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhao_biao_da_yi&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zbxx&quot;))&#123;</div><div class="line">                    hm.put(&quot;typeSpell&quot;, &quot;zhongBiaoXinXi&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhongbXxService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;中标信息&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhong_biao_xin_xi&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;kzj&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;kongZhiJia&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;kongZjService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;控制价&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_kong_zhi_jia&quot;);</div><div class="line">                &#125;               </div><div class="line">        </div><div class="line">        return hm;      </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法6: 插入模版数据,并返回模版内容</div><div class="line">    public String getModel(String filePath,IOFile iof,UseDB udb) throws IOException,SQLException&#123;//参数：文件路径，工具类</div><div class="line">        </div><div class="line">        //1.读取文件内容                                                                                                      </div><div class="line">        String fileContent=iof.readFileContent_String(filePath,&quot;GBK&quot;); //注意：路径的话用/或者\\都可以,数据库的默认编码是GBK,如果是UTF-8\   </div><div class="line">        </div><div class="line">        //2.判断是否存在相同模版</div><div class="line">        String modeInf = udb.select(&quot;article&quot;, &quot;model&quot;, &quot;model=&apos;&quot;+filePath+&quot;&apos;&quot;, &apos;*&apos;);</div><div class="line">        if(modeInf.indexOf(filePath) == -1)&#123;</div><div class="line">            udb.insert(&quot;article&quot;,&quot;model,detail&quot;,filePath+&quot;&amp;&amp;&amp;&amp;&amp;&quot;+fileContent,&quot;?,?&quot;); </div><div class="line">        &#125;else&#123;</div><div class="line">            System.out.println(&quot;*******************已存在相同文件名的模版，不进行重复插入*******************&quot;);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        return fileContent;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>b-4.NumBean.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div></pre></td><td class="code"><pre><div class="line">package main;</div><div class="line"></div><div class="line">/**更新时间： 2016.11.27</div><div class="line"> * </div><div class="line"> *  JavaBena，每一个编号</div><div class="line"> *          @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class NumBean &#123;</div><div class="line">    </div><div class="line">        private String num;             //网站数据源编码【编号】</div><div class="line">        private String area;                //区域</div><div class="line">        private String province;        //省份</div><div class="line">        private String city;                    //城市</div><div class="line">        private String county;          //区县</div><div class="line">        private String webname;      //网站数据源名称</div><div class="line">        private String weburl;          //网址</div><div class="line">        private String infsource;       //信息来源</div><div class="line">        private String inftype;         //信息类型</div><div class="line">        private String worktype;        //行业分类</div><div class="line">        private String zbyg;                //招标预告</div><div class="line">        private String zbgg;                //招标公告</div><div class="line">        private String zsjg;                //咨审结果</div><div class="line">        private String ggbg;                //公告变更</div><div class="line">        private String zbwj;                //招标文件</div><div class="line">        private String zbdy;                //招标答疑</div><div class="line">        private String zbxx;                //中标信息</div><div class="line">        private String kzj;                 //控制价</div><div class="line">        private String lot;                 //批次</div><div class="line">        private String webtype;     //原网站信息分类</div><div class="line">        private String remark;          //备注</div><div class="line">    </div><div class="line">            public String getNum() &#123;</div><div class="line">                return num;</div><div class="line">            &#125;</div><div class="line">            public String getArea() &#123;</div><div class="line">                return area;</div><div class="line">            &#125;</div><div class="line">            public String getProvince() &#123;</div><div class="line">                return province;</div><div class="line">            &#125;</div><div class="line">            public String getCity() &#123;</div><div class="line">                return city;</div><div class="line">            &#125;</div><div class="line">            public String getCounty() &#123;</div><div class="line">                return county;</div><div class="line">            &#125;</div><div class="line">            public String getWebname() &#123;</div><div class="line">                return webname;</div><div class="line">            &#125;</div><div class="line">            public String getWeburl() &#123;</div><div class="line">                return weburl;</div><div class="line">            &#125;</div><div class="line">            public String getInfsource() &#123;</div><div class="line">                return infsource;</div><div class="line">            &#125;</div><div class="line">            public String getInftype() &#123;</div><div class="line">                return inftype;</div><div class="line">            &#125;</div><div class="line">            public String getWorktype() &#123;</div><div class="line">                return worktype;</div><div class="line">            &#125;</div><div class="line">            public String getZbyg() &#123;</div><div class="line">                return zbyg;</div><div class="line">            &#125;</div><div class="line">            public String getZbgg() &#123;</div><div class="line">                return zbgg;</div><div class="line">            &#125;</div><div class="line">            public String getZsjg() &#123;</div><div class="line">                return zsjg;</div><div class="line">            &#125;</div><div class="line">            public String getGgbg() &#123;</div><div class="line">                return ggbg;</div><div class="line">            &#125;</div><div class="line">            public String getZbwj() &#123;</div><div class="line">                return zbwj;</div><div class="line">            &#125;</div><div class="line">            public String getZbdy() &#123;</div><div class="line">                return zbdy;</div><div class="line">            &#125;</div><div class="line">            public String getZbxx() &#123;</div><div class="line">                return zbxx;</div><div class="line">            &#125;</div><div class="line">            public String getKzj() &#123;</div><div class="line">                return kzj;</div><div class="line">            &#125;</div><div class="line">            public String getLot() &#123;</div><div class="line">                return lot;</div><div class="line">            &#125;</div><div class="line">            public String getWebtype() &#123;</div><div class="line">                return webtype;</div><div class="line">            &#125;</div><div class="line">            public String getRemark() &#123;</div><div class="line">                return remark;</div><div class="line">            &#125;</div><div class="line">            public void setNum(String num) &#123;</div><div class="line">                this.num = num;</div><div class="line">            &#125;</div><div class="line">            public void setArea(String area) &#123;</div><div class="line">                this.area = area;</div><div class="line">            &#125;</div><div class="line">            public void setProvince(String province) &#123;</div><div class="line">                this.province = province;</div><div class="line">            &#125;</div><div class="line">            public void setCity(String city) &#123;</div><div class="line">                this.city = city;</div><div class="line">            &#125;</div><div class="line">            public void setCounty(String county) &#123;</div><div class="line">                this.county = county;</div><div class="line">            &#125;</div><div class="line">            public void setWebname(String webname) &#123;</div><div class="line">                this.webname = webname;</div><div class="line">            &#125;</div><div class="line">            public void setWeburl(String weburl) &#123;</div><div class="line">                this.weburl = weburl;</div><div class="line">            &#125;</div><div class="line">            public void setInfsource(String infsource) &#123;</div><div class="line">                this.infsource = infsource;</div><div class="line">            &#125;</div><div class="line">            public void setInftype(String inftype) &#123;</div><div class="line">                this.inftype = inftype;</div><div class="line">            &#125;</div><div class="line">            public void setWorktype(String worktype) &#123;</div><div class="line">                this.worktype = worktype;</div><div class="line">            &#125;</div><div class="line">            public void setZbyg(String zbyg) &#123;</div><div class="line">                this.zbyg = zbyg;</div><div class="line">            &#125;</div><div class="line">            public void setZbgg(String zbgg) &#123;</div><div class="line">                this.zbgg = zbgg;</div><div class="line">            &#125;</div><div class="line">            public void setZsjg(String zsjg) &#123;</div><div class="line">                this.zsjg = zsjg;</div><div class="line">            &#125;</div><div class="line">            public void setGgbg(String ggbg) &#123;</div><div class="line">                this.ggbg = ggbg;</div><div class="line">            &#125;</div><div class="line">            public void setZbwj(String zbwj) &#123;</div><div class="line">                this.zbwj = zbwj;</div><div class="line">            &#125;</div><div class="line">            public void setZbdy(String zbdy) &#123;</div><div class="line">                this.zbdy = zbdy;</div><div class="line">            &#125;</div><div class="line">            public void setZbxx(String zbxx) &#123;</div><div class="line">                this.zbxx = zbxx;</div><div class="line">            &#125;</div><div class="line">            public void setKzj(String kzj) &#123;</div><div class="line">                this.kzj = kzj;</div><div class="line">            &#125;</div><div class="line">            public void setLot(String lot) &#123;</div><div class="line">                this.lot = lot;</div><div class="line">            &#125;</div><div class="line">            public void setWebtype(String webtype) &#123;</div><div class="line">                this.webtype = webtype;</div><div class="line">            &#125;</div><div class="line">            public void setRemark(String remark) &#123;</div><div class="line">                this.remark = remark;</div><div class="line">            &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>b-5.GoTask.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div></pre></td><td class="code"><pre><div class="line">package main;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line"></div><div class="line">import extend.example.GetFirstLetter;</div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseDB;</div><div class="line">import Utils.UseString;</div><div class="line"></div><div class="line"></div><div class="line">/**更新时间：2016.11.27</div><div class="line"> *      </div><div class="line"> * 任务流程</div><div class="line"> *           @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class GoTask &#123;</div><div class="line">    </div><div class="line">    </div><div class="line">    private String path=&quot;C:/Users/Liu-shuwei/Desktop\\&quot;;                                 //路径</div><div class="line">    private String catalogName=&quot;入库【版本3.0,包含新表and旧表】&quot;;               //文件名</div><div class="line">    private String numScope=&quot;01000-05000&quot;;                                                  //编号范围区间</div><div class="line">    private String useTable=&quot;webapi2&quot;;                                                              //使用哪个表的数据</div><div class="line">    private String username=&quot;某男子&quot;;                                                                 //程序员名称</div><div class="line">    </div><div class="line">    </div><div class="line">    public static long  useTime()&#123;</div><div class="line">        return System.currentTimeMillis();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //任务流程</div><div class="line">    public void GO() &#123;</div><div class="line">        long beginTime=useTime();   //开始时间</div><div class="line">        </div><div class="line">        //执行任务流程</div><div class="line">        try&#123;</div><div class="line">            </div><div class="line">            //一.获取对象</div><div class="line">            CreateFile cf_RK =new CreateFile();</div><div class="line">            GetTableData  gtd_RK = new GetTableData();</div><div class="line">            AlterContent afc = new AlterContent();</div><div class="line">            </div><div class="line">            UseDB udb = new UseDB();</div><div class="line">            IOFile iof=new IOFile();</div><div class="line">            UseString us = new UseString();</div><div class="line">            </div><div class="line">            GetFirstLetter gfl = new GetFirstLetter();</div><div class="line"></div><div class="line">            </div><div class="line">            udb.connDatabase(&quot;batchcreate_file&quot;);//连接数据库</div><div class="line">            </div><div class="line">            </div><div class="line">            //二.创建大目录,往数据库插入模版数据</div><div class="line">            iof.createCatalog(path, catalogName);</div><div class="line">            String model1_BT =gtd_RK.getModel(&quot;model_file/BackupTask.java&quot;,iof,udb);</div><div class="line">            String model2_RK =gtd_RK.getModel(&quot;model_file/ZhaobGgServiceModel.java&quot;,iof,udb);</div><div class="line">            </div><div class="line">            </div><div class="line">            </div><div class="line">            //三.获取数据表数据，并生成目录and文件</div><div class="line">                //三-1获取所有编号</div><div class="line">                ArrayList&lt;String&gt; numList =gtd_RK.getAllNum(useTable, udb) ; </div><div class="line">                </div><div class="line">                </div><div class="line">                //三-2.遍历所有编号</div><div class="line">                for(int i=0;i&lt;numList.size();i++)&#123;</div><div class="line">                </div><div class="line">                    String num=numList.get(i);                                  //当前编号</div><div class="line">                    String num_=numList.get(i) .replace(&quot;-&quot;,&quot;_&quot;);       //编号下划线形态</div><div class="line">                    String changePath =&quot;&quot;;                                          //变化路径</div><div class="line">                    </div><div class="line">                    //3-2判断当前编号是否在范围区间</div><div class="line">                    if(gtd_RK.getMinMaxScope(numScope, us.getInt(num.substring(0,5))))&#123;                              //范围，编号 进行比较</div><div class="line"></div><div class="line">                        //a.获取当前编号的所有数据，并储存到JavaBean</div><div class="line">                        NumBean numBean =gtd_RK.getNumInformation(useTable, num, udb);</div><div class="line">                        </div><div class="line">                        </div><div class="line">                        //b.生成入库文件名，存储进ArrayList</div><div class="line">                         ArrayList&lt;String&gt; ifURL_typelist =gtd_RK.getNum_HaveURLRecord(useTable, num, udb); //得到当前编号含有URL的入库文件类型</div><div class="line">                         ArrayList&lt;String &gt; rukuName_list=new ArrayList&lt;String&gt;();                                          //用于储存当前编号所需要的所有入库文件名</div><div class="line">                         for(int k=0;k&lt;ifURL_typelist.size();k++)&#123;</div><div class="line">                             String typeName =gtd_RK.getTypename(ifURL_typelist.get(k));                                                //入库类型</div><div class="line">                             String rukuName=gfl.getFirstLetter(numBean.getArea()).toUpperCase()+&quot;_&quot;+num_+&quot;_&quot;+typeName;     //入库文件完整名</div><div class="line">                             rukuName_list.add(rukuName);</div><div class="line">                         &#125;</div><div class="line">                        </div><div class="line">                        </div><div class="line">                        //d.生成入库子目录</div><div class="line">                        String catalog_1=&quot;入库-&quot;+num.substring(0,5);                          //目录名</div><div class="line">                        changePath =path+&quot;/&quot;+catalogName;                                      //子路径1</div><div class="line">                        cf_RK.cCatalog_RK(changePath,&quot;入库-&quot;+num.substring(0,5),iof);</div><div class="line">                        </div><div class="line">                        </div><div class="line">                        //生成BackupTask.java</div><div class="line">                         changePath +=&quot;/&quot;+catalog_1;                                 //子路径1-2</div><div class="line">                         String sign = &quot;cover&quot;;                                                 //判断当前编号是需要修改还是覆盖,默认是覆盖【带-编号是alter,不带-是cover】</div><div class="line">                            if(i &gt; 0)&#123;                                                                  //大于0的时候进行判断    【顶部位置没有上一个编号】</div><div class="line">                                if(us.getInt(numList.get(i-1).substring(0,5)) == us.getInt(num.substring(0,5)))&#123;            </div><div class="line">                                    sign=&quot;alter&quot;;                                                   //如果和上个编号相等，则修改</div><div class="line">                                &#125;</div><div class="line">                            &#125;</div><div class="line">                         if(&quot;cover&quot;.equals(sign))&#123;                      //覆盖</div><div class="line">                                    afc.aBackupTask(changePath,&quot;BackupTask.java&quot;, model1_BT,sign,rukuName_list, cf_RK, iof,us);</div><div class="line">                         &#125;else if(&quot;alter&quot;.equals(sign))&#123;                //修改</div><div class="line">                             String ageBackupTask=iof.readFileContent_String(changePath+&quot;/BackupTask.java&quot;,&quot;GBK&quot;); //读取已经已经存在的BackupTask.java</div><div class="line">                             afc.aBackupTask(changePath,&quot;BackupTask.java&quot;,ageBackupTask ,sign,rukuName_list, cf_RK, iof,us);</div><div class="line">                         &#125;</div><div class="line">                         </div><div class="line">                        </div><div class="line">                        //e.生成入库文件</div><div class="line">                        cf_RK.cCatalog_RK(changePath,&quot;imp&quot;,iof);        //生成imp目录</div><div class="line">                        changePath +=&quot;/imp&quot;;                                         //子路径1-2-3</div><div class="line">                        for(int k=0;k&lt;ifURL_typelist.size();k++)&#123;                //根据拥有URL的类型，循环生成入库文件</div><div class="line">                            afc.aRK(changePath, rukuName_list.get(k)+&quot;.java&quot;, model2_RK,ifURL_typelist.get(k),username,numBean,cf_RK, gtd_RK,iof, us);</div><div class="line">                        &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            </div><div class="line">        </div><div class="line">            //四.关闭资源</div><div class="line">            udb.closeAll();</div><div class="line">            </div><div class="line">        &#125;catch(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //结束时间</div><div class="line">        long endTime=useTime();</div><div class="line">        System.out.println(&quot;总共用时:&quot;+(endTime-beginTime)+&quot;毫秒！&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>b-6.test.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">package main;</div><div class="line"></div><div class="line">public class test &#123;</div><div class="line">    </div><div class="line"></div><div class="line">    //测试主方法</div><div class="line">    public static void main(String [] args)&#123;</div><div class="line">    </div><div class="line">        //创建任务流程对象</div><div class="line">        GoTask gt= new GoTask();</div><div class="line">        </div><div class="line">        //执行流程(参数:路径,某个表数据,目录名)</div><div class="line">        gt.GO();</div><div class="line">    </div><div class="line">        </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>c-1.IOFile.java<br>c-2.UseDB.java<br>c-3.UseString.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div></pre></td><td class="code"><pre><div class="line">***********************c-1*************************************</div><div class="line">package Utils;</div><div class="line"></div><div class="line">import java.io.BufferedWriter;</div><div class="line">import java.io.File;</div><div class="line">import java.io.FileInputStream;</div><div class="line">import java.io.FileOutputStream;</div><div class="line">import java.io.IOException;</div><div class="line">import java.io.InputStream;</div><div class="line">import java.io.InputStreamReader;</div><div class="line">import java.io.OutputStreamWriter;</div><div class="line"></div><div class="line">/** 更新时间： 2016.11.26</div><div class="line"> *   </div><div class="line"> *  数据库封装类</div><div class="line"> *          方法1-读取</div><div class="line"> *          方法2-创建</div><div class="line"> *          方法3-追加内容</div><div class="line"> *              @author suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class IOFile &#123;</div><div class="line">    </div><div class="line">        //方法1-1:读取文件内容【字节流】【只适用与读取英文，数字，无法设置编码格式】</div><div class="line">        public String readFileContent_Char(String filePath) throws IOException&#123; //参数:文件路径,编码格式</div><div class="line">            </div><div class="line">            String content=&quot;&quot;;</div><div class="line">            InputStream inf=new FileInputStream(filePath);</div><div class="line">            for(int i=0;i&lt;inf.available();i++)&#123;</div><div class="line">                content+=(char)inf.read();</div><div class="line">            &#125;</div><div class="line">            </div><div class="line"></div><div class="line">            return &quot;\&apos;&quot;+content+&quot;\&apos;&quot;;   </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法1-2:读取文件内容【字符流】【可以设置编码，读取中文，英文，数字】</div><div class="line">          public String readFileContent_String(String filePath,String encoding) throws IOException&#123; //参数: 路径,编码格式</div><div class="line">                    StringBuilder sb =new StringBuilder();</div><div class="line">                    </div><div class="line">                    File f=new File(filePath);//定位文件【小弊端，没有文件的话会自动新建】</div><div class="line">                    </div><div class="line">                    FileInputStream fip=new FileInputStream(f);</div><div class="line">                    InputStreamReader reader=new InputStreamReader(fip,encoding);</div><div class="line">                    while(reader.ready())&#123;</div><div class="line">                        sb.append((char)reader.read());</div><div class="line">                    &#125;</div><div class="line">                    </div><div class="line">                return sb.toString();   </div><div class="line">           &#125;        </div><div class="line">        </div><div class="line">        </div><div class="line">        </div><div class="line">        //方法3-1: 创建目录</div><div class="line">        public void createCatalog(String path,String catalogName)&#123;//参数：路径，目录名</div><div class="line">            </div><div class="line">            File d=new File(path+&quot;/&quot;+catalogName);</div><div class="line">            d.mkdir();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法3-2: 创建文件,写入内容</div><div class="line">        public void cFile(String path,String fileName,String encoding,String content) throws IOException&#123; //参数：路径,文件名.格式,编码格式,文件内容</div><div class="line">            File f=new File(path+&quot;/&quot;+fileName);</div><div class="line">            </div><div class="line">            FileOutputStream fop= new FileOutputStream(f);</div><div class="line">            OutputStreamWriter writer=new OutputStreamWriter(fop,&quot;UTF-8&quot;);</div><div class="line">            writer.append(content);</div><div class="line"></div><div class="line">            writer.close();</div><div class="line">            fop.close();</div><div class="line">            System.out.println( &quot;*********************&quot;+fileName+&quot;成功创建！***********************************&quot;);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法3-3:追加文件内容【若不存在文件，则会在路径path下，新建filnName文件】</div><div class="line">        public void addContentFile(String path,String fileName,String content) throws IOException&#123; //参数：路径，文件名，追加的内容</div><div class="line">            File f=new File(path+&quot;/&quot;+fileName); </div><div class="line"></div><div class="line">            FileOutputStream fs = new FileOutputStream(f,true);</div><div class="line">            OutputStreamWriter osw = new OutputStreamWriter(fs);</div><div class="line">            BufferedWriter out = new BufferedWriter(osw);     </div><div class="line">                    </div><div class="line">            out.write(content);     </div><div class="line">            out.close();     </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">************************************c-2***********************************************************</div><div class="line">package Utils;</div><div class="line"></div><div class="line">import java.io.UnsupportedEncodingException;</div><div class="line">import java.sql.Connection;</div><div class="line">import java.sql.DriverManager;</div><div class="line">import java.sql.PreparedStatement;</div><div class="line">import java.sql.ResultSet;</div><div class="line">import java.sql.ResultSetMetaData;</div><div class="line">import java.sql.SQLException;</div><div class="line">import java.sql.Statement;</div><div class="line">import java.util.ArrayList;</div><div class="line"></div><div class="line"></div><div class="line">/** 更新时间： 2016.11.26</div><div class="line"> *   </div><div class="line"> *  数据库封装类</div><div class="line"> *          方法1-基础使用</div><div class="line"> *          方法2-查询 【SELECT】</div><div class="line"> *          方法3-添加【INSERT】</div><div class="line"> *              @author suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class UseDB &#123;</div><div class="line">    </div><div class="line">    </div><div class="line">    private String drive=&quot;com.mysql.jdbc.Driver&quot;;           //数据库驱动</div><div class="line">    private String link=&quot;jdbc:mysql://127.0.0.1:3306/&quot;;     //mysql—JDBC链接+IP地址+端口</div><div class="line"></div><div class="line">    </div><div class="line">    private String username=&quot;root&quot;;                         //用户名</div><div class="line">    private String password=&quot;liushuwei&quot;;                    //密码</div><div class="line">    </div><div class="line">    private Connection conn;</div><div class="line">    private Statement st;</div><div class="line">    private PreparedStatement pst;</div><div class="line">    private ResultSet rs;</div><div class="line">    private ResultSetMetaData rsmd;//获取列的信息</div><div class="line">    </div><div class="line">    private String sql; //sql语句</div><div class="line">    </div><div class="line"></div><div class="line">        //无参构造方法</div><div class="line">        public UseDB()&#123; </div><div class="line">            </div><div class="line">        &#125;</div><div class="line">    </div><div class="line">        //方法1: 连接database数据库</div><div class="line">        public void connDatabase(String database)  throws SQLException,ClassNotFoundException&#123; //参数：数据库名称</div><div class="line">             Class.forName(drive);</div><div class="line">             conn=DriverManager.getConnection(link+database,username,password); </div><div class="line">             st=conn.createStatement();</div><div class="line">             System.out.println(&quot;数据库连接成功......&quot;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        //访法1-2: 使用database数据库                                </div><div class="line">        public void useDatabase(String database) throws SQLException&#123;//参数: 数据库名称</div><div class="line">            </div><div class="line">                sql=&quot;USE &quot;+database+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line"></div><div class="line">            System.out.println(&quot;********************目前使用&quot;+database+&quot;数据库**************************&quot;);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法1-3关闭所有对象</div><div class="line">        public void closeAll() throws SQLException&#123;</div><div class="line">            </div><div class="line">            if(rs!=null)  rs.close();//关闭ResultSet</div><div class="line">            if(pst!=null)   pst.close();    //关闭PreparedStatement</div><div class="line">            if(st!=null) st.close();//关闭Statement</div><div class="line">            if(conn!=null)  conn.close(); //关闭Connection</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-1:查询table表中record字段满足condition条件的值,返回查询内容【字段值】 ，不能用于 * 查询</div><div class="line">        public String select(String table,String record,String condition)throws SQLException&#123;//参数: 表名,字段名,WHERE条件</div><div class="line">                StringBuilder sb= new StringBuilder();</div><div class="line">                </div><div class="line">                sql=&quot;SELECT &quot;+record+&quot; FROM &quot; +table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                ResultSetMetaData rsm =rs.getMetaData(); //获得列集</div><div class="line">                while(rs.next())&#123;</div><div class="line">                    sb.append(rs.getString(record));</div><div class="line">                &#125;</div><div class="line"></div><div class="line">            return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-2:查询table表中record字段满足condition条件的值,打印到控制台，并返回一个字符串【&amp;换列】</div><div class="line">                public String select(String table,String record,String condition,char o)throws SQLException&#123;//参数: 表名,字段名,WHERE条件</div><div class="line">                        StringBuilder sb= new StringBuilder();</div><div class="line">                        </div><div class="line">                        sql=&quot;SELECT * FROM &quot; +table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                        rs=st.executeQuery(sql);</div><div class="line">                        rsmd=rs.getMetaData();</div><div class="line">                        while(rs.next())&#123;</div><div class="line">                            for(int i=1;i&lt;=rsmd.getColumnCount();i++)&#123;  //获取总列数 数据字段从1开始</div><div class="line">                                if(rs.getString(i).equals(&quot;&quot;))&#123;</div><div class="line">                                    sb.append(&quot;-0-&amp;&quot;);</div><div class="line">                                &#125;else&#123;</div><div class="line">                                    sb.append(rs.getString(i)+&quot;&amp;&quot;);</div><div class="line">                                &#125;</div><div class="line">                                System.out.print(rs.getString(i)+&quot;\t&quot;);  //输出每个字段值，间隔一个Tab长度</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line"></div><div class="line">                    return sb.toString();</div><div class="line">                &#125;</div><div class="line">        </div><div class="line">        //方法2-3:查询table所有数据的数据,打印到控制台，并返回一个字符串 【&amp;换列，##换行】</div><div class="line">        public String select(String table) throws SQLException&#123;//参数: 表名</div><div class="line">                StringBuilder sb= new StringBuilder();</div><div class="line">                </div><div class="line">                sql=&quot;SELECT * FROM &quot; +table+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                rsmd =rs.getMetaData(); //获得列集</div><div class="line">                </div><div class="line">                    while(rs.next())&#123;//光标移动</div><div class="line">                        for(int i=1;i&lt;=rsmd.getColumnCount();i++)&#123;  //获取总列数</div><div class="line">                            sb.append(rs.getString(i)+&quot;&amp;&quot;);</div><div class="line">                            System.out.print(rs.getString(i)+&quot;\t&quot;);  //输出每个字段值，间隔一个Tab长度</div><div class="line">                        &#125;</div><div class="line">                        System.out.println();//换行</div><div class="line">                        sb.append(&quot;##&quot;);</div><div class="line">                    &#125;</div><div class="line">    </div><div class="line">            </div><div class="line">                return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">            </div><div class="line">        </div><div class="line">        //方法2-4:查询table表,record字段的所有记录值(所有行)【##换行】</div><div class="line">        public String selectAllColumn(String table,String record) throws SQLException&#123;</div><div class="line">            StringBuilder sb= new StringBuilder();</div><div class="line">            </div><div class="line">             sql=&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot;;&quot;;</div><div class="line">             rs=st.executeQuery(sql);</div><div class="line">             while(rs.next())&#123;</div><div class="line">                 sb.append(rs.getString(1)+&quot;##&quot;);</div><div class="line">             &#125;</div><div class="line">             </div><div class="line">            return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-6：查询table表,满足content条件【具有唯一性】，有记录的字段直接返回记录值,没有则返回null</div><div class="line">        public String selectIfExist_CheckRecord(String table,String record,String condition) throws SQLException&#123;//参数: 表名,字段名，条件</div><div class="line">                </div><div class="line">                sql=&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                String record_content=null;</div><div class="line">                if(rs.next())&#123;</div><div class="line">                    record_content=rs.getString(1);</div><div class="line">                &#125;</div><div class="line"></div><div class="line">            return record_content;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法2-7:查询table表,根据条件condition【具有唯一性】,判断整行记录那个字段拥有记录，有记录的字段返回字段名和值【&amp;&amp;&amp;&amp;&amp;分隔】</div><div class="line">        public ArrayList&lt;String&gt; selectIfExist_CheckRecord(String table,String condition,char o) throws SQLException&#123;//参数: 表名，条件,*</div><div class="line">            </div><div class="line">            ArrayList&lt;String&gt; al = new ArrayList&lt;String&gt;();</div><div class="line">                </div><div class="line">                sql=&quot;SELECT * FROM &quot;+table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                System.out.println(sql);</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                rsmd=rs.getMetaData();</div><div class="line"></div><div class="line">                while(rs.next())&#123;</div><div class="line">                    for(int i=1;i&lt;=rsmd.getColumnCount();i++)&#123;  </div><div class="line">                        al.add(rsmd.getColumnName(i));//只要列名</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">            return al;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-8: 查询table表,满足条件condition的,返回规定范围行数的记录的列名【&amp;分隔每列】</div><div class="line">        public ArrayList&lt;String&gt; selectAskinformation_Scope(String table,String condition,String scope) throws SQLException&#123; //参数:表名,条件,范围行数【使用-进行分隔,例如1-5】</div><div class="line">//              StringBuilder sb= new StringBuilder();</div><div class="line">                ArrayList&lt;String&gt; alist = new  ArrayList&lt;String&gt;();</div><div class="line">                </div><div class="line">                String [] scope_arrays =scope.split(&quot;-&quot;);</div><div class="line">                int begin=Integer.parseInt(scope_arrays[0]);</div><div class="line">                int end=Integer.parseInt(scope_arrays[1]);</div><div class="line">                </div><div class="line">                sql=&quot;SELECT * FROM &quot;+table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                rsmd=rs.getMetaData();</div><div class="line">                while(rs.next())&#123;</div><div class="line">                    for(int i=begin;i&lt;=end;i++)&#123; //遍历范围区间的字段</div><div class="line">                        if(rs.getString(i)==null || rs.getString(i).length()&lt;2) continue;</div><div class="line">                        alist.add(rsmd.getColumnName(i));//只要列名</div><div class="line">                    &#125;       </div><div class="line">                &#125;</div><div class="line"></div><div class="line">            return alist;   </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-9：查询table所有记录总数，返回记录总数</div><div class="line">        public int select_allCount(String table) throws SQLException&#123;//参数：表名</div><div class="line">            </div><div class="line">            </div><div class="line">            sql=&quot;SELECT count(*)  FROM &quot; +table+&quot;;&quot;;</div><div class="line">            rs=st.executeQuery(sql);</div><div class="line">            rs.next();</div><div class="line">            </div><div class="line">            int recordCount =Integer.parseInt(rs.getString(1));</div><div class="line"></div><div class="line">            return recordCount;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法3-1: 往table表record字段,插入一行content数据【少量数据(标题，日期等)】【多字段插入   ,分隔字段     ,号分隔内容】</div><div class="line">        public void insert(String table,String record,String content) throws SQLException&#123;//参数: 表名,字段,内容</div><div class="line">                    String sql=&quot;INSERT INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+content+&quot;);&quot;;</div><div class="line">                    int i=st.executeUpdate(sql);</div><div class="line">                    if(i!=-1)&#123;</div><div class="line">                        System.out.println(&quot;*****************&quot;+table+&quot;表INSERT成功！****************&quot;);</div><div class="line">                    &#125;</div><div class="line">        &#125;</div><div class="line">                </div><div class="line">        //方法3-2:往table表record，插入一行content数据 【大量数据(文章，文本内容)】【,分隔字段 &amp;&amp;&amp;&amp;&amp; 分隔内容   ,分隔占位符】</div><div class="line">        public void insert(String table,String record,String content,String mark) throws SQLException, UnsupportedEncodingException&#123;//参数值: 表名,字段,内容，占位符(?)</div><div class="line">                    </div><div class="line">            </div><div class="line">                    String [] content_Arrays=content.split(&quot;&amp;&amp;&amp;&amp;&amp;&quot;);//分隔内容存入数组</div><div class="line">                    String [] mark_Arrays = mark.split(&quot;,&quot;);</div><div class="line">                    </div><div class="line">                    //判断是否存在相同记录，如果存在则不执行插入【以第一条record为准】</div><div class="line">                    String first_record=record.substring(0,record.indexOf(&quot;,&quot;));</div><div class="line">                    sql  =&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot; WHERE &quot;+first_record+&quot;=&apos;&quot;+content_Arrays[0]+&quot;&apos;;&quot;;</div><div class="line">                    rs=st.executeQuery(sql);</div><div class="line">                        </div><div class="line">                        if(rs.next())&#123;//光标移动</div><div class="line">                            //存在相同记录</div><div class="line">                            System.out.println(&quot;**********************很抱歉，&quot;+table+&quot;表已经存在&quot;+content_Arrays[0]+&quot;记录,INSERT失败,不进行重复插入！*************************8888&quot;);</div><div class="line">                        &#125;else&#123;</div><div class="line">                            //不存在相同记录</div><div class="line">                            System.out.println(&quot;**********************&quot;+table+&quot;表中不存在&quot;+content_Arrays[0]+&quot;记录,正在进行INSERT。。。。。。。。。。。。。&quot;);</div><div class="line">                            sql=&quot;INSERT INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+mark+&quot;);&quot;;</div><div class="line">                            </div><div class="line">                            pst=conn.prepareStatement(sql);</div><div class="line">                            </div><div class="line">                            for(int i=1;i&lt;=mark_Arrays.length;i++)&#123;//根据占位符个数【?的数量】进行循环: ?号个数            </div><div class="line">                                pst.setString(i,mark_Arrays[i-1]);</div><div class="line">                            &#125;</div><div class="line">                            </div><div class="line">                            pst.executeUpdate();</div><div class="line">                            System.out.println(&quot;*****************&quot;+table+&quot;表INSERT成功！****************&quot;);</div><div class="line">                        &#125;</div><div class="line">            &#125;</div><div class="line">                </div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">************************************c-3***********************************************************</div><div class="line">package Utils;</div><div class="line"></div><div class="line"></div><div class="line">/**更新时间:2016.11.26</div><div class="line"> *          操作字符串</div><div class="line"> *              方法1：转换</div><div class="line"> *              方法2：判断</div><div class="line"> *      @author Suvan</div><div class="line"> */</div><div class="line">public class UseString &#123;</div><div class="line">    </div><div class="line">    //方法1-1:将首字母变为大写</div><div class="line">        public String UpFirstString(String content)&#123; //参数: 内容</div><div class="line">            String firstLetter=content.substring(0,1);</div><div class="line">            content=content.replaceFirst(firstLetter,firstLetter.toUpperCase());//替换首字母</div><div class="line">            </div><div class="line">            return content;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法1-2:将首字母变为小写</div><div class="line">        public String LowFirstString(String content)&#123; //参数: 内容</div><div class="line">            String firstLetter=content.substring(0,1);</div><div class="line">            content=content.replaceFirst(firstLetter,firstLetter.toLowerCase());//替换首字母</div><div class="line">            </div><div class="line">            return content;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法:1-3:将字符串变为int类型</div><div class="line">        public int getInt(String content)&#123;</div><div class="line">            return Integer.parseInt(content);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-1：判断num编号属否在scope区间里面，返回布尔类型参数【true--属于，false--不属于】</div><div class="line">        public Boolean getMinMaxScope(String scope,int num)&#123;//参数：范围，编号</div><div class="line">            Boolean sign = false;//判断标识，默认为true</div><div class="line">            </div><div class="line">            String [] scope_arrays = scope.split(&quot;-&quot;);</div><div class="line">            int minScope =Integer.parseInt(scope_arrays[0]);</div><div class="line">            int maxScope =Integer.parseInt(scope_arrays[1]);</div><div class="line">            </div><div class="line">                if(minScope &lt;= num &amp;&amp; num &lt;= maxScope)&#123;</div><div class="line">                    sign =true;</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">            return sign;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p><br><br><br></p>
<h1 id="版本4-0【2016-12-13】"><a href="#版本4-0【2016-12-13】" class="headerlink" title="版本4.0【2016.12.13】"></a>版本4.0【2016.12.13】</h1><p>&emsp;耗时半天左右，突发奇想，优化+学习,最后勉强搞定，但是仍然有优化的空间</p>
<p>版本改动</p>
<ul>
<li>优化了代码,每个类都用工具类的属性,GoTask里创建对象的时候传参赋值,删除了CreateFile.java</li>
<li>兼容2种数据库【SQLite和MySQL】,SQLite嵌入到项目中,移植性高</li>
<li>MySQL需要自己新建数据库and表,SQLite运行即自动创建【不会重复创建or插入】</li>
<li>使用SQLite第一次创建会在项目相应目录下建库,建表，读取excel数据插入,会有点慢,二次运行快到飞起</li>
<li>添加了excel数据读取【目前是jxl,项目中也包含poi,可根据需求修改GeTableData.java的s_InsertExcel()方法】</li>
<li>可设置程序猿的编号范围匹配和地区匹配</li>
</ul>
<p><br></p>
<p>项目结构规划<br>BatchCreate_file<br>&emsp;extend.example<br>&emsp;&emsp;GetFirstLetter.java<br>&emsp;main<br>&emsp;&emsp;AlterContent.java<br>&emsp;&emsp;GetTableData.java<br>&emsp;&emsp;NumBean.java<br>&emsp;&emsp;GoTask.java【任务流程 GO()】<br>&emsp;&emsp;test.java【运行项目的测试方法】<br>&emsp;Utils<br>&emsp;&emsp;IOFile.java<br>&emsp;&emsp;UseDB.java<br>&emsp;&emsp;UseExcel.java【新增,用于excel文件的读写】<br>&emsp;&emsp;UseString.java</p>
<p><br><br><br></p>
<p>下面贴出主要改动的代码</p>
<h2 id="main包"><a href="#main包" class="headerlink" title="main包"></a>main包</h2><p>1.AlterContent.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div></pre></td><td class="code"><pre><div class="line">package main;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.HashMap;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseDB;</div><div class="line">import Utils.UseString;</div><div class="line"></div><div class="line">/**更新时间： 2016.12.13</div><div class="line"> * </div><div class="line"> *  获取模版内容，根据编号各个属性值，修改BackupTask.java和入库文件，创建文件</div><div class="line"> *          @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class AlterContent &#123;</div><div class="line">        </div><div class="line">        private IOFile iof;</div><div class="line">        private UseDB udb;</div><div class="line">        private UseString us;</div><div class="line">        private GetTableData gtd;</div><div class="line">        </div><div class="line">        //有参构造函数，创建对象时进行赋值</div><div class="line">        public AlterContent(IOFile iof,UseDB udb,UseString us,GetTableData gtd)&#123;  </div><div class="line">            this.iof=iof;</div><div class="line">            this.udb=udb;</div><div class="line">            this.us=us;</div><div class="line">            this.gtd=gtd;</div><div class="line">        &#125;</div><div class="line">    </div><div class="line"></div><div class="line">        //方法1:修改BackupTask.java,并创建</div><div class="line">        public  void aBackupTask(String path,String fileName,String content,String sign,ArrayList&lt;String&gt; rukuName_list) throws IOException&#123;//参数:路径，文件名，内容，标记【修改还是创建】,入库名,项目类           </div><div class="line">                </div><div class="line">             //1.修改模版内容</div><div class="line">            String BackupTask_model=&quot;\n\t\t&quot;+&quot;NameA=(NameB) ac.getBean(\&quot;fileName\&quot;);&quot; +</div><div class="line">                                                              &quot;\n\t\t&quot; +&quot;NameA.initNameB();&quot;;</div><div class="line">                String attributeName=&quot;&quot;;//属性名</div><div class="line">                String cStr =&quot;&quot;;</div><div class="line">                StringBuilder sb = new StringBuilder();//储存各个所有内容</div><div class="line">                for(int i=0;i&lt;rukuName_list.size();i++)&#123;</div><div class="line">                    attributeName =rukuName_list.get(i).substring(rukuName_list.get(i).lastIndexOf(&quot;_&quot;)+1);</div><div class="line">                    cStr=BackupTask_model.replace(&quot;NameA&quot;,us.LowFirstString(attributeName))</div><div class="line">                                                              .replace(&quot;NameB&quot;,us.UpFirstString(attributeName))</div><div class="line">                                                              .replace(&quot;fileName&quot;,rukuName_list.get(i));</div><div class="line">                    sb.append(cStr);</div><div class="line">                &#125;</div><div class="line">                sb.append(&quot;\n\t\t//ok;&quot;);//用于叠加补充</div><div class="line">                </div><div class="line">                //2.覆盖或者修改文件</div><div class="line">                if(&quot;cover&quot;.equals(sign))&#123;//覆盖 【与上一个编号完全不同(号码不同,且不带-)】</div><div class="line">                    content=content.replace(&quot;//changeModel;&quot;,sb.toString());</div><div class="line">                     iof.cFile(path, &quot;BackupTask.java&quot;, &quot;UTF-8&quot;, content);</div><div class="line">                &#125;else if(&quot;alter&quot;.equals(sign))&#123; //修改 【带-的编号,在上一个文件基础上进行叠加修改】</div><div class="line">                    content=content.replace(&quot;//ok;&quot;,sb.toString());</div><div class="line">                    iof.cFile(path, &quot;BackupTask.java&quot;, &quot;UTF-8&quot;, content);</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法2:修改入库文件</div><div class="line">        public void aRK(String path,String fileName,String content,String type,String username,NumBean numbean) throws IOException&#123;</div><div class="line">            </div><div class="line"></div><div class="line">                //一.根据类型生成相应名称</div><div class="line">                HashMap&lt;String,String&gt; hm = gtd.getTypeAllName(type);</div><div class="line"></div><div class="line">                </div><div class="line">                //二.根据需求修改content</div><div class="line">                        //A.判断信息类型</div><div class="line">                        String infType =numbean.getInftype();</div><div class="line">                        if(infType !=null  &amp;&amp; ! &quot;-0-&quot;.equals(infType))&#123;                                     //zbgg.setInfoType(&quot;服务&quot;);// 信息类型</div><div class="line">                            content=content.replaceFirst(&quot;//是否有信息类型;&quot;,&quot;zbgg.setInfoType(\&quot;&quot;+infType+&quot;\&quot;);//信息类型&quot;);</div><div class="line">                        &#125;else&#123;</div><div class="line">                            content=content.replaceFirst(&quot;//是否有信息类型;&quot;,&quot;//zbgg.setInfoType(\&quot;服务\&quot;);//信息类型&quot;);</div><div class="line">                        &#125;</div><div class="line">                    </div><div class="line">                        //B.判断行业分类</div><div class="line">                        String workType=numbean.getWorktype();</div><div class="line">                        if(workType==null &amp;&amp; ! &quot;-0-&quot;.equals(workType)) &#123;                                 //zbgg.setIndustry(&quot;建筑建材&quot;); // 行业分类</div><div class="line">                            content=content.replaceFirst(&quot;//是否有行业分类;&quot;,&quot;zbgg.setIndustry(\&quot;&quot;+workType+&quot;\&quot;); //行业分类&quot;);</div><div class="line">                        &#125;else&#123;</div><div class="line">                            content=content.replaceFirst(&quot;//是否有行业分类;&quot;,&quot;//zbgg.setIndustry(\&quot;建筑建材\&quot;); // 行业分类&quot;);</div><div class="line">                        &#125;</div><div class="line"></div><div class="line">                    </div><div class="line">                //三.修改模版</div><div class="line">                content=content.replace(&quot;zhaoBiaoGongGao&quot;,hm.get(&quot;typeSpell&quot;))</div><div class="line">                                                                             .replace(&quot;ZhaoBiaoGongGao&quot;,us.UpFirstString(hm.get(&quot;typeSpell&quot;)))</div><div class="line">                                                                             .replace(&quot;ZhaobGgService&quot;,us.UpFirstString(hm.get(&quot;typeService&quot;)))</div><div class="line">                                                                             .replace(&quot;zhaobGgService&quot;,hm.get(&quot;typeService&quot;))</div><div class="line">                                                                             .replace(&quot;zbgg&quot;,type);</div><div class="line">                content=content.replaceFirst(&quot;//@程序猿;&quot;,username)</div><div class="line">                                            .replaceFirst(&quot;//@内容;&quot;,numbean.getArea()+&quot;_&quot;+numbean.getProvince()+&quot;_&quot;+numbean.getCity()+&quot;_&quot;+numbean.getCounty()+&quot;_&quot;+hm.get(&quot;typeChinese&quot;)+&quot;_&quot;+numbean.getNum())                </div><div class="line">                                            .replaceFirst(&quot;//编号;&quot;,numbean.getNum());        </div><div class="line">                String className =fileName.substring(0,fileName.lastIndexOf(&quot;.&quot;));</div><div class="line">                content=content.replaceFirst(&quot;//注解;&quot;,className)</div><div class="line">                                            .replaceFirst(&quot;//类名;&quot;,className);</div><div class="line">                content=content.replaceFirst(&quot;//Area;&quot;,numbean.getArea())</div><div class="line">                                             .replaceFirst(&quot;//Province;&quot;,numbean.getProvince().replaceFirst(&quot;省&quot;,&quot;&quot;).replaceFirst(&quot;市&quot;,&quot;&quot;).replaceFirst(&quot;区&quot;,&quot;&quot;).replaceFirst(&quot;县&quot;,&quot;&quot;))</div><div class="line">                                            .replaceFirst(&quot;//Webname;&quot;,numbean.getWebname())</div><div class="line">                                            .replaceFirst(&quot;//Infsource;&quot;,numbean.getInfsource())</div><div class="line">                                            .replace(&quot;//表名;&quot;,hm.get(&quot;tableName&quot;));</div><div class="line">                </div><div class="line">                //仅有2个字符的时候保留，省,市，区</div><div class="line">                if(numbean.getCity().length()==2)&#123;</div><div class="line">                    content=content.replaceFirst(&quot;//City;&quot;,numbean.getCity());</div><div class="line">                &#125;else&#123;</div><div class="line">                    content=content.replaceFirst(&quot;//City;&quot;,numbean.getCity().replaceFirst(&quot;省&quot;,&quot;&quot;).replaceFirst(&quot;市&quot;,&quot;&quot;).replaceFirst(&quot;区&quot;,&quot;&quot;).replaceFirst(&quot;县&quot;,&quot;&quot;));</div><div class="line">                &#125;</div><div class="line">                </div><div class="line">                if(numbean.getCounty().length()==2)&#123;</div><div class="line">                    content=content.replaceFirst(&quot;//County;&quot;,numbean.getCounty());</div><div class="line">                &#125;else&#123;</div><div class="line">                    content=content.replaceFirst(&quot;//County;&quot;,numbean.getCounty().replaceFirst(&quot;省&quot;,&quot;&quot;).replaceFirst(&quot;市&quot;,&quot;&quot;).replaceFirst(&quot;区&quot;,&quot;&quot;).replaceFirst(&quot;县&quot;,&quot;&quot;));</div><div class="line">                &#125;</div><div class="line">                        </div><div class="line">                        </div><div class="line">                </div><div class="line">                            </div><div class="line">                //四.创建编号相应类型的入库文件</div><div class="line">                iof.cFile(path, fileName, &quot;UTF-8&quot;, content);</div><div class="line">        &#125;       </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p><br><br></p>
<h2 id="2-GetTableData-java"><a href="#2-GetTableData-java" class="headerlink" title="2.GetTableData.java"></a>2.GetTableData.java</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div></pre></td><td class="code"><pre><div class="line">package main;</div><div class="line"></div><div class="line">import java.io.File;</div><div class="line">import java.io.IOException;</div><div class="line">import java.sql.SQLException;</div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.HashMap;</div><div class="line">import java.util.regex.Matcher;</div><div class="line">import java.util.regex.Pattern;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseDB;</div><div class="line">import jxl.Cell;</div><div class="line">import jxl.Sheet;</div><div class="line">import jxl.Workbook;</div><div class="line">import jxl.read.biff.BiffException;</div><div class="line"></div><div class="line">/**更新时间： 2016.12.13</div><div class="line"> * </div><div class="line"> *  获取数据，处理数据，归纳信息</div><div class="line"> *          @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class GetTableData &#123;</div><div class="line"></div><div class="line">    private IOFile iof;</div><div class="line">    private UseDB udb;</div><div class="line">    </div><div class="line">    //有参构造函数，创建对象时进行赋值</div><div class="line">    public GetTableData(IOFile iof,UseDB udb)&#123;</div><div class="line">        this.iof=iof;</div><div class="line">        this.udb=udb;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法1: 插入模版数据,并返回模版内容</div><div class="line">        public String getModel(String filePath) throws IOException,SQLException&#123;//参数：文件路径</div><div class="line">            </div><div class="line">            //1.读取文件内容                                                                                                      </div><div class="line">            String fileContent=iof.readFileContent_String(filePath,&quot;GBK&quot;);   //注意：路径的话用/或者\\都可以,数据库的默认编码是GBK</div><div class="line">            String modeName=filePath.substring(filePath.indexOf(&quot;/&quot;)+1);            //模版名字</div><div class="line"></div><div class="line">            //2.判断是否存在相同模版</div><div class="line">            String modeInf = udb.select(&quot;article&quot;, &quot;model&quot;, &quot;model=&apos;&quot;+modeName+&quot;&apos;&quot;);</div><div class="line"></div><div class="line">            if(modeInf.length() &lt;1)&#123;    //判断是否已存在模版</div><div class="line">                udb.insert(&quot;article&quot;,&quot;model,detail&quot;,&quot;&apos;&quot;+modeName+&quot;&apos;,&apos;&quot;+fileContent.replace(&quot;&apos;&quot;, &quot;&apos;&apos;&quot;)+&quot;&apos;&quot;); </div><div class="line">            &#125;else&#123;</div><div class="line">                System.out.println(&quot;\n********************************已存在&quot;+modeInf+&quot;模版，不进行重复插入****************************&quot;);</div><div class="line">            &#125;</div><div class="line">        </div><div class="line">            return fileContent;</div><div class="line">        &#125;</div><div class="line">    </div><div class="line">    //方法2：获取table表中，num编号的所有信息,储存进NumBean，返回NumBean</div><div class="line">    public  NumBean getNumInformation(String table,String num) throws SQLException&#123;//参数：表名,编号</div><div class="line"></div><div class="line">            //查询table表，num字段所有数据，用&amp;分隔</div><div class="line">            String numInf = udb.select(table, &quot;num&quot;, &quot;num=&apos;&quot;+num+&quot;&apos;&quot;, &apos;*&apos;);</div><div class="line">            String [] numInf_arrays=numInf.split(&quot;&amp;&quot;);</div><div class="line">            </div><div class="line">            //表共21列，Numbean共21个属性，拥有Getters和Setters</div><div class="line">            NumBean nb = new NumBean();</div><div class="line">                nb.setNum(numInf_arrays[0]);</div><div class="line">                nb.setArea(numInf_arrays[1]);</div><div class="line">                nb.setProvince(numInf_arrays[2]);</div><div class="line">                nb.setCity(numInf_arrays[3]);</div><div class="line">                nb.setCounty(numInf_arrays[4]);</div><div class="line">                nb.setWebname(numInf_arrays[5]);</div><div class="line">                nb.setWeburl(numInf_arrays[6]);</div><div class="line">                nb.setInfsource(numInf_arrays[7]);</div><div class="line">                nb.setInftype(numInf_arrays[8]);</div><div class="line">                nb.setWorktype(numInf_arrays[9]);</div><div class="line">                nb.setZbyg(numInf_arrays[10]);</div><div class="line">                nb.setZbgg(numInf_arrays[11]);</div><div class="line">                nb.setZsjg(numInf_arrays[12]);</div><div class="line">                nb.setGgbg(numInf_arrays[13]);</div><div class="line">                nb.setZbwj(numInf_arrays[14]);</div><div class="line">                nb.setZbdy(numInf_arrays[15]);</div><div class="line">                nb.setZbxx(numInf_arrays[16]);</div><div class="line">                nb.setKzj(numInf_arrays[17]);</div><div class="line">                nb.setLot(numInf_arrays[18]);</div><div class="line">                nb.setWebtype(numInf_arrays[19]);</div><div class="line">                nb.setRemark(numInf_arrays[20]);</div><div class="line">        </div><div class="line">        return nb;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法3：获取table表的，所有编号</div><div class="line">    public ArrayList&lt;String&gt; getAllNum(String table) throws SQLException&#123; //参数: 表名</div><div class="line">            ArrayList&lt;String&gt; numList = new  ArrayList&lt;String&gt;();</div><div class="line">            </div><div class="line">            String allNum =udb.selectAllColumn(table,&quot;num&quot;);</div><div class="line">            String [] allNum_arrays = allNum.split(&quot;##&quot;);</div><div class="line">            for(int i=0;i&lt;allNum_arrays.length;i++)&#123;</div><div class="line">                numList.add(allNum_arrays[i]);</div><div class="line">            &#125;</div><div class="line">            return numList;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法4:判断num编号属否在scope区间里面，返回布尔类型参数【true-属于，false-不属于】</div><div class="line">    public Boolean getMinMaxScope(String scope,int num)&#123;//参数：范围，编号</div><div class="line">            Boolean sign = false;//判断标识，默认为true</div><div class="line">            </div><div class="line">            String [] scope_arrays = scope.split(&quot;-&quot;);</div><div class="line">            int minScope =Integer.parseInt(scope_arrays[0]);</div><div class="line">            int maxScope =Integer.parseInt(scope_arrays[1]);</div><div class="line">            </div><div class="line">                if(minScope &lt;= num &amp;&amp; num &lt;= maxScope)&#123;</div><div class="line">                    sign =true;</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">            return sign;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法5:获取当前编号拥有URL的字段名【类型】</div><div class="line">    public ArrayList&lt;String&gt; getNum_HaveURLRecord(String table,String num) throws SQLException&#123; //参数：表名，编号</div><div class="line"></div><div class="line">        //查询数据库table表，num字段的11-18行，得到拥有记录的列名的ArrayList</div><div class="line">        ArrayList&lt;String&gt; alist=udb.selectAskinformation_Scope(table,&quot;num=&apos;&quot;+num+&quot;&apos;&quot;, &quot;11-18&quot;);//【11-18是招标预告到控制价】</div><div class="line"></div><div class="line">        return alist;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    //方法6：根据列名，得到相应类型的字符串</div><div class="line">    public String getTypename(String columnName)&#123; //参数：列名</div><div class="line">                String type=&quot;&quot;;</div><div class="line"></div><div class="line">                if(columnName.equals(&quot;zbyg&quot;))&#123;</div><div class="line">                    type=&quot;ZhaobYgService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zbgg&quot;))&#123;</div><div class="line">                    type=&quot;ZhaobGgService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zsjg&quot;))&#123;</div><div class="line">                    type=&quot;ZisJgService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;ggbg&quot;))&#123;</div><div class="line">                    type=&quot;GonggBgService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zbwj&quot;))&#123;</div><div class="line">                    type=&quot;ZhaobWjService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zbdy&quot;))&#123;</div><div class="line">                    type=&quot;ZhaobDyService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zbxx&quot;))&#123;</div><div class="line">                    type=&quot;ZhongbXxService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;kzj&quot;))&#123;</div><div class="line">                    type=&quot;KongZjService&quot;;</div><div class="line">                &#125;</div><div class="line">        </div><div class="line">        return type;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line"></div><div class="line">    </div><div class="line">    //方法7：根据类型生成相应名称，返回HaspMap【无序键值队】</div><div class="line">    public HashMap&lt;String,String&gt; getTypeAllName(String type)&#123;  //参数：类型名，也是列名</div><div class="line">        HashMap&lt;String,String&gt; hm = new HashMap&lt;String,String&gt;();</div><div class="line"></div><div class="line">                if(type.equals(&quot;zbyg&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;zhaoBiaoYuGao&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhaobYgService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;招标预告&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhao_biao_yu_gao&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zbgg&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;zhaoBiaoGongGao&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhaobGgService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;招标公告&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhao_biao_gong_gao&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zsjg&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;ziShenJieGuo&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zisJgService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;咨审结果&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zi_shen_jie_guo&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;ggbg&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;gongGaoBianGeng&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;gonggBgService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;公告变更&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_gong_gao_bian_geng&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zbwj&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;zhaoBiaoWenJian&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhaobWjService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;招标文件&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhao_biao_wen_jian&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zbdy&quot;))&#123;</div><div class="line">                    hm.put(&quot;typeSpell&quot;, &quot;ZhaoBiaoDaYi&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhaobDyService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;招标答疑&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhao_biao_da_yi&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zbxx&quot;))&#123;</div><div class="line">                    hm.put(&quot;typeSpell&quot;, &quot;zhongBiaoXinXi&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhongbXxService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;中标信息&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhong_biao_xin_xi&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;kzj&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;kongZhiJia&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;kongZjService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;控制价&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_kong_zhi_jia&quot;);</div><div class="line">                &#125;               </div><div class="line">        </div><div class="line">        return hm;      </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">//************************************************************************************************************************</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法SQLite-1：创建表结构</div><div class="line">    public void s_CreateTable(String useTable) throws SQLException&#123;</div><div class="line">        </div><div class="line">         //创建模版表</div><div class="line">        String sql1= &quot;CREATE TABLE if not exists article(&quot;  +            </div><div class="line">                                &quot;id  INCREMENT primary key,&quot; +</div><div class="line">                                &quot;model TEXT NOT NULL,&quot;              +</div><div class="line">                                &quot; detail TEXT NOT NULL&quot;     +</div><div class="line">                                &quot;);&quot; ;</div><div class="line">        //获取Excel数据表</div><div class="line">        String sql2=&quot;CREATE TABLE if not exists &quot;+useTable+&quot;(&quot; +</div><div class="line">                             &quot;num TEXT primary key,&quot; +</div><div class="line">                             &quot;area TEXT NOT NULL,&quot; +</div><div class="line">                             &quot;province TEXT,&quot; +</div><div class="line">                             &quot;city TEXT,&quot; +</div><div class="line">                             &quot;county TEXT,&quot; +</div><div class="line">                             &quot;webname TEXT,&quot; +</div><div class="line">                             &quot;weburl  TEXT,&quot; +</div><div class="line">                             &quot;infsource TEXT,&quot; +</div><div class="line">                             &quot;inftype   TEXT,&quot; +</div><div class="line">                             &quot;worktype TEXT,&quot; +</div><div class="line">                             &quot;zbyg  TEXT,&quot; +</div><div class="line">                             &quot;zbgg    TEXT,&quot; +</div><div class="line">                             &quot;zsjg  TEXT,&quot; +</div><div class="line">                             &quot;ggbg TEXT,&quot; +</div><div class="line">                             &quot;zbwj TEXT,&quot; +</div><div class="line">                             &quot;zbdy TEXT,&quot; +</div><div class="line">                             &quot;zbxx TEXT,&quot; +</div><div class="line">                             &quot;kzj TEXT,&quot; +</div><div class="line">                             &quot;lot TEXT,&quot; +</div><div class="line">                             &quot;webtype TEXT,&quot; +</div><div class="line">                             &quot;remark TEXT&quot;  +</div><div class="line">                             &quot;  )&quot;;</div><div class="line">        </div><div class="line">          udb.createSQL(sql1); </div><div class="line">          udb.createSQL(sql2); </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法SQLite-2.读取Excel表的数据，插入SQLite</div><div class="line">    public void s_InsertExcel(String useExcel,String useTable) throws IOException,BiffException,SQLException&#123;//参数：Excel文件名,表名</div><div class="line">        </div><div class="line">            File xlsFile = new File(&quot;Excel/&quot;+useExcel);</div><div class="line">            //2.获得工作薄对象</div><div class="line">            Workbook workbook = Workbook.getWorkbook(xlsFile);</div><div class="line">            </div><div class="line">            //3.获得所有工作表</div><div class="line">            Sheet [] sheets = workbook.getSheets();</div><div class="line">            if(sheets.length&gt;0)&#123;</div><div class="line">                System.out.println(&quot;将Excel数据插入SQLite数据库---------------------------&gt;&quot;);</div><div class="line">                Sheet sheet = sheets[0];    //第1个工作表</div><div class="line">                int rows = sheet.getRows(); //总行数</div><div class="line">//              int cols = sheet.getRows(); //总列数</div><div class="line">                </div><div class="line">                </div><div class="line">                </div><div class="line">                for(int row=0;row&lt;rows;row++)&#123;  </div><div class="line">                    Cell    [] cells =sheet.getRow(row);</div><div class="line">                    </div><div class="line">                    //正则判断n行的第1列的数据是否是编号【开头是否为数字】，不是则跳过</div><div class="line">                    Pattern p = Pattern.compile(&quot;\\d+&quot;);</div><div class="line">                    Matcher m = p.matcher(cells[0].getContents());</div><div class="line">                    if(m.find())&#123;</div><div class="line">                        System.out.print(row+&quot;行......&quot;);</div><div class="line">                        if(row %50 ==0) System.out.println();   //若50条记录换行一次</div><div class="line">                        udb.insert(useTable,</div><div class="line">                                    &quot;&apos;&quot;+cells[0].getContents()+&quot;&apos;,&apos;&quot;+cells[1].getContents()+&quot;&apos;,&apos;&quot;+cells[2].getContents()+&quot;&apos;,&apos;&quot;+cells[3].getContents()+&quot;&apos;,&apos;&quot;+cells[4].getContents()+&quot;&apos;,&apos;&quot;</div><div class="line">                                        +cells[5].getContents()+&quot;&apos;,&apos;&quot;+cells[6].getContents()+&quot;&apos;,&apos;&quot;+cells[7].getContents()+&quot;&apos;,&apos;&quot;+cells[8].getContents()+&quot;&apos;,&apos;&quot;+cells[9].getContents()+&quot;&apos;,&apos;&quot;</div><div class="line">                                        +cells[10].getContents()+&quot;&apos;,&apos;&quot;+cells[11].getContents()+&quot;&apos;,&apos;&quot;+cells[12].getContents()+&quot;&apos;,&apos;&quot;+cells[13].getContents()+&quot;&apos;,&apos;&quot;+cells[14].getContents()+&quot;&apos;,&apos;&quot;</div><div class="line">                                        +cells[15].getContents()+&quot;&apos;,&apos;&quot;+cells[16].getContents()+&quot;&apos;,&apos;&quot;+cells[17].getContents()+&quot;&apos;,&apos;&quot;+cells[18].getContents()+&quot;&apos;,&apos;&quot;+cells[19].getContents()+&quot;&apos;,&apos;&quot;+cells[20].getContents()+&quot;&apos;&quot;);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p><br><br></p>
<p>3.GoTask.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div></pre></td><td class="code"><pre><div class="line">package main;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseDB;</div><div class="line">import Utils.UseString;</div><div class="line">import extend.example.GetFirstLetter;</div><div class="line"></div><div class="line"></div><div class="line">/**更新时间：2016.12.13</div><div class="line"> *      </div><div class="line"> * 任务流程</div><div class="line"> *           @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class GoTask &#123;</div><div class="line">    </div><div class="line">    </div><div class="line"></div><div class="line">//  private String numScope=&quot;00000-05000&quot;;                                                  //编号范围区间</div><div class="line">//  private String username=&quot;某男子&quot;;                                                                  //程序员名称</div><div class="line">    private String path=&quot;C:/Users/Liu-shuwei/Desktop\\&quot;;                                             //路径</div><div class="line">    private String catalogName=&quot;入库【3.3版,823表(区分程序猿and地区)】&quot;;             //文件名</div><div class="line">    private Boolean areaMatch=false;                                                                    //是否开启区域匹配【默认不开启】</div><div class="line">    private Boolean numMatch=false;                                                                 //是否开启默认匹配【默认不开启】</div><div class="line">    private String useExcel;                                                                                    //使用项目根目录下哪个Excel</div><div class="line">    private String useTable;                                                                                    //使用哪个表的数据【SQLite的话，不存在表则自动创建】</div><div class="line">    </div><div class="line">    public void setPath(String path)&#123;</div><div class="line">        this.path=path;</div><div class="line">    &#125;</div><div class="line">    public void setCatalogName(String cn)&#123;</div><div class="line">        this.catalogName=cn;</div><div class="line">    &#125;</div><div class="line">    public void setAreaMatch(Boolean b)&#123;</div><div class="line">        this.areaMatch=b;</div><div class="line">    &#125;</div><div class="line">    public void setNumMatch(Boolean b)&#123;</div><div class="line">        this.numMatch=b;</div><div class="line">    &#125;</div><div class="line">    public void setUseExcel(String excel)&#123;</div><div class="line">        this.useExcel=excel;</div><div class="line">    &#125;</div><div class="line">    public void setUseTable(String table)&#123;</div><div class="line">        this.useTable=table;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //任务1： 使用MySQL数据库</div><div class="line">    public void GO(String username,String numScope,String numArea) &#123;    //参数:程序猿，编号范围，地区</div><div class="line">            System.out.println(username+&quot;--------------------------------------------------&gt;Go!&quot;);</div><div class="line">        </div><div class="line">        //执行任务流程</div><div class="line">        try&#123;</div><div class="line">            </div><div class="line">            //一.获取对象</div><div class="line">            UseDB udb = new UseDB(&quot;mysql&quot;);</div><div class="line">            IOFile iof=new IOFile();</div><div class="line">            UseString us = new UseString();</div><div class="line">            </div><div class="line">            GetFirstLetter gfl = new GetFirstLetter();</div><div class="line"></div><div class="line">            GetTableData  gtd = new GetTableData(iof,udb);</div><div class="line">            AlterContent ac = new AlterContent(iof,udb,us,gtd);</div><div class="line">            </div><div class="line">            </div><div class="line">            udb.connDatabase(&quot;batchcreate_file&quot;);//连接数据库</div><div class="line">            </div><div class="line">            </div><div class="line">            //二.创建大目录,往数据库插入模版数据</div><div class="line">            iof.createCatalog(path, catalogName);</div><div class="line">            iof.createCatalog(path+&quot;/&quot;+catalogName, username);</div><div class="line">            String model1_BT =gtd.getModel(&quot;model_file/BackupTask.java&quot;);</div><div class="line">            String model2_RK =gtd.getModel(&quot;model_file/ZhaobGgServiceModel.java&quot;);</div><div class="line">            </div><div class="line">            </div><div class="line">            </div><div class="line">            //三.获取数据表数据，并生成目录and文件</div><div class="line">                //三-1获取所有编号</div><div class="line">                ArrayList&lt;String&gt; numList =gtd.getAllNum(useTable) ; </div><div class="line">                </div><div class="line">                </div><div class="line">                //三-2.遍历所有编号</div><div class="line">                for(int i=0;i&lt;numList.size();i++)&#123;</div><div class="line">                </div><div class="line">                    String num=numList.get(i);                                                      //当前编号</div><div class="line">                    String num_=numList.get(i) .replace(&quot;-&quot;,&quot;_&quot;);                           //编号下划线形态</div><div class="line">                    StringBuilder changePath =new StringBuilder(&quot;&quot;);                                            //变化路径</div><div class="line">                    </div><div class="line">                    //P1:判断是否开启编号范围匹配 and 比较当前编号是否在范围区间</div><div class="line">                    if( numMatch &amp;&amp; !gtd.getMinMaxScope(numScope, us.getInt(num.substring(0,5))))&#123;  //获取前5个数字</div><div class="line">                        continue;</div><div class="line">                    &#125;</div><div class="line">                    //P2:判断是否开启地区匹配 and 进行地区匹配</div><div class="line">                        if(areaMatch)&#123;</div><div class="line">                            String area =udb.select(useTable,&quot;area&quot;,&quot;num=&apos;&quot;+num+&quot;&apos;&quot;);</div><div class="line">                            if(!area.equals(numArea))&#123;</div><div class="line">                                continue;</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                    </div><div class="line">                        </div><div class="line">                        //a.获取当前编号的所有数据，并储存到JavaBean</div><div class="line">                        NumBean numBean =gtd.getNumInformation(useTable, num);</div><div class="line">                        </div><div class="line">                        //b.生成入库文件名，存储进ArrayList</div><div class="line">                         ArrayList&lt;String&gt; ifURLType_list =gtd.getNum_HaveURLRecord(useTable, num);             //获取当前编号所有&quot;含有URL&quot;的字段的类型【例:招标公告 zbgg】</div><div class="line">                         ArrayList&lt;String &gt; rukuName_list=new ArrayList&lt;String&gt;();                                                      //用于储存当前编号所需要的所有入库文件名</div><div class="line">                         StringBuilder rukuName=new StringBuilder(&quot;&quot;);</div><div class="line">                         for(String type:ifURLType_list)&#123;</div><div class="line">                             rukuName.append(gfl.getFirstLetter(numBean.getArea()).toUpperCase()+&quot;_&quot;+num_+&quot;_&quot;+gtd.getTypename(type));   //入库文件完整名【地区首字母(大写)_编号_类型服务名】</div><div class="line">                             rukuName_list.add(rukuName.toString());</div><div class="line">                             rukuName=rukuName.delete(0, rukuName.length());                                                                                //清空</div><div class="line">                         &#125;</div><div class="line">                         </div><div class="line">                        </div><div class="line">                        //d.生成入库子目录</div><div class="line">                        String catalog_1=&quot;入库-&quot;+num.substring(0,5);                                                                  //目录名</div><div class="line">                        changePath.insert(0,path+&quot;/&quot;+catalogName+&quot;/&quot;+username);                                     //子路径1                </div><div class="line">                        iof.createCatalog(changePath.toString(),&quot;入库-&quot;+num.substring(0,5));                          //创建入库子目录【入库-编号】</div><div class="line">                        </div><div class="line">                        </div><div class="line">                        //生成BackupTask.java</div><div class="line">                         changePath.append(&quot;/&quot;+catalog_1);                               //子路径1-2</div><div class="line">                         String sign = &quot;cover&quot;;                                                          //判断当前编号是需要修改还是覆盖【默认是覆盖，带-编号是alter,不带-是cover】</div><div class="line">                            if(i &gt; 0)&#123;                                                                           //大于0的时候进行判断   【顶部位置没有上一个编号】</div><div class="line">                                if(us.getInt(numList.get(i-1).substring(0,5)) == us.getInt(num.substring(0,5)))&#123;            </div><div class="line">                                    sign=&quot;alter&quot;;                                                            //如果和上个编号相等，则修改</div><div class="line">                                &#125;</div><div class="line">                            &#125;</div><div class="line">                            </div><div class="line">                         if(&quot;cover&quot;.equals(sign))&#123;                      //覆盖</div><div class="line">                                    ac.aBackupTask(changePath.toString(),&quot;BackupTask.java&quot;, model1_BT,sign,rukuName_list);</div><div class="line">                         &#125;else if(&quot;alter&quot;.equals(sign))&#123;                //修改</div><div class="line">                             String ageBackupTask=iof.readFileContent_String(changePath+&quot;/BackupTask.java&quot;,&quot;GBK&quot;);                  //读取已经已经存在的BackupTask.java</div><div class="line">                             ac.aBackupTask(changePath.toString(),&quot;BackupTask.java&quot;,ageBackupTask ,sign,rukuName_list);</div><div class="line">                         &#125;</div><div class="line">                         </div><div class="line">                        </div><div class="line">                        //e.生成入库文件</div><div class="line">                        iof.createCatalog(changePath.toString(),&quot;imp&quot;);          //生成imp目录</div><div class="line">                        changePath.append(&quot;/imp&quot;);                                       //子路径1-2-3</div><div class="line">                        for(int k=0;k&lt;ifURLType_list.size();k++)&#123;                    //根据拥有URL的类型，循环生成入库文件</div><div class="line">                            ac.aRK(changePath.toString(), rukuName_list.get(k)+&quot;.java&quot;, model2_RK,ifURLType_list.get(k),username,numBean);</div><div class="line">                        &#125;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            //四.关闭资源</div><div class="line">            udb.closeAll();</div><div class="line">            </div><div class="line">        &#125;catch(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">//***********************************************************************************************************************************</div><div class="line">    </div><div class="line">    </div><div class="line">    //任务2： 使用SQLite</div><div class="line">        public void GO_SQLite(String username,String numScope,String numArea) &#123; //参数:程序猿，编号范围，地区</div><div class="line">            System.out.println(username+&quot;--------------------------------------------------&gt;Go!&quot;);</div><div class="line">        </div><div class="line">        //执行任务流程</div><div class="line">        try&#123;</div><div class="line">            </div><div class="line">            //一.获取对象</div><div class="line">            UseDB udb = new UseDB(&quot;SQLite&quot;);</div><div class="line">            IOFile iof=new IOFile();</div><div class="line">            UseString us = new UseString();</div><div class="line">            </div><div class="line">            GetFirstLetter gfl = new GetFirstLetter();</div><div class="line"></div><div class="line">            GetTableData  gtd = new GetTableData(iof,udb);</div><div class="line">            AlterContent ac = new AlterContent(iof,udb,us,gtd);</div><div class="line">            </div><div class="line">            </div><div class="line">            udb.connDatabase(&quot;batchcreate_file.db&quot;);                        //连接数据库【若不存在则创建】</div><div class="line">            gtd.s_CreateTable(useTable);                                            //创建表【article-保存模版,(useTable)-Excel工作薄数据】</div><div class="line">            gtd.s_InsertExcel(useExcel,useTable);                                //插入Excel数据,【传入excel文件名和使用表名】</div><div class="line">            </div><div class="line">            //二.创建大目录,往数据库插入模版数据</div><div class="line">            iof.createCatalog(path, catalogName);</div><div class="line">            iof.createCatalog(path+&quot;/&quot;+catalogName, username);</div><div class="line">            String model1_BT =gtd.getModel(&quot;model_file/BackupTask.java&quot;);</div><div class="line">            String model2_RK =gtd.getModel(&quot;model_file/ZhaobGgServiceModel.java&quot;);</div><div class="line">            </div><div class="line">            </div><div class="line">            </div><div class="line">            //三.获取数据表数据，并生成目录and文件</div><div class="line">                //三-1获取所有编号</div><div class="line">                ArrayList&lt;String&gt; numList =gtd.getAllNum(useTable) ; </div><div class="line">                </div><div class="line">                </div><div class="line">                //三-2.遍历所有编号</div><div class="line">                for(int i=0;i&lt;numList.size();i++)&#123;</div><div class="line">                </div><div class="line">                    String num=numList.get(i);                                                      //当前编号</div><div class="line">                    String num_=numList.get(i) .replace(&quot;-&quot;,&quot;_&quot;);                           //编号下划线形态</div><div class="line">                    StringBuilder changePath =new StringBuilder(&quot;&quot;);                                            //变化路径</div><div class="line">                    </div><div class="line">                    //P1:判断是否开启编号范围匹配 and 比较当前编号是否在范围区间</div><div class="line">                    if( numMatch &amp;&amp; !gtd.getMinMaxScope(numScope, us.getInt(num.substring(0,5))))&#123;  //获取前5个数字</div><div class="line">                        continue;</div><div class="line">                    &#125;</div><div class="line">                    //P2:判断是否开启地区匹配 and 进行地区匹配</div><div class="line">                        if(areaMatch)&#123;</div><div class="line">                            String area =udb.select(useTable,&quot;area&quot;,&quot;num=&apos;&quot;+num+&quot;&apos;&quot;);</div><div class="line">                            if(!area.equals(numArea))&#123;</div><div class="line">                                continue;</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                    </div><div class="line">                        </div><div class="line">                        //a.获取当前编号的所有数据，并储存到JavaBean</div><div class="line">                        NumBean numBean =gtd.getNumInformation(useTable, num);</div><div class="line">                        </div><div class="line">                        //b.生成入库文件名，存储进ArrayList</div><div class="line">                         ArrayList&lt;String&gt; ifURLType_list =gtd.getNum_HaveURLRecord(useTable, num);             //获取当前编号所有&quot;含有URL&quot;的字段的类型【例:招标公告 zbgg】</div><div class="line">                         ArrayList&lt;String &gt; rukuName_list=new ArrayList&lt;String&gt;();                                                      //用于储存当前编号所需要的所有入库文件名</div><div class="line">                         StringBuilder rukuName=new StringBuilder(&quot;&quot;);</div><div class="line">                         for(String type:ifURLType_list)&#123;</div><div class="line">                             rukuName.append(gfl.getFirstLetter(numBean.getArea()).toUpperCase()+&quot;_&quot;+num_+&quot;_&quot;+gtd.getTypename(type));   //入库文件完整名【地区首字母(大写)_编号_类型服务名】</div><div class="line">                             rukuName_list.add(rukuName.toString());</div><div class="line">                             rukuName=rukuName.delete(0, rukuName.length());                                                                                //清空</div><div class="line">                         &#125;</div><div class="line">                         </div><div class="line">                        </div><div class="line">                        //d.生成入库子目录</div><div class="line">                        String catalog_1=&quot;入库-&quot;+num.substring(0,5);                                                                  //目录名</div><div class="line">                        changePath.insert(0,path+&quot;/&quot;+catalogName+&quot;/&quot;+username);                                     //子路径1                </div><div class="line">                        iof.createCatalog(changePath.toString(),&quot;入库-&quot;+num.substring(0,5));                          //创建入库子目录【入库-编号】</div><div class="line">                        </div><div class="line">                        </div><div class="line">                        //生成BackupTask.java</div><div class="line">                         changePath.append(&quot;/&quot;+catalog_1);                               //子路径1-2</div><div class="line">                         String sign = &quot;cover&quot;;                                                          //判断当前编号是需要修改还是覆盖【默认是覆盖，带-编号是alter,不带-是cover】</div><div class="line">                            if(i &gt; 0)&#123;                                                                           //大于0的时候进行判断   【顶部位置没有上一个编号】</div><div class="line">                                if(us.getInt(numList.get(i-1).substring(0,5)) == us.getInt(num.substring(0,5)))&#123;            </div><div class="line">                                    sign=&quot;alter&quot;;                                                            //如果和上个编号相等，则修改</div><div class="line">                                &#125;</div><div class="line">                            &#125;</div><div class="line">                            </div><div class="line">                         if(&quot;cover&quot;.equals(sign))&#123;                      //覆盖</div><div class="line">                                    ac.aBackupTask(changePath.toString(),&quot;BackupTask.java&quot;, model1_BT,sign,rukuName_list);</div><div class="line">                         &#125;else if(&quot;alter&quot;.equals(sign))&#123;                //修改</div><div class="line">                             String ageBackupTask=iof.readFileContent_String(changePath+&quot;/BackupTask.java&quot;,&quot;GBK&quot;);                  //读取已经已经存在的BackupTask.java</div><div class="line">                             ac.aBackupTask(changePath.toString(),&quot;BackupTask.java&quot;,ageBackupTask ,sign,rukuName_list);</div><div class="line">                         &#125;</div><div class="line">                         </div><div class="line">                        </div><div class="line">                        //e.生成入库文件</div><div class="line">                        iof.createCatalog(changePath.toString(),&quot;imp&quot;);          //生成imp目录</div><div class="line">                        changePath.append(&quot;/imp&quot;);                                       //子路径1-2-3</div><div class="line">                        for(int k=0;k&lt;ifURLType_list.size();k++)&#123;                    //根据拥有URL的类型，循环生成入库文件</div><div class="line">                            ac.aRK(changePath.toString(), rukuName_list.get(k)+&quot;.java&quot;, model2_RK,ifURLType_list.get(k),username,numBean);</div><div class="line">                        &#125;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            //四.关闭资源</div><div class="line">            udb.closeAll();</div><div class="line">            </div><div class="line">        &#125;catch(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p><br><br></p>
<p>4.test.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">package main;</div><div class="line"></div><div class="line">public class test &#123;</div><div class="line">    </div><div class="line"></div><div class="line">    //测试主方法</div><div class="line">    public static void main(String [] args)&#123;</div><div class="line">        long begin=System.currentTimeMillis();</div><div class="line">        </div><div class="line">        //创建任务流程对象</div><div class="line">        GoTask gt= new GoTask();</div><div class="line">            gt.setPath(&quot;C:/Users/Liu-shuwei/Desktop\\&quot;);</div><div class="line">            gt.setCatalogName(&quot;入库【4.0版,823表(完全版-未筛选)】&quot;);</div><div class="line">            gt.setNumMatch(false);      //是否开启编号范围匹配</div><div class="line">            gt.setAreaMatch(false);     //是否开启地区匹配</div><div class="line">        </div><div class="line">        //方式1：使用本地MySQL******************************************************************************************</div><div class="line">        //执行流程(参数:程序猿,编号范围,地区)</div><div class="line">        gt.setUseTable(&quot;webapi3&quot;);  </div><div class="line">        gt.GO(&quot;陈宇&quot;,&quot;02065-02145&quot;,&quot;华中&quot;);</div><div class="line">        gt.GO(&quot;刘聪&quot;,&quot;02396-02461&quot;,&quot;华北&quot;);</div><div class="line">        gt.GO(&quot;房文迪&quot;,&quot;01311-02769&quot;,&quot;华东&quot;);</div><div class="line">//      gt.GO(&quot;林佳法&quot;,&quot;02311-02371&quot;,);</div><div class="line">        gt.GO(&quot;严加远&quot;,&quot;02770-02781&quot;,&quot;华东&quot;);</div><div class="line">        gt.GO(&quot;吴健俊&quot;,&quot;01281-01596&quot;,&quot;西南&quot;);</div><div class="line">        gt.GO(&quot;周盛&quot;,&quot;01597-03456&quot;,&quot;西南&quot;);</div><div class="line">        gt.GO(&quot;占文冲&quot;,&quot;01552-03100&quot;,&quot;西北&quot;);</div><div class="line"></div><div class="line"></div><div class="line">        //方式2：使用SQLite******************************************************************************************************************************</div><div class="line">//      gt.setUseTable(&quot;api&quot;);          //使用表名【SQLite的若不存在会自动创建】</div><div class="line">//      gt.setUseExcel(&quot;8.23.xls&quot;);             //使用哪个Excel【项目根目录/Excel/】</div><div class="line">//      gt.GO_SQLite(&quot;陈宇&quot;,&quot;02065-02145&quot;,&quot;华中&quot;);</div><div class="line">//      gt.GO_SQLite(&quot;刘聪&quot;,&quot;02396-02461&quot;,&quot;华北&quot;);</div><div class="line">//      gt.GO_SQLite(&quot;房文迪&quot;,&quot;01311-02769&quot;,&quot;华东&quot;);</div><div class="line">//      gt.GO_SQLite(&quot;严加远&quot;,&quot;02770-02781&quot;,&quot;华东&quot;);</div><div class="line">//      gt.GO_SQLite(&quot;吴健俊&quot;,&quot;01281-01596&quot;,&quot;西南&quot;);</div><div class="line">//      gt.GO_SQLite(&quot;周盛&quot;,&quot;01597-03456&quot;,&quot;西南&quot;);</div><div class="line">//      gt.GO_SQLite(&quot;占文冲&quot;,&quot;01552-03100&quot;,&quot;西北&quot;);</div><div class="line">        </div><div class="line">        </div><div class="line">        System.out.println(&quot;共花费:&quot;+(double)(System.currentTimeMillis()-begin)/1000+&quot;秒&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p><br><br></p>
<h2 id="Utils包"><a href="#Utils包" class="headerlink" title="Utils包"></a>Utils包</h2><p>1.UseDB.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div></pre></td><td class="code"><pre><div class="line">package Utils;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line">import java.io.UnsupportedEncodingException;</div><div class="line">import java.sql.Connection;</div><div class="line">import java.sql.DriverManager;</div><div class="line">import java.sql.PreparedStatement;</div><div class="line">import java.sql.ResultSet;</div><div class="line">import java.sql.ResultSetMetaData;</div><div class="line">import java.sql.SQLException;</div><div class="line">import java.sql.Statement;</div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line"></div><div class="line">/** 更新时间： 2016.12.08</div><div class="line"> *   </div><div class="line"> *  数据库封装类</div><div class="line"> *          单例模式,【兼容MySQL(导入mysql-connector-java-5.1.38-bin.jar)和SQLite(导入sqlite-jdbc-3.15.1.jar)】</div><div class="line"> *          方法1-基础使用</div><div class="line"> *          方法2-查询 【SELECT】</div><div class="line"> *          方法3-插入【INSERT】</div><div class="line"> *          方法4-执行SQL语句</div><div class="line"> *              </div><div class="line"> *              @author suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class UseDB &#123;</div><div class="line">    </div><div class="line">    //静态成员变量，支持单例模式</div><div class="line">    private static  volatile UseDB udb = null;</div><div class="line">    </div><div class="line">    </div><div class="line">    private static String databaseType;  //数据库类型【例如:Mysql,Oracle,SQLite之类的】</div><div class="line">    </div><div class="line">    private String drive;                            //数据库驱动</div><div class="line">    private String link;                             //【mysql—JDBC链接+IP地址+端口】</div><div class="line"></div><div class="line">    private String username;                  //用户名</div><div class="line">    private String password;                    //密码</div><div class="line">    </div><div class="line">    private Connection conn=null;</div><div class="line">    private Statement st=null;</div><div class="line">    private PreparedStatement pst=null;</div><div class="line">    private ResultSet rs=null;</div><div class="line">    private ResultSetMetaData rsmd=null;//获取列的信息</div><div class="line">    </div><div class="line">    private String sql; //sql语句</div><div class="line">    </div><div class="line">        </div><div class="line">        //有参构造函数进行赋值</div><div class="line">        public UseDB(String dbType)&#123;</div><div class="line">        </div><div class="line">            this.databaseType=dbType.toLowerCase(); //设定当前工具类使用什么类型的数据库</div><div class="line">            </div><div class="line">            if(&quot;mysql&quot;.equals(databaseType))&#123;   //转换为小写匹配</div><div class="line">                </div><div class="line">                this.drive=&quot;com.mysql.jdbc.Driver&quot;;             </div><div class="line">                this.link=&quot;jdbc:mysql://127.0.0.1:3306/&quot;;     </div><div class="line">                this.username=&quot;root&quot;;                                   </div><div class="line">                this.password=&quot;liushuwei&quot;;                  </div><div class="line">                </div><div class="line">            &#125;else if(&quot;sqlite&quot;.equals(databaseType))&#123;</div><div class="line">                </div><div class="line">                this.drive=&quot;org.sqlite.JDBC&quot;;                       //数据库驱动</div><div class="line">                this.link=&quot;jdbc:sqlite:SQLite/&quot;;     //jdbc:sqlite:+路径【默认项目根目录/SQLite】+数据库名</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    </div><div class="line">        </div><div class="line">        </div><div class="line">        </div><div class="line">        //A-1.懒汉式(加双重校验锁):【单例设计模式，获取实例,节约系统资源，提高性能】 ,项目中使用UseDB udb =UseDB.getInstance(&quot;javareptile&quot;);获取实例</div><div class="line">        public static synchronized UseDB getInstance() throws IOException,ClassNotFoundException,SQLException&#123;</div><div class="line">            if(udb == null)&#123;</div><div class="line">                    synchronized(UseDB.class)&#123;</div><div class="line">                        if(udb ==null)&#123;  //2   双重校验锁，实现延迟加载，解决线程并发，使用volatile指令静止重拍序列化</div><div class="line">                            udb = new UseDB(databaseType);</div><div class="line">                            udb.connDatabase(&quot;javareptile&quot;);</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">            &#125;</div><div class="line">            return udb;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line"></div><div class="line">        //方法1: 连接database数据库</div><div class="line">        public void connDatabase(String database)  throws SQLException,ClassNotFoundException&#123; //参数：数据库名称</div><div class="line">             Class.forName(drive);</div><div class="line">             if(&quot;mysql&quot;.equals(databaseType))&#123;</div><div class="line">                 conn=DriverManager.getConnection(link+database+&quot;?characterEncoding=UTF-8&amp;useSSL=false&quot;,username,password); </div><div class="line">             &#125;else if(&quot;sqlite&quot;.equals(databaseType))&#123;</div><div class="line">                 conn=DriverManager.getConnection(link+database);   </div><div class="line">             &#125;</div><div class="line"></div><div class="line">             st=conn.createStatement();</div><div class="line">//           System.out.println(&quot;数据库连接成功......&quot;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        //访法1-2: 使用database数据库                                </div><div class="line">        public void useDatabase(String database) throws SQLException&#123;//参数: 数据库名称</div><div class="line">            </div><div class="line">                sql=&quot;USE &quot;+database+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line"></div><div class="line">            System.out.println(&quot;********************目前使用&quot;+database+&quot;数据库**************************&quot;);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法1-3关闭所有对象</div><div class="line">        public void closeAll() throws SQLException&#123;</div><div class="line">            </div><div class="line">            if(rs!=null)  rs.close();//关闭ResultSet</div><div class="line">            if(pst!=null)   pst.close();    //关闭PreparedStatement</div><div class="line">            if(st!=null) st.close();//关闭Statement</div><div class="line">            if(conn!=null)  conn.close(); //关闭Connection</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    </div><div class="line">        </div><div class="line">//**************************************************************************************************************************************************************************        </div><div class="line">        </div><div class="line">        //方法2-1:查询table表中record字段满足condition条件的值,返回查询内容【字段值】 ，不能用于 * 查询</div><div class="line">        public String select(String table,String record,String condition)throws SQLException&#123;//参数: 表名,字段名,WHERE条件</div><div class="line">                StringBuilder sb= new StringBuilder();</div><div class="line">                </div><div class="line">                sql=&quot;SELECT &quot;+record+&quot; FROM &quot; +table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                ResultSetMetaData rsm =rs.getMetaData(); //获得列集</div><div class="line">                while(rs.next())&#123;</div><div class="line">                    sb.append(rs.getString(record));</div><div class="line">                &#125;</div><div class="line"></div><div class="line">            return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-2:查询table表中record字段满足condition条件的值,打印到控制台，并返回一个字符串【&amp;换列】</div><div class="line">                public String select(String table,String record,String condition,char o)throws SQLException&#123;//参数: 表名,字段名,WHERE条件</div><div class="line">                        StringBuilder sb= new StringBuilder();</div><div class="line">                        </div><div class="line">                        sql=&quot;SELECT * FROM &quot; +table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                        rs=st.executeQuery(sql);</div><div class="line">                        rsmd=rs.getMetaData();</div><div class="line">                        while(rs.next())&#123;</div><div class="line">                            for(int i=1;i&lt;=rsmd.getColumnCount();i++)&#123;  //获取总列数 数据字段从1开始</div><div class="line">                                if(rs.getString(i).equals(&quot;&quot;))&#123;</div><div class="line">                                    sb.append(&quot;-0-&amp;&quot;);</div><div class="line">                                &#125;else&#123;</div><div class="line">                                    sb.append(rs.getString(i)+&quot;&amp;&quot;);</div><div class="line">                                &#125;</div><div class="line">                                System.out.print(rs.getString(i)+&quot;\t&quot;);  //输出每个字段值，间隔一个Tab长度</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line"></div><div class="line">                    return sb.toString();</div><div class="line">                &#125;</div><div class="line">        </div><div class="line">        //方法2-3:查询table所有数据的数据,打印到控制台，并返回一个字符串 【&amp;换列，##换行】</div><div class="line">        public String select(String table) throws SQLException&#123;//参数: 表名</div><div class="line">                StringBuilder sb= new StringBuilder();</div><div class="line">                </div><div class="line">                sql=&quot;SELECT * FROM &quot; +table+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                rsmd =rs.getMetaData(); //获得列集</div><div class="line">                </div><div class="line">                    while(rs.next())&#123;//光标移动</div><div class="line">                        for(int i=1;i&lt;=rsmd.getColumnCount();i++)&#123;  //获取总列数</div><div class="line">                            sb.append(rs.getString(i)+&quot;&amp;&quot;);</div><div class="line">                            System.out.print(rs.getString(i)+&quot;\t&quot;);  //输出每个字段值，间隔一个Tab长度</div><div class="line">                        &#125;</div><div class="line">                        System.out.println();//换行</div><div class="line">                        sb.append(&quot;##&quot;);</div><div class="line">                    &#125;</div><div class="line">    </div><div class="line">            </div><div class="line">                return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">            </div><div class="line">        </div><div class="line">        //方法2-4:查询table表,record字段的所有记录值(所有行)【##换行】</div><div class="line">        public String selectAllColumn(String table,String record) throws SQLException&#123;</div><div class="line">            StringBuilder sb= new StringBuilder();</div><div class="line">            </div><div class="line">             sql=&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot;;&quot;;</div><div class="line">             rs=st.executeQuery(sql);</div><div class="line">             while(rs.next())&#123;</div><div class="line">                 sb.append(rs.getString(1)+&quot;##&quot;);</div><div class="line">             &#125;</div><div class="line">             </div><div class="line">            return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-5:查询table表,record字段的所有记录值(所有行),用ArrayList保存</div><div class="line">                public List&lt;String&gt; selectAllColumn_list(String table,String record) throws SQLException&#123;</div><div class="line">                    List&lt;String&gt; list = new ArrayList&lt;String&gt;();</div><div class="line">                     sql=&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot;;&quot;;</div><div class="line">                     rs=st.executeQuery(sql);</div><div class="line">                     while(rs.next())&#123;</div><div class="line">                         list.add(rs.getString(1));</div><div class="line">                     &#125;</div><div class="line">                     </div><div class="line">                    return list;</div><div class="line">                &#125;</div><div class="line">        </div><div class="line">        //方法2-6：查询table表,满足content条件【具有唯一性】，有记录的字段直接返回记录值,没有则返回null</div><div class="line">        public String selectIfExist_CheckRecord(String table,String record,String condition) throws SQLException&#123;//参数: 表名,字段名，条件</div><div class="line">                </div><div class="line">                sql=&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                String record_content=null;</div><div class="line">                if(rs.next())&#123;</div><div class="line">                    record_content=rs.getString(1);</div><div class="line">                &#125;</div><div class="line"></div><div class="line">            return record_content;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法2-7:查询table表,根据条件condition【具有唯一性】,判断整行记录那个字段拥有记录，有记录的字段返回字段名和值【&amp;&amp;&amp;&amp;&amp;分隔】</div><div class="line">        public ArrayList&lt;String&gt; selectIfExist_CheckRecord(String table,String condition,char o) throws SQLException&#123;//参数: 表名，条件,*</div><div class="line">            </div><div class="line">            ArrayList&lt;String&gt; al = new ArrayList&lt;String&gt;();</div><div class="line">                </div><div class="line">                sql=&quot;SELECT * FROM &quot;+table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                System.out.println(sql);</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                rsmd=rs.getMetaData();</div><div class="line"></div><div class="line">                while(rs.next())&#123;</div><div class="line">                    for(int i=1;i&lt;=rsmd.getColumnCount();i++)&#123;  </div><div class="line">                        al.add(rsmd.getColumnName(i));//只要列名</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">            return al;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-8: 查询table表,满足条件condition的,返回规定范围行数的记录的列名【&amp;分隔每列】</div><div class="line">        public ArrayList&lt;String&gt; selectAskinformation_Scope(String table,String condition,String scope) throws SQLException&#123; //参数:表名,条件,范围行数【使用-进行分隔,例如1-5】</div><div class="line">//              StringBuilder sb= new StringBuilder();</div><div class="line">                ArrayList&lt;String&gt; alist = new  ArrayList&lt;String&gt;();</div><div class="line">                </div><div class="line">                String [] scope_arrays =scope.split(&quot;-&quot;);</div><div class="line">                int begin=Integer.parseInt(scope_arrays[0]);</div><div class="line">                int end=Integer.parseInt(scope_arrays[1]);</div><div class="line">                </div><div class="line">                sql=&quot;SELECT * FROM &quot;+table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                rsmd=rs.getMetaData();</div><div class="line">                while(rs.next())&#123;</div><div class="line">                    for(int i=begin;i&lt;=end;i++)&#123; //遍历范围区间的字段</div><div class="line">                        if(rs.getString(i)==null || rs.getString(i).length()&lt;2) continue;</div><div class="line">                        alist.add(rsmd.getColumnName(i));//只要列名</div><div class="line">                    &#125;       </div><div class="line">                &#125;</div><div class="line"></div><div class="line">            return alist;   </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-9：查询table所有记录总数，返回记录总数</div><div class="line">        public int select_allCount(String table) throws SQLException&#123;//参数：表名</div><div class="line">            </div><div class="line">            </div><div class="line">            sql=&quot;SELECT count(*)  FROM &quot; +table+&quot;;&quot;;</div><div class="line">            rs=st.executeQuery(sql);</div><div class="line">            rs.next();</div><div class="line">            </div><div class="line">            int recordCount =Integer.parseInt(rs.getString(1));</div><div class="line"></div><div class="line">            return recordCount;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">//**************************************************************************************************************************************************************************</div><div class="line">        </div><div class="line">        //方法3-1: 往table表插入整行数据【按顺序依次匹配第1列到最后1列】</div><div class="line">        public void insert(String table,String content) throws SQLException&#123;//参数: 表名,内容</div><div class="line">                    String sql=&quot;INSERT OR IGNORE  INTO  &quot;+table+&quot; VALUES(&quot;+content+&quot;);&quot;;//去重插入【应用于SQLite】遇到重复就跳过OR IGNORE</div><div class="line">                    int i=st.executeUpdate(sql);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法3-2: 往table表record字段,插入一行content数据【少量数据(标题，日期等)】【多字段插入   ,分隔字段     ,号分隔内容】</div><div class="line">        public void insert(String table,String record,String content) throws SQLException&#123;//参数: 表名,字段,内容</div><div class="line">                    String sql=&quot;INSERT INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+content+&quot;);&quot;;</div><div class="line">                    int i=st.executeUpdate(sql);</div><div class="line">                    if(i!=-1)&#123;</div><div class="line">//                      System.out.println(&quot;*****************&quot;+table+&quot;表INSERT成功！****************&quot;);</div><div class="line">                    &#125;</div><div class="line">        &#125;</div><div class="line">                </div><div class="line">        //方法3-3:往table表record，插入一行content数据 【大量数据(文章，文本内容)】【,分隔字段 &amp;&amp;&amp;&amp;&amp; 分隔内容   ,分隔占位符】</div><div class="line">        public void insert(String table,String record,String content,String mark) throws SQLException, UnsupportedEncodingException&#123;//参数值: 表名,字段,内容，占位符(?)</div><div class="line">//                  content =new String(content.getBytes(),&quot;UTF-8&quot;);</div><div class="line">            </div><div class="line">                    String [] content_Arrays=content.split(&quot;&amp;&amp;&amp;&amp;&amp;&quot;);//分隔内容存入数组</div><div class="line">                    String [] mark_Arrays = mark.split(&quot;,&quot;);</div><div class="line">                    </div><div class="line">                    //判断是否存在相同记录，如果存在则不执行插入【以第一条record为准】</div><div class="line">                    String first_record=record.substring(0,record.indexOf(&quot;,&quot;));</div><div class="line">                    sql  =&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot; WHERE &quot;+first_record+&quot;=&apos;&quot;+content_Arrays[0]+&quot;&apos;;&quot;;</div><div class="line">                    rs=st.executeQuery(sql);</div><div class="line">                        </div><div class="line">                        if(rs.next())&#123;//光标移动</div><div class="line">                            //存在相同记录</div><div class="line">                            System.out.println(&quot;**********************很抱歉，&quot;+table+&quot;表已经存在&quot;+content_Arrays[0]+&quot;记录,INSERT失败,不进行重复插入！*************************8888&quot;);</div><div class="line">                        &#125;else&#123;</div><div class="line">                            //不存在相同记录</div><div class="line">//                          System.out.println(&quot;**********************&quot;+table+&quot;表中不存在&quot;+content_Arrays[0]+&quot;记录,正在进行INSERT。。。。。。。。。。。。。&quot;);</div><div class="line">                            sql=&quot;INSERT INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+mark+&quot;);&quot;;</div><div class="line">                            </div><div class="line">                            pst=conn.prepareStatement(sql);</div><div class="line">                            </div><div class="line">                            for(int i=1;i&lt;=mark_Arrays.length;i++)&#123;//根据占位符个数【?的数量】进行循环: ?号个数            </div><div class="line">                                pst.setString(i,mark_Arrays[i-1]);</div><div class="line">                            &#125;</div><div class="line">                            </div><div class="line">                            pst.executeUpdate();</div><div class="line">//                          System.out.println(&quot;*****************&quot;+table+&quot;表INSERT成功！****************&quot;);</div><div class="line">                        &#125;</div><div class="line">            &#125;</div><div class="line">        </div><div class="line">        //方法3-4(去重插入1)： 添加唯一索引,使用INSERT INTO ... ON DUPLICATE KEY UPDATE ..【重复插入时更新】</div><div class="line">        public void insertUpdate(String table,String record,String content,String UpdateConent) throws SQLException&#123;//参数: 表名,字段,内容,更新内容</div><div class="line">            String sql=&quot;INSERT INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+content+&quot;) ON DUPLICATE KEY UPDATE &quot;+UpdateConent+&quot;;&quot;;</div><div class="line">            int i=st.executeUpdate(sql);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法3-5(去重插入2): 添加唯一索引,使用INSERT IGNORE INTO...【存在相同数据，就跳过该数据】</div><div class="line">        public void insertInGore(String table,String record,String content) throws SQLException&#123;//参数: 表名,字段,内容,更新内容</div><div class="line">                String sql=&quot;INSERT IGNORE INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+content+&quot;);&quot;;</div><div class="line">                int i=st.executeUpdate(sql);</div><div class="line">        &#125;       </div><div class="line">        </div><div class="line">        //方法3-6(去重插入3):添加唯一索引,使用REPLACE INTO【不重复和INSERT的功能一样,有重复就使用新纪录值替换原来记记录值】</div><div class="line">                                                                                         //【表中必须有唯一索引，而且不为空字段，否则就和INSERT完全一样】【将DELETE和INSERT和操作合二唯一】</div><div class="line">        public void insertReplace(String table,String record,String content) throws SQLException&#123;//参数: 表名,字段,内容</div><div class="line">            String sql=&quot;REPLACE INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+content+&quot;);&quot;;</div><div class="line">            int i=st.executeUpdate(sql);</div><div class="line">            //执行REPLACE后，系统返回所受影响行数，=1说明表中没有重复记录，=2则说明有，&gt;2说明有多个唯一索引，有多条记录被删除和插入。</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法3-6(去重插入4)：使用dual【虚表去重】【度娘度娘....】</div><div class="line">        </div><div class="line"></div><div class="line">//**************************************************************************************************************************************************************************</div><div class="line">        </div><div class="line">        //方法4-1：【执行创建语句】</div><div class="line">        public void createSQL(String sql) throws SQLException&#123;</div><div class="line">            st.executeUpdate(sql);  </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法4-2：【执行插入语句】</div><div class="line">        public void insertSQL(String sql) throws SQLException&#123;</div><div class="line">            st.executeUpdate(sql);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法4-3：【执行查找语句】</div><div class="line">        public void selectSQL(String sql) throws SQLException&#123;</div><div class="line">            rs = st.executeQuery(sql);</div><div class="line">            rsmd=rs.getMetaData();</div><div class="line">            while(rs.next())&#123;</div><div class="line">                for(int i=1;i&lt;=rsmd.getColumnCount();i++)&#123;</div><div class="line">                    System.out.print(rsmd.getColumnName(i)+&quot;:&quot;+rs.getString(i)+&quot;\t&quot;);</div><div class="line">                &#125;</div><div class="line">                System.out.println();//换行</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法4-4:【执行更新操作】</div><div class="line">        public void updateSQL(String sql) throws SQLException&#123;</div><div class="line">            conn.setAutoCommit(false);//禁止自动提交</div><div class="line">            st.executeUpdate(sql);</div><div class="line">            conn.commit();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法4-5:【执行删除操作】</div><div class="line">        public void deleteSQL(String sql) throws SQLException&#123;</div><div class="line">            conn.setAutoCommit(false);//禁止自动提交</div><div class="line">            st.executeUpdate(sql);</div><div class="line">            conn.commit();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //**************************************************************************************************************************************************************************</div><div class="line">        </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p><br><br></p>
<p>2.UseExcel.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div></pre></td><td class="code"><pre><div class="line">package Utils;</div><div class="line"></div><div class="line">import java.io.File;</div><div class="line">import java.io.FileOutputStream;</div><div class="line">import java.io.IOException;</div><div class="line"></div><div class="line">import org.apache.poi.EncryptedDocumentException;</div><div class="line">import org.apache.poi.hssf.usermodel.HSSFRow;</div><div class="line">import org.apache.poi.hssf.usermodel.HSSFSheet;</div><div class="line">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</div><div class="line">import org.apache.poi.openxml4j.exceptions.InvalidFormatException;</div><div class="line">import org.apache.poi.ss.usermodel.Cell;</div><div class="line">import org.apache.poi.ss.usermodel.Row;</div><div class="line">import org.apache.poi.ss.usermodel.Sheet;</div><div class="line">import org.apache.poi.ss.usermodel.WorkbookFactory;</div><div class="line"></div><div class="line">/**更新时间:2016.12.13</div><div class="line"> *          操作Excel工作薄</div><div class="line"> *              方法1：使用jxl.jar   【创建和读取excel】</div><div class="line"> *              方法2：使用poi.jar 【创建和读取excel】</div><div class="line"> *      @author Suvan</div><div class="line"> */</div><div class="line">public class UseExcel &#123;</div><div class="line">    </div><div class="line">    </div><div class="line">//  //方法1-2：创建Excel文件，写入数据</div><div class="line">//  public  static void createExcel() throws IOException,WriteException&#123;</div><div class="line">//      //1.新建文件，设置目录</div><div class="line">//      File xlsFile = new File(&quot;C:\\Users\\Liu-shuwei\\Desktop\\jxl.xls&quot;); </div><div class="line">//      </div><div class="line">//      //2.创建工作簿</div><div class="line">//      WritableWorkbook workbook = Workbook.createWorkbook(xlsFile);</div><div class="line">//      </div><div class="line">//      //3.创建工作表</div><div class="line">//       WritableSheet sheet = workbook.createSheet(&quot;sheet1&quot;, 0);</div><div class="line">//        for (int row = 0; row &lt; 10; row++)&#123;   </div><div class="line">//           for (int col = 0; col &lt; 10; col++) &#123;</div><div class="line">//               </div><div class="line">//               //第col列【从0开始】，第row行【从0开始】，数据</div><div class="line">//               Label lb = new Label(col,row,&quot;数据【&quot;+col+&quot;列&quot;+row+&quot;行】&quot;);</div><div class="line">//               sheet.addCell(lb);  // 向工作表中添加数据</div><div class="line">//           &#125;</div><div class="line">//        &#125;</div><div class="line">//        </div><div class="line">//        //4.写入数据</div><div class="line">//        workbook.write();</div><div class="line">//        </div><div class="line">//        //5.关闭流</div><div class="line">//        workbook.close();</div><div class="line">//  &#125;</div><div class="line">//  </div><div class="line">//  //方法1-2：读取Excel</div><div class="line">//  public  void readExcel() throws IOException,BiffException&#123;</div><div class="line">//      </div><div class="line">//      //1.定位文件</div><div class="line">//      File xlsFile = new File(&quot;C:\\Users\\Liu-shuwei\\Desktop\\第5周-8.23.xls&quot;);</div><div class="line">//      </div><div class="line">//      //2.获得工作薄对象</div><div class="line">//      Workbook workbook = Workbook.getWorkbook(xlsFile);</div><div class="line">//      </div><div class="line">//      //3.获得所有工作表</div><div class="line">//      Sheet [] sheets = workbook.getSheets();</div><div class="line">//      </div><div class="line">//      //4.遍历工作表</div><div class="line">//      if(sheets != null)&#123;</div><div class="line">//          for(Sheet sheet:sheets)&#123;</div><div class="line">//              int rows = sheet.getRows();             //获得行数</div><div class="line">//              int cols = sheet.getColumns();      //获得列数</div><div class="line">//              </div><div class="line">//              //读取数据</div><div class="line">//              for(int row =1;row&lt;rows;row++)&#123;</div><div class="line">////                    Cell    [] cells =sheet.getRow(row);//获取整行数据,保存进数组,Sheet.getColumn()是获取整列</div><div class="line">//</div><div class="line">//                  for(int col = 0;col &lt; cols;col++)&#123;</div><div class="line">//                      System.out.printf(&quot;%10s&quot;,sheet.getCell(col,row).getContents());</div><div class="line">//                  &#125;</div><div class="line">//                  System.out.println(); //换行</div><div class="line">//              &#125;</div><div class="line">//          &#125;</div><div class="line">//      &#125;</div><div class="line">//  </div><div class="line">//      workbook.close();</div><div class="line">//  &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">//************************************************************************************************************************</div><div class="line">    //方法2-1：poi创建excel</div><div class="line">    public static void createExcel_poi() throws IOException&#123;</div><div class="line">            //1.创建工作簿</div><div class="line">            HSSFWorkbook workbook =new HSSFWorkbook();</div><div class="line">            </div><div class="line">            //2.创建工作表</div><div class="line">            HSSFSheet sheet = workbook.createSheet(&quot;suvan&quot;);</div><div class="line">            for(int row =0;row&lt;10;row++)&#123;</div><div class="line">                HSSFRow rows = sheet.createRow(row);</div><div class="line">                for(int col=0;col&lt;10;col++)&#123;</div><div class="line">                    //向工作表添加数据</div><div class="line">                    rows.createCell(col).setCellValue(&quot;数据第&quot;+row+&quot;行-&quot;+col+&quot;列&quot;);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            //3.创建文件</div><div class="line">            File xlsFile = new File(&quot;C:\\Users\\Liu-shuwei\\Desktop\\suvan.xls&quot;);</div><div class="line">            FileOutputStream xlsStream = new FileOutputStream(xlsFile);</div><div class="line">            workbook.write(xlsStream);</div><div class="line">            workbook.close();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法2-2:poi读取excel文件</div><div class="line">    public static void readExcel_poi() throws EncryptedDocumentException, InvalidFormatException, IOException&#123;</div><div class="line">        //1.定位文件</div><div class="line">        File xlsFile = new File(&quot;C:\\Users\\Liu-shuwei\\Desktop\\第5周-8.23.xls&quot;);</div><div class="line">        //2.获得工作薄【WorkbookFactory位于poi-ooxml-3.14-20160307.jar】</div><div class="line">        org.apache.poi.ss.usermodel.Workbook workbook =WorkbookFactory.create(xlsFile);</div><div class="line">        //3.获得工作表个数</div><div class="line">        int sheetCount = workbook.getNumberOfSheets();</div><div class="line">        ///4.遍历工作表</div><div class="line">        for(int i=0;i&lt;sheetCount;i++)&#123;</div><div class="line">             //a.选择工作表</div><div class="line">            Sheet sheet = workbook.getSheetAt(i);</div><div class="line">            </div><div class="line">            //b.获取总行数和列数</div><div class="line">            int rows =sheet.getLastRowNum()+1;          //总行数</div><div class="line">            Row tmp = sheet.getRow(0);</div><div class="line">            if(tmp == null) continue;</div><div class="line">            int cols = tmp.getPhysicalNumberOfCells();  //总列数</div><div class="line"></div><div class="line">            //c.读取数据</div><div class="line">            for(int row =0;row&lt;rows;row++)&#123;</div><div class="line">                Row r = sheet.getRow(row);</div><div class="line">                for(int col=0;col&lt;cols;col++)&#123;</div><div class="line">                    if(r.getCell(col)!=null)&#123;</div><div class="line">                        r.getCell(col).setCellType(Cell.CELL_TYPE_STRING); //设置Cell类型，然后就可以把纯数字作为String类型读出来</div><div class="line">                        System.out.printf(&quot;%10s&quot;,r.getCell(col).getStringCellValue());</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">        </div><div class="line">                System.out.println();//换行</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        workbook.close();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p><br><br><br><br><br></p>
<h1 id="版本5-0【2016-12-18】"><a href="#版本5-0【2016-12-18】" class="headerlink" title="版本5.0【2016.12.18】"></a>版本5.0【2016.12.18】</h1><p><br></p>
<p>版本更新：</p>
<ol>
<li>5.0【GUI版】,添加UI界面,使用Swing原生界面</li>
<li>优化代码,使用工具类UseExcel.java</li>
<li>将程序打包成jar【Export—&gt;Runnable JAR file】</li>
</ol>
<p><br><br></p>
<p>未填的坑</p>
<ul>
<li>一个帅气的界面</li>
<li>自定义语法修改模版</li>
<li>进度条</li>
<li>回调刷新窗口</li>
<li>定时器</li>
<li>多线程生成</li>
</ul>
<p><br><br></p>
<p>项目结构【打包成suvan.jar】<br>BatchCreate_file<br>&emsp;src<br>&emsp;&emsp;extend.example<br>&emsp;&emsp;&emsp;GetFirstLetter.java<br>&emsp;&emsp;main<br>&emsp;&emsp;&emsp;AlterContent.java<br>&emsp;&emsp;&emsp;GetTableData.java<br>&emsp;&emsp;&emsp;GoTask.java<br>&emsp;&emsp;&emsp;NumBean.java<br>&emsp;&emsp;&emsp;test.java<br>&emsp;&emsp;UI<br>&emsp;&emsp;&emsp;alterModelUI.java<br>&emsp;&emsp;&emsp;insertUI.java<br>&emsp;&emsp;&emsp;mainUI.java<br>&emsp;&emsp;&emsp;ProgressBar.java<br>&emsp;&emsp;Utils<br>&emsp;&emsp;&emsp;IOFile.java<br>&emsp;&emsp;&emsp;UseDB.java<br>&emsp;&emsp;&emsp;UseExcel.java<br>&emsp;&emsp;&emsp;UseString.java<br>&emsp;JRE System Libary[JavASE -1.8]<br>&emsp;Referenced Libraries<br>&emsp;Data<br>&emsp;&emsp;record.suvan<br>&emsp;Excel<br>&emsp;lib<br>&emsp;&emsp;jxl.jar<br>&emsp;&emsp;mysql-connector-jar.5.1.38-bin.jar<br>&emsp;&emsp;poi-3.14-20160307.jar<br>&emsp;&emsp;poi-ooxml-3.140-2016030.jar<br>&emsp;&emsp;sqlite-jdbc-3.15.1.jar<br>&emsp;model_file<br>&emsp;&emsp;BackupTask.java<br>&emsp;&emsp;BackupTask.txt<br>&emsp;&emsp;ZhaoGoServiceModel.java<br>&emsp;&emsp;ZhaoGgServiceModel.txt<br>&emsp;SQLite<br>&emsp;&emsp;&emsp;batchcreate_file.db</p>
<p><br><br></p>
<p>BrachCreate5.0【GUI版】的文件结构<br>&emsp;BatchCreate 文档.txt<br>&emsp;用于测试的excel表.xls<br>&emsp;运行程序.bat<br>&emsp;BrachCreate5.0<br>&emsp;&emsp;Data<br>&emsp;&emsp;&emsp;record.suvan<br>&emsp;&emsp;model_file<br>&emsp;&emsp;&emsp;BackupTask.java<br>&emsp;&emsp;&emsp;BackupTask.txt<br>&emsp;&emsp;&emsp;ZhaoGoServiceModel.java<br>&emsp;&emsp;&emsp;ZhaoGgServiceModel.txt<br>&emsp;&emsp;SQLite<br>&emsp;&emsp;&emsp;batchcreate_file.db<br>&emsp;&emsp;suvan.jar</p>
<p><br><br></p>
<h2 id="Code【贴上所有代码】"><a href="#Code【贴上所有代码】" class="headerlink" title="Code【贴上所有代码】"></a>Code【贴上所有代码】</h2><p>extend.example包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line">package extend.example;</div><div class="line"></div><div class="line">public class GetFirstLetter &#123;</div><div class="line">    private static int BEGIN = 45217;</div><div class="line">    private static int END = 63486;</div><div class="line">    </div><div class="line">    //按照声母表示，这个表是在GB2312中的出现的第一个汉字，也就是说“啊”是代表首字母a的第一个汉字</div><div class="line">    // 二十六个字母区间对应二十七个端点    // GB2312码汉字区间十进制表示</div><div class="line">    private static char[] chartable = &#123;&apos;啊&apos;, &apos;芭&apos;, &apos;擦&apos;, &apos;搭&apos;, &apos;蛾&apos;, &apos;发&apos;, &apos;噶&apos;, &apos;哈&apos;,        &apos;哈&apos;, &apos;击&apos;, &apos;喀&apos;, &apos;垃&apos;, &apos;妈&apos;, &apos;拿&apos;, &apos;哦&apos;, &apos;啪&apos;, &apos;期&apos;, &apos;然&apos;, &apos;撒&apos;, &apos;塌&apos;, &apos;塌&apos;,        &apos;塌&apos;, &apos;挖&apos;, &apos;昔&apos;, &apos;压&apos;, &apos;匝&apos;,&#125;; </div><div class="line">    private static int [] table = new int[27]; // 对应首字母区间表</div><div class="line"></div><div class="line">    // 对应首字母区间表</div><div class="line">    private static char[] initialtable = &#123;&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos;,        &apos;h&apos;, &apos;h&apos;, &apos;j&apos;, &apos;k&apos;, &apos;l&apos;, &apos;m&apos;, &apos;n&apos;, &apos;o&apos;, &apos;p&apos;, &apos;q&apos;, &apos;r&apos;, &apos;s&apos;, &apos;t&apos;,        &apos;t&apos;, &apos;t&apos;, &apos;w&apos;, &apos;x&apos;, &apos;y&apos;, &apos;z&apos;,&#125;;</div><div class="line">    </div><div class="line">    //1.初始化</div><div class="line">     static &#123;        </div><div class="line">         for (int i = 0; i &lt; 26; i++) &#123;            </div><div class="line">             table[i] = gbValue(chartable[i]);// 得到GB2312码的首字母区间端点表，十进制。 </div><div class="line">         &#125;</div><div class="line">         table[26] = END;// 区间表结尾</div><div class="line">     &#125;</div><div class="line"></div><div class="line">     /* 根据一个包含汉字的字符串返回一个汉字拼音首字母的字符串 最重要的一个方法，思路如下：一个个字符读入、判断、输出     */</div><div class="line">     public static String getFirstLetter(String sourceStr) &#123;        </div><div class="line">            String result = &quot;&quot;;        </div><div class="line">            String str = sourceStr.toLowerCase();       </div><div class="line">            int StrLength = str.length();        </div><div class="line">            int i;       </div><div class="line">            try &#123;            </div><div class="line">                for (i = 0; i &lt; StrLength; i++) &#123;                </div><div class="line">                    result += Char2Initial(str.charAt(i));            </div><div class="line">                    &#125;        </div><div class="line">                &#125; catch (Exception e) &#123;            </div><div class="line">                    result = &quot;&quot;;        </div><div class="line">                    &#125;        </div><div class="line">            return result;   </div><div class="line">        &#125;</div><div class="line">     </div><div class="line">      /* 输入字符,得到他的声母,英文字母返回对应的大写字母,其他非简体汉字返回 &apos;0&apos;     */  </div><div class="line">     private static char Char2Initial(char ch) &#123;    </div><div class="line">                // 对英文字母的处理：小写字母转换为大写，大写的直接返回</div><div class="line">              if (ch &gt;= &apos;a&apos; &amp;&amp; ch &lt;= &apos;z&apos;) &#123;            </div><div class="line">                  return ch;        </div><div class="line">               &#125;        </div><div class="line">              if (ch &gt;= &apos;A&apos; &amp;&amp; ch &lt;= &apos;Z&apos;) &#123;</div><div class="line">                  return ch;  </div><div class="line">                &#125;</div><div class="line">         </div><div class="line">              // 对非英文字母的处理：转化为首字母，然后判断是否在码表范围内，        // 若不是，则直接返回。        // 若是，则在码表内的进行判断。   </div><div class="line">              int gb = gbValue(ch);// 汉字转换首字母</div><div class="line">              if ((gb &lt; BEGIN) || (gb &gt; END))&#123;            </div><div class="line">                  return ch;        </div><div class="line">                 &#125;</div><div class="line">    </div><div class="line">              int i;       </div><div class="line">              for (i = 0; i &lt; 26; i++) &#123; // 判断匹配码表区间，匹配到就break,判断区间形如“[,)”</div><div class="line">                  if ((gb &gt;= table[i]) &amp;&amp; (gb &lt; table[i + 1])) &#123;</div><div class="line">                      break;            </div><div class="line">                      &#125;        </div><div class="line">              &#125;</div><div class="line">              if (gb == END) &#123; //补上GB2312区间最右端    </div><div class="line">                     i = 25;        </div><div class="line">                &#125;      </div><div class="line">            return initialtable[i]; // 在码表区间中，返回首字母    &#125;</div><div class="line">         &#125;</div><div class="line"></div><div class="line">     </div><div class="line">     /* 取出汉字的编码 cn 汉字     */  </div><div class="line">    private static int gbValue(char ch) &#123;</div><div class="line">        String str = new String();        </div><div class="line">        str += ch;       </div><div class="line">        try &#123;           </div><div class="line">            byte[] bytes = str.getBytes(&quot;GB2312&quot;);            </div><div class="line">            if (bytes.length &lt; 2) &#123;               </div><div class="line">                    return 0;           </div><div class="line">            &#125;            </div><div class="line">            return (bytes[0] &lt;&lt; 8 &amp; 0xff00) + (bytes[1] &amp; 0xff);      </div><div class="line">        &#125; catch (Exception e) &#123;          </div><div class="line">            return 0;        </div><div class="line">            &#125;    </div><div class="line">    &#125;   </div><div class="line">    </div><div class="line">//  public static void main(String [] args)&#123;</div><div class="line">//      //在main方法中调用FirstLetterUtil类的getFirstLetter()方法，获取姓名的首字母。如：“刘德华”获取首字母是“ldh”。</div><div class="line">//       System.out.print(getFirstLetter(&quot;日你仙人掌&quot;));//获取文字首字母的拼音</div><div class="line">//  &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p><br><br></p>
<p>main包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div><div class="line">700</div><div class="line">701</div><div class="line">702</div><div class="line">703</div><div class="line">704</div><div class="line">705</div><div class="line">706</div><div class="line">707</div><div class="line">708</div><div class="line">709</div><div class="line">710</div><div class="line">711</div><div class="line">712</div><div class="line">713</div><div class="line">714</div><div class="line">715</div><div class="line">716</div><div class="line">717</div><div class="line">718</div><div class="line">719</div><div class="line">720</div><div class="line">721</div><div class="line">722</div><div class="line">723</div><div class="line">724</div><div class="line">725</div><div class="line">726</div><div class="line">727</div><div class="line">728</div><div class="line">729</div><div class="line">730</div><div class="line">731</div><div class="line">732</div><div class="line">733</div><div class="line">734</div><div class="line">735</div><div class="line">736</div><div class="line">737</div><div class="line">738</div><div class="line">739</div><div class="line">740</div><div class="line">741</div><div class="line">742</div><div class="line">743</div><div class="line">744</div><div class="line">745</div><div class="line">746</div><div class="line">747</div><div class="line">748</div><div class="line">749</div><div class="line">750</div><div class="line">751</div><div class="line">752</div><div class="line">753</div><div class="line">754</div><div class="line">755</div><div class="line">756</div><div class="line">757</div><div class="line">758</div><div class="line">759</div><div class="line">760</div><div class="line">761</div><div class="line">762</div><div class="line">763</div><div class="line">764</div><div class="line">765</div><div class="line">766</div><div class="line">767</div><div class="line">768</div><div class="line">769</div><div class="line">770</div><div class="line">771</div><div class="line">772</div><div class="line">773</div><div class="line">774</div><div class="line">775</div><div class="line">776</div><div class="line">777</div><div class="line">778</div><div class="line">779</div><div class="line">780</div><div class="line">781</div><div class="line">782</div><div class="line">783</div><div class="line">784</div><div class="line">785</div><div class="line">786</div><div class="line">787</div><div class="line">788</div><div class="line">789</div><div class="line">790</div><div class="line">791</div><div class="line">792</div><div class="line">793</div><div class="line">794</div><div class="line">795</div><div class="line">796</div><div class="line">797</div><div class="line">798</div><div class="line">799</div><div class="line">800</div><div class="line">801</div><div class="line">802</div><div class="line">803</div><div class="line">804</div><div class="line">805</div><div class="line">806</div><div class="line">807</div><div class="line">808</div><div class="line">809</div><div class="line">810</div><div class="line">811</div><div class="line">812</div><div class="line">813</div><div class="line">814</div><div class="line">815</div><div class="line">816</div><div class="line">817</div><div class="line">818</div><div class="line">819</div><div class="line">820</div><div class="line">821</div><div class="line">822</div><div class="line">823</div><div class="line">824</div><div class="line">825</div><div class="line">826</div><div class="line">827</div><div class="line">828</div><div class="line">829</div><div class="line">830</div><div class="line">831</div><div class="line">832</div><div class="line">833</div><div class="line">834</div><div class="line">835</div><div class="line">836</div><div class="line">837</div><div class="line">838</div><div class="line">839</div><div class="line">840</div><div class="line">841</div><div class="line">842</div><div class="line">843</div><div class="line">844</div><div class="line">845</div><div class="line">846</div><div class="line">847</div><div class="line">848</div><div class="line">849</div><div class="line">850</div><div class="line">851</div><div class="line">852</div><div class="line">853</div><div class="line">854</div><div class="line">855</div><div class="line">856</div><div class="line">857</div><div class="line">858</div><div class="line">859</div><div class="line">860</div><div class="line">861</div><div class="line">862</div><div class="line">863</div><div class="line">864</div><div class="line">865</div><div class="line">866</div><div class="line">867</div><div class="line">868</div><div class="line">869</div><div class="line">870</div><div class="line">871</div><div class="line">872</div><div class="line">873</div><div class="line">874</div><div class="line">875</div><div class="line">876</div><div class="line">877</div><div class="line">878</div><div class="line">879</div><div class="line">880</div><div class="line">881</div><div class="line">882</div><div class="line">883</div><div class="line">884</div><div class="line">885</div><div class="line">886</div><div class="line">887</div><div class="line">888</div><div class="line">889</div><div class="line">890</div><div class="line">891</div><div class="line">892</div><div class="line">893</div><div class="line">894</div><div class="line">895</div><div class="line">896</div><div class="line">897</div><div class="line">898</div><div class="line">899</div><div class="line">900</div><div class="line">901</div><div class="line">902</div><div class="line">903</div><div class="line">904</div><div class="line">905</div><div class="line">906</div><div class="line">907</div><div class="line">908</div><div class="line">909</div><div class="line">910</div><div class="line">911</div><div class="line">912</div><div class="line">913</div><div class="line">914</div><div class="line">915</div><div class="line">916</div></pre></td><td class="code"><pre><div class="line">package main;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.HashMap;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseDB;</div><div class="line">import Utils.UseString;</div><div class="line"></div><div class="line">/**更新时间： 2016.12.13</div><div class="line"> * </div><div class="line"> *  获取模版内容，根据编号各个属性值，修改BackupTask.java和入库文件，创建文件</div><div class="line"> *          @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class AlterContent &#123;</div><div class="line">        </div><div class="line">        private IOFile iof;</div><div class="line">        private UseDB udb;</div><div class="line">        private UseString us;</div><div class="line">        private GetTableData gtd;</div><div class="line">        </div><div class="line">        //有参构造函数，创建对象时进行赋值</div><div class="line">        public AlterContent(IOFile iof,UseDB udb,UseString us,GetTableData gtd)&#123;  </div><div class="line">            this.iof=iof;</div><div class="line">            this.udb=udb;</div><div class="line">            this.us=us;</div><div class="line">            this.gtd=gtd;</div><div class="line">        &#125;</div><div class="line">    </div><div class="line"></div><div class="line">        //方法1:修改BackupTask.java,并创建</div><div class="line">        public  void aBackupTask(String path,String fileName,String content,String sign,ArrayList&lt;String&gt; rukuName_list) throws IOException&#123;//参数:路径，文件名，内容，标记【修改还是创建】,入库名,项目类           </div><div class="line">                </div><div class="line">             //1.修改模版内容</div><div class="line">            String BackupTask_model=&quot;\n\t\t&quot;+&quot;NameA=(NameB) ac.getBean(\&quot;fileName\&quot;);&quot; +</div><div class="line">                                                              &quot;\n\t\t&quot; +&quot;NameA.initNameB();&quot;;</div><div class="line">                String attributeName=&quot;&quot;;//属性名</div><div class="line">                String cStr =&quot;&quot;;</div><div class="line">                StringBuilder sb = new StringBuilder();//储存各个所有内容</div><div class="line">                for(int i=0;i&lt;rukuName_list.size();i++)&#123;</div><div class="line">                    attributeName =rukuName_list.get(i).substring(rukuName_list.get(i).lastIndexOf(&quot;_&quot;)+1);</div><div class="line">                    cStr=BackupTask_model.replace(&quot;NameA&quot;,us.LowFirstString(attributeName))</div><div class="line">                                                              .replace(&quot;NameB&quot;,us.UpFirstString(attributeName))</div><div class="line">                                                              .replace(&quot;fileName&quot;,rukuName_list.get(i));</div><div class="line">                    sb.append(cStr);</div><div class="line">                &#125;</div><div class="line">                sb.append(&quot;\n\t\t//ok;&quot;);//用于叠加补充</div><div class="line">                </div><div class="line">                //2.覆盖或者修改文件</div><div class="line">                if(&quot;cover&quot;.equals(sign))&#123;//覆盖 【与上一个编号完全不同(号码不同,且不带-)】</div><div class="line">                    content=content.replace(&quot;//changeModel;&quot;,sb.toString());</div><div class="line"></div><div class="line">                     iof.cFile(path, &quot;BackupTask.java&quot;, &quot;UTF-8&quot;, content);</div><div class="line">                &#125;else if(&quot;alter&quot;.equals(sign))&#123; //修改 【带-的编号,在上一个文件基础上进行叠加修改】</div><div class="line">                    content=content.replace(&quot;//ok;&quot;,sb.toString());</div><div class="line"></div><div class="line">                    iof.cFile(path, &quot;BackupTask.java&quot;, &quot;UTF-8&quot;, content);</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法2:修改入库文件</div><div class="line">        public void aRK(String path,String fileName,String content,String type,String username,NumBean numbean) throws IOException&#123;</div><div class="line">            </div><div class="line"></div><div class="line">                //一.根据类型生成相应名称</div><div class="line">                HashMap&lt;String,String&gt; hm = gtd.getTypeAllName(type);</div><div class="line"></div><div class="line">                </div><div class="line">                //二.根据需求修改content</div><div class="line">                        //A.判断信息类型</div><div class="line">                        String infType =numbean.getInftype();</div><div class="line">                        if(infType !=null  &amp;&amp; ! &quot;-0-&quot;.equals(infType))&#123;                                     //zbgg.setInfoType(&quot;服务&quot;);// 信息类型</div><div class="line">                            content=content.replaceFirst(&quot;//是否有信息类型;&quot;,&quot;zbgg.setInfoType(\&quot;&quot;+infType+&quot;\&quot;);//信息类型&quot;);</div><div class="line">                        &#125;else&#123;</div><div class="line">                            content=content.replaceFirst(&quot;//是否有信息类型;&quot;,&quot;//zbgg.setInfoType(\&quot;服务\&quot;);//信息类型&quot;);</div><div class="line">                        &#125;</div><div class="line">                    </div><div class="line">                        //B.判断行业分类</div><div class="line">                        String workType=numbean.getWorktype();</div><div class="line">                        if(workType==null &amp;&amp; ! &quot;-0-&quot;.equals(workType)) &#123;                                 //zbgg.setIndustry(&quot;建筑建材&quot;); // 行业分类</div><div class="line">                            content=content.replaceFirst(&quot;//是否有行业分类;&quot;,&quot;zbgg.setIndustry(\&quot;&quot;+workType+&quot;\&quot;); //行业分类&quot;);</div><div class="line">                        &#125;else&#123;</div><div class="line">                            content=content.replaceFirst(&quot;//是否有行业分类;&quot;,&quot;//zbgg.setIndustry(\&quot;建筑建材\&quot;); // 行业分类&quot;);</div><div class="line">                        &#125;</div><div class="line"></div><div class="line">                    </div><div class="line">                //三.修改模版</div><div class="line">                content=content.replace(&quot;zhaoBiaoGongGao&quot;,hm.get(&quot;typeSpell&quot;))</div><div class="line">                                                                             .replace(&quot;ZhaoBiaoGongGao&quot;,us.UpFirstString(hm.get(&quot;typeSpell&quot;)))</div><div class="line">                                                                             .replace(&quot;ZhaobGgService&quot;,us.UpFirstString(hm.get(&quot;typeService&quot;)))</div><div class="line">                                                                             .replace(&quot;zhaobGgService&quot;,hm.get(&quot;typeService&quot;))</div><div class="line">                                                                             .replace(&quot;zbgg&quot;,type);</div><div class="line">                content=content.replaceFirst(&quot;//@程序猿;&quot;,username)</div><div class="line">                                            .replaceFirst(&quot;//@内容;&quot;,numbean.getArea()+&quot;_&quot;+numbean.getProvince()+&quot;_&quot;+numbean.getCity()+&quot;_&quot;+numbean.getCounty()+&quot;_&quot;+hm.get(&quot;typeChinese&quot;)+&quot;_&quot;+numbean.getNum())                </div><div class="line">                                            .replaceFirst(&quot;//编号;&quot;,numbean.getNum());        </div><div class="line">                String className =fileName.substring(0,fileName.lastIndexOf(&quot;.&quot;));</div><div class="line">                content=content.replaceFirst(&quot;//注解;&quot;,className)</div><div class="line">                                            .replaceFirst(&quot;//类名;&quot;,className);</div><div class="line">                content=content.replaceFirst(&quot;//Area;&quot;,numbean.getArea())</div><div class="line">                                             .replaceFirst(&quot;//Province;&quot;,numbean.getProvince().replaceFirst(&quot;省&quot;,&quot;&quot;).replaceFirst(&quot;市&quot;,&quot;&quot;).replaceFirst(&quot;区&quot;,&quot;&quot;).replaceFirst(&quot;县&quot;,&quot;&quot;))</div><div class="line">                                            .replaceFirst(&quot;//Webname;&quot;,numbean.getWebname())</div><div class="line">                                            .replaceFirst(&quot;//Infsource;&quot;,numbean.getInfsource())</div><div class="line">                                            .replace(&quot;//表名;&quot;,hm.get(&quot;tableName&quot;));</div><div class="line">                </div><div class="line">                //仅有2个字符的时候保留，省,市，区</div><div class="line">                if(numbean.getCity().length()==2)&#123;</div><div class="line">                    content=content.replaceFirst(&quot;//City;&quot;,numbean.getCity());</div><div class="line">                &#125;else&#123;</div><div class="line">                    content=content.replaceFirst(&quot;//City;&quot;,numbean.getCity().replaceFirst(&quot;省&quot;,&quot;&quot;).replaceFirst(&quot;市&quot;,&quot;&quot;).replaceFirst(&quot;区&quot;,&quot;&quot;).replaceFirst(&quot;县&quot;,&quot;&quot;));</div><div class="line">                &#125;</div><div class="line">                </div><div class="line">                if(numbean.getCounty().length()==2)&#123;</div><div class="line">                    content=content.replaceFirst(&quot;//County;&quot;,numbean.getCounty());</div><div class="line">                &#125;else&#123;</div><div class="line">                    content=content.replaceFirst(&quot;//County;&quot;,numbean.getCounty().replaceFirst(&quot;省&quot;,&quot;&quot;).replaceFirst(&quot;市&quot;,&quot;&quot;).replaceFirst(&quot;区&quot;,&quot;&quot;).replaceFirst(&quot;县&quot;,&quot;&quot;));</div><div class="line">                &#125;</div><div class="line">                        </div><div class="line">                        </div><div class="line">                </div><div class="line">                //四.创建编号相应类型的入库文件</div><div class="line">                iof.cFile(path, fileName, &quot;UTF-8&quot;, content);</div><div class="line">        &#125;       </div><div class="line">&#125;</div><div class="line"></div><div class="line">**********************************************************************</div><div class="line"></div><div class="line"></div><div class="line">package main;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line">import java.sql.SQLException;</div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.HashMap;</div><div class="line">import java.util.regex.Pattern;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseDB;</div><div class="line">import Utils.UseExcel;</div><div class="line">import jxl.read.biff.BiffException;</div><div class="line"></div><div class="line">/**更新时间： 2016.12.18</div><div class="line"> * </div><div class="line"> *  获取数据，处理数据，归纳信息</div><div class="line"> *          @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class GetTableData &#123;</div><div class="line"></div><div class="line">    private IOFile iof;</div><div class="line">    private UseDB udb;</div><div class="line">    </div><div class="line">    //有参构造函数，创建对象时进行赋值</div><div class="line">    public GetTableData(IOFile iof,UseDB udb)&#123;</div><div class="line">        this.iof=iof;</div><div class="line">        this.udb=udb;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法1: 插入模版数据,并返回模版内容</div><div class="line">        public String getModel(String filePath) throws IOException,SQLException&#123;//参数：文件路径</div><div class="line">            </div><div class="line">            //1.读取文件内容                                                                                                      </div><div class="line">            String fileContent=iof.rFileContent(filePath,&quot;UTF-8&quot;);   //注意：路径的话用/或者\\都可以,数据库的默认编码是GBK</div><div class="line">            String modeName=filePath.substring(filePath.indexOf(&quot;/&quot;)+1);            //模版名字</div><div class="line">            </div><div class="line">            //2.判断是否存在相同模版</div><div class="line">            String modeInf = udb.select(&quot;article&quot;, &quot;model&quot;, &quot;model=&apos;&quot;+modeName+&quot;&apos;&quot;);</div><div class="line"></div><div class="line">            if(modeInf.length() &lt;1)&#123;    //判断是否已存在模版</div><div class="line">                udb.insertReplace(&quot;article&quot;,&quot;model,detail&quot;,&quot;&apos;&quot;+modeName+&quot;&apos;,&apos;&quot;+fileContent.replace(&quot;&apos;&quot;, &quot;&apos;&apos;&quot;)+&quot;&apos;&quot;); </div><div class="line">            &#125;else&#123;</div><div class="line">                System.out.println(&quot;\n********************************已存在&quot;+modeInf+&quot;模版，不进行重复插入****************************&quot;);</div><div class="line">            &#125;</div><div class="line">        </div><div class="line">            return fileContent;</div><div class="line">        &#125;</div><div class="line">    </div><div class="line">    //方法2：获取table表中，num编号的所有信息,储存进NumBean，返回NumBean</div><div class="line">    public  NumBean getNumInformation(String table,String num) throws SQLException&#123;//参数：表名,编号</div><div class="line"></div><div class="line">            //查询table表，num字段所有数据，用&amp;分隔</div><div class="line">            String numInf = udb.select(table, &quot;num&quot;, &quot;num=&apos;&quot;+num+&quot;&apos;&quot;, &apos;*&apos;);</div><div class="line">            String [] numInf_arrays=numInf.split(&quot;&amp;&quot;);</div><div class="line">            </div><div class="line">            //表共21列，Numbean共21个属性，拥有Getters和Setters</div><div class="line">            NumBean nb = new NumBean();</div><div class="line">                nb.setNum(numInf_arrays[0]);</div><div class="line">                nb.setArea(numInf_arrays[1]);</div><div class="line">                nb.setProvince(numInf_arrays[2]);</div><div class="line">                nb.setCity(numInf_arrays[3]);</div><div class="line">                nb.setCounty(numInf_arrays[4]);</div><div class="line">                nb.setWebname(numInf_arrays[5]);</div><div class="line">                nb.setWeburl(numInf_arrays[6]);</div><div class="line">                nb.setInfsource(numInf_arrays[7]);</div><div class="line">                nb.setInftype(numInf_arrays[8]);</div><div class="line">                nb.setWorktype(numInf_arrays[9]);</div><div class="line">                nb.setZbyg(numInf_arrays[10]);</div><div class="line">                nb.setZbgg(numInf_arrays[11]);</div><div class="line">                nb.setZsjg(numInf_arrays[12]);</div><div class="line">                nb.setGgbg(numInf_arrays[13]);</div><div class="line">                nb.setZbwj(numInf_arrays[14]);</div><div class="line">                nb.setZbdy(numInf_arrays[15]);</div><div class="line">                nb.setZbxx(numInf_arrays[16]);</div><div class="line">                nb.setKzj(numInf_arrays[17]);</div><div class="line">                nb.setLot(numInf_arrays[18]);</div><div class="line">                nb.setWebtype(numInf_arrays[19]);</div><div class="line">                nb.setRemark(numInf_arrays[20]);</div><div class="line">        </div><div class="line">        return nb;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法3：获取table表的，所有编号</div><div class="line">    public ArrayList&lt;String&gt; getAllNum(String table) throws SQLException&#123; //参数: 表名</div><div class="line">            ArrayList&lt;String&gt; numList = new  ArrayList&lt;String&gt;();</div><div class="line">            </div><div class="line">            String allNum =udb.selectAllColumn(table,&quot;num&quot;);</div><div class="line">            String [] allNum_arrays = allNum.split(&quot;##&quot;);</div><div class="line">            for(int i=0;i&lt;allNum_arrays.length;i++)&#123;</div><div class="line">                numList.add(allNum_arrays[i]);</div><div class="line">            &#125;</div><div class="line">            return numList;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法4:判断num编号属否在scope区间里面，返回布尔类型参数【true-属于，false-不属于】</div><div class="line">    public Boolean getMinMaxScope(String scope,int num)&#123;//参数：范围，编号</div><div class="line">            Boolean sign = false;//判断标识，默认为true</div><div class="line">            </div><div class="line">            String [] scope_arrays = scope.split(&quot;-&quot;);</div><div class="line">            int minScope =Integer.parseInt(scope_arrays[0]);</div><div class="line">            int maxScope =Integer.parseInt(scope_arrays[1]);</div><div class="line">            </div><div class="line">                if(minScope &lt;= num &amp;&amp; num &lt;= maxScope)&#123;</div><div class="line">                    sign =true;</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">            return sign;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法5:获取当前编号拥有URL的字段名【类型】</div><div class="line">    public ArrayList&lt;String&gt; getNum_HaveURLRecord(String table,String num) throws SQLException&#123; //参数：表名，编号</div><div class="line"></div><div class="line">        //查询数据库table表，num字段的11-18行，得到拥有记录的列名的ArrayList</div><div class="line">        ArrayList&lt;String&gt; alist=udb.selectAskinformation_Scope(table,&quot;num=&apos;&quot;+num+&quot;&apos;&quot;, &quot;11-18&quot;);//【11-18是招标预告到控制价】</div><div class="line"></div><div class="line">        return alist;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    //方法6：根据列名，得到相应类型的字符串</div><div class="line">    public String getTypename(String columnName)&#123; //参数：列名</div><div class="line">                String type=&quot;&quot;;</div><div class="line"></div><div class="line">                if(columnName.equals(&quot;zbyg&quot;))&#123;</div><div class="line">                    type=&quot;ZhaobYgService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zbgg&quot;))&#123;</div><div class="line">                    type=&quot;ZhaobGgService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zsjg&quot;))&#123;</div><div class="line">                    type=&quot;ZisJgService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;ggbg&quot;))&#123;</div><div class="line">                    type=&quot;GonggBgService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zbwj&quot;))&#123;</div><div class="line">                    type=&quot;ZhaobWjService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zbdy&quot;))&#123;</div><div class="line">                    type=&quot;ZhaobDyService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;zbxx&quot;))&#123;</div><div class="line">                    type=&quot;ZhongbXxService&quot;;</div><div class="line">                &#125;else if(columnName.equals(&quot;kzj&quot;))&#123;</div><div class="line">                    type=&quot;KongZjService&quot;;</div><div class="line">                &#125;</div><div class="line">        </div><div class="line">        return type;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line"></div><div class="line">    </div><div class="line">    //方法7：根据类型生成相应名称，返回HaspMap【无序键值队】</div><div class="line">    public HashMap&lt;String,String&gt; getTypeAllName(String type)&#123;  //参数：类型名，也是列名</div><div class="line">        HashMap&lt;String,String&gt; hm = new HashMap&lt;String,String&gt;();</div><div class="line"></div><div class="line">                if(type.equals(&quot;zbyg&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;zhaoBiaoYuGao&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhaobYgService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;招标预告&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhao_biao_yu_gao&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zbgg&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;zhaoBiaoGongGao&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhaobGgService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;招标公告&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhao_biao_gong_gao&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zsjg&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;ziShenJieGuo&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zisJgService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;咨审结果&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zi_shen_jie_guo&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;ggbg&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;gongGaoBianGeng&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;gonggBgService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;公告变更&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_gong_gao_bian_geng&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zbwj&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;zhaoBiaoWenJian&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhaobWjService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;招标文件&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhao_biao_wen_jian&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zbdy&quot;))&#123;</div><div class="line">                    hm.put(&quot;typeSpell&quot;, &quot;ZhaoBiaoDaYi&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhaobDyService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;招标答疑&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhao_biao_da_yi&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;zbxx&quot;))&#123;</div><div class="line">                    hm.put(&quot;typeSpell&quot;, &quot;zhongBiaoXinXi&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;zhongbXxService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;中标信息&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_zhong_biao_xin_xi&quot;);</div><div class="line">                &#125;else if(type.equals(&quot;kzj&quot;))&#123;</div><div class="line">                     hm.put(&quot;typeSpell&quot;, &quot;kongZhiJia&quot;);</div><div class="line">                     hm.put(&quot;typeService&quot;,&quot;kongZjService&quot;);</div><div class="line">                     hm.put(&quot;typeChinese&quot;,&quot;控制价&quot;);</div><div class="line">                     hm.put(&quot;tableName&quot;,&quot;t_kong_zhi_jia&quot;);</div><div class="line">                &#125;               </div><div class="line">        </div><div class="line">        return hm;      </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">//************************************************************************************************************************</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法SQLite-1：创建表结构</div><div class="line">    public void s_CreateTable(String useTable) throws SQLException&#123;</div><div class="line">        </div><div class="line">         //创建模版表</div><div class="line">        String sql1= &quot;CREATE TABLE if not exists article(&quot;  +            </div><div class="line">                                &quot;id  INCREMENT primary key,&quot; +</div><div class="line">                                &quot;model TEXT UNIQUE NOT NULL,&quot;               +</div><div class="line">                                &quot;detail TEXT NOT NULL&quot;      +</div><div class="line">                                &quot;);&quot; ;</div><div class="line">        //获取Excel数据表</div><div class="line">        String sql2=&quot;CREATE TABLE if not exists &quot;+useTable+&quot;(&quot; +</div><div class="line">                             &quot;num TEXT primary key,&quot; +</div><div class="line">                             &quot;area TEXT NOT NULL,&quot; +</div><div class="line">                             &quot;province TEXT,&quot; +</div><div class="line">                             &quot;city TEXT,&quot; +</div><div class="line">                             &quot;county TEXT,&quot; +</div><div class="line">                             &quot;webname TEXT,&quot; +</div><div class="line">                             &quot;weburl  TEXT,&quot; +</div><div class="line">                             &quot;infsource TEXT,&quot; +</div><div class="line">                             &quot;inftype   TEXT,&quot; +</div><div class="line">                             &quot;worktype TEXT,&quot; +</div><div class="line">                             &quot;zbyg  TEXT,&quot; +</div><div class="line">                             &quot;zbgg    TEXT,&quot; +</div><div class="line">                             &quot;zsjg  TEXT,&quot; +</div><div class="line">                             &quot;ggbg TEXT,&quot; +</div><div class="line">                             &quot;zbwj TEXT,&quot; +</div><div class="line">                             &quot;zbdy TEXT,&quot; +</div><div class="line">                             &quot;zbxx TEXT,&quot; +</div><div class="line">                             &quot;kzj TEXT,&quot; +</div><div class="line">                             &quot;lot TEXT,&quot; +</div><div class="line">                             &quot;webtype TEXT,&quot; +</div><div class="line">                             &quot;remark TEXT&quot;  +</div><div class="line">                             &quot;  )&quot;;</div><div class="line">        </div><div class="line">          udb.createSQL(sql1); </div><div class="line">          udb.createSQL(sql2); </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法SQLite-2.读取Excel表的数据，插入SQLite</div><div class="line">    public void s_InsertExcel(String excelPath) throws IOException,BiffException,SQLException&#123;//参数：Excel文件名,导入哪些工作表编号,导入哪个表</div><div class="line">        </div><div class="line">    </div><div class="line">        </div><div class="line">            UseExcel ue =new UseExcel();                                        //工具类</div><div class="line">        </div><div class="line">            //1.数据获取excel表的数据</div><div class="line">            HashMap [] sheets_map=ue.getExcel(excelPath);       </div><div class="line">        </div><div class="line">            //根据excel文件名建表</div><div class="line">            String tableName=excelPath.substring(excelPath.lastIndexOf(&quot;\\&quot;)+1,excelPath.lastIndexOf(&quot;.&quot;));</div><div class="line">            this.s_CreateTable(tableName);                                                              //创建表【article-保存模版,(useTable)-Excel工作薄数据】</div><div class="line">            </div><div class="line">            //2.正则判断</div><div class="line">            Pattern p = Pattern.compile(&quot;\\d+&quot;);//正则判断n行的第1列的数据是否是编号【开头是否为数字】，不是则跳过</div><div class="line"></div><div class="line">            //3.执行导入操作</div><div class="line">            if(sheets_map.length&gt;0)&#123;</div><div class="line">                System.out.println(&quot;将Excel数据插入SQLite数据库的&quot;+tableName+&quot;表---------------------------&gt;&quot;);</div><div class="line">                System.out.println(&quot;公有&quot;+sheets_map.length);</div><div class="line">                //A-遍历工作表</div><div class="line">                for(int n=0;n&lt;sheets_map.length;n++)&#123;</div><div class="line">                    HashMap&lt;Integer,ArrayList&gt; rows_map = sheets_map[n];        //获取行数据</div><div class="line"></div><div class="line">                    //B-遍历行</div><div class="line">                    for(int r=0;r&lt;rows_map.size();r++)&#123;                                         </div><div class="line">                        ArrayList&lt;String&gt; cols_list = (ArrayList)rows_map.get((Integer)r);;                             //获取每列数据</div><div class="line">                        </div><div class="line">                        System.out.print(r+&quot;行......&quot;);  </div><div class="line">                        if(cols_list.size() &lt;1  | !(p.matcher(cols_list.get(0))).find())    continue;   //整行不存在数据 or 匹配第1列数据,不是数字开头【编号格式01039】,跳过</div><div class="line">                        if(r %50 ==0)   System.out.println();                                                       //若50条记录换行一次</div><div class="line">                        </div><div class="line">                        //C-遍历列</div><div class="line">                        StringBuilder sb =new StringBuilder(&quot;&apos;&quot;);</div><div class="line">                        for(int c=0;c&lt;21;c++)&#123;                                                                               //【只需要21列数据】</div><div class="line">                            //拼接SQL</div><div class="line">                            if(c==20)&#123;</div><div class="line">                                sb.append(cols_list.get(c)+&quot;&apos;&quot;);</div><div class="line">                                continue;</div><div class="line">                            &#125;</div><div class="line">                                </div><div class="line">                            if(cols_list.get(c).length()&lt;1)</div><div class="line">                                sb.append(&quot;无&apos;,&apos;&quot;);</div><div class="line">                            else</div><div class="line">                                sb.append(cols_list.get(c)+&quot;&apos;,&apos;&quot;);</div><div class="line">                            </div><div class="line">//                          udb.insert(useTable,                                                                                //插入数据</div><div class="line">//                          &quot;&apos;&quot;+cols_list.get(0)+&quot;&apos;,&apos;&quot;+cols_list.get(1)+&quot;&apos;,&apos;&quot;+cols_list.get(2)+&quot;&apos;,&apos;&quot;+cols_list.get(3)+&quot;&apos;,&apos;&quot;+cols_list.get(4)+&quot;&apos;,&apos;&quot;</div><div class="line">//                              +cols_list.get(5)+&quot;&apos;,&apos;&quot;+cols_list.get(6)+&quot;&apos;,&apos;&quot;+cols_list.get(7)+&quot;&apos;,&apos;&quot;+cols_list.get(8)+&quot;&apos;,&apos;&quot;+cols_list.get(9)+&quot;&apos;,&apos;&quot;</div><div class="line">//                              +cols_list.get(10)+&quot;&apos;,&apos;&quot;+cols_list.get(11)+&quot;&apos;,&apos;&quot;+cols_list.get(12)+&quot;&apos;,&apos;&quot;+cols_list.get(13)+&quot;&apos;,&apos;&quot;+cols_list.get(14)+&quot;&apos;,&apos;&quot;</div><div class="line">//                              +cols_list.get(15)+&quot;&apos;,&apos;&quot;+cols_list.get(16)+&quot;&apos;,&apos;&quot;+cols_list.get(17)+&quot;&apos;,&apos;&quot;+cols_list.get(18)+&quot;&apos;,&apos;&quot;+cols_list.get(19)+&quot;&apos;,&apos;&quot;</div><div class="line">//                              +cols_list.get(20)+&quot;&apos;&quot;);</div><div class="line">                        &#125;</div><div class="line">                        udb.insert(tableName,sb.toString());                                                        //插入数据</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">**********************************************************************</div><div class="line">package main;</div><div class="line"></div><div class="line">/**更新时间： 2016.11.27</div><div class="line"> * </div><div class="line"> *  JavaBena，每一个编号</div><div class="line"> *          @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class NumBean &#123;</div><div class="line">    </div><div class="line">        private String num;             //网站数据源编码【编号】</div><div class="line">        private String area;                //区域</div><div class="line">        private String province;        //省份</div><div class="line">        private String city;                    //城市</div><div class="line">        private String county;          //区县</div><div class="line">        private String webname;      //网站数据源名称</div><div class="line">        private String weburl;          //网址</div><div class="line">        private String infsource;       //信息来源</div><div class="line">        private String inftype;         //信息类型</div><div class="line">        private String worktype;        //行业分类</div><div class="line">        private String zbyg;                //招标预告</div><div class="line">        private String zbgg;                //招标公告</div><div class="line">        private String zsjg;                //咨审结果</div><div class="line">        private String ggbg;                //公告变更</div><div class="line">        private String zbwj;                //招标文件</div><div class="line">        private String zbdy;                //招标答疑</div><div class="line">        private String zbxx;                //中标信息</div><div class="line">        private String kzj;                 //控制价</div><div class="line">        private String lot;                 //批次</div><div class="line">        private String webtype;     //原网站信息分类</div><div class="line">        private String remark;          //备注</div><div class="line">    </div><div class="line">            public String getNum() &#123;</div><div class="line">                return num;</div><div class="line">            &#125;</div><div class="line">            public String getArea() &#123;</div><div class="line">                return area;</div><div class="line">            &#125;</div><div class="line">            public String getProvince() &#123;</div><div class="line">                return province;</div><div class="line">            &#125;</div><div class="line">            public String getCity() &#123;</div><div class="line">                return city;</div><div class="line">            &#125;</div><div class="line">            public String getCounty() &#123;</div><div class="line">                return county;</div><div class="line">            &#125;</div><div class="line">            public String getWebname() &#123;</div><div class="line">                return webname;</div><div class="line">            &#125;</div><div class="line">            public String getWeburl() &#123;</div><div class="line">                return weburl;</div><div class="line">            &#125;</div><div class="line">            public String getInfsource() &#123;</div><div class="line">                return infsource;</div><div class="line">            &#125;</div><div class="line">            public String getInftype() &#123;</div><div class="line">                return inftype;</div><div class="line">            &#125;</div><div class="line">            public String getWorktype() &#123;</div><div class="line">                return worktype;</div><div class="line">            &#125;</div><div class="line">            public String getZbyg() &#123;</div><div class="line">                return zbyg;</div><div class="line">            &#125;</div><div class="line">            public String getZbgg() &#123;</div><div class="line">                return zbgg;</div><div class="line">            &#125;</div><div class="line">            public String getZsjg() &#123;</div><div class="line">                return zsjg;</div><div class="line">            &#125;</div><div class="line">            public String getGgbg() &#123;</div><div class="line">                return ggbg;</div><div class="line">            &#125;</div><div class="line">            public String getZbwj() &#123;</div><div class="line">                return zbwj;</div><div class="line">            &#125;</div><div class="line">            public String getZbdy() &#123;</div><div class="line">                return zbdy;</div><div class="line">            &#125;</div><div class="line">            public String getZbxx() &#123;</div><div class="line">                return zbxx;</div><div class="line">            &#125;</div><div class="line">            public String getKzj() &#123;</div><div class="line">                return kzj;</div><div class="line">            &#125;</div><div class="line">            public String getLot() &#123;</div><div class="line">                return lot;</div><div class="line">            &#125;</div><div class="line">            public String getWebtype() &#123;</div><div class="line">                return webtype;</div><div class="line">            &#125;</div><div class="line">            public String getRemark() &#123;</div><div class="line">                return remark;</div><div class="line">            &#125;</div><div class="line">            public void setNum(String num) &#123;</div><div class="line">                this.num = num;</div><div class="line">            &#125;</div><div class="line">            public void setArea(String area) &#123;</div><div class="line">                this.area = area;</div><div class="line">            &#125;</div><div class="line">            public void setProvince(String province) &#123;</div><div class="line">                this.province = province;</div><div class="line">            &#125;</div><div class="line">            public void setCity(String city) &#123;</div><div class="line">                this.city = city;</div><div class="line">            &#125;</div><div class="line">            public void setCounty(String county) &#123;</div><div class="line">                this.county = county;</div><div class="line">            &#125;</div><div class="line">            public void setWebname(String webname) &#123;</div><div class="line">                this.webname = webname;</div><div class="line">            &#125;</div><div class="line">            public void setWeburl(String weburl) &#123;</div><div class="line">                this.weburl = weburl;</div><div class="line">            &#125;</div><div class="line">            public void setInfsource(String infsource) &#123;</div><div class="line">                this.infsource = infsource;</div><div class="line">            &#125;</div><div class="line">            public void setInftype(String inftype) &#123;</div><div class="line">                this.inftype = inftype;</div><div class="line">            &#125;</div><div class="line">            public void setWorktype(String worktype) &#123;</div><div class="line">                this.worktype = worktype;</div><div class="line">            &#125;</div><div class="line">            public void setZbyg(String zbyg) &#123;</div><div class="line">                this.zbyg = zbyg;</div><div class="line">            &#125;</div><div class="line">            public void setZbgg(String zbgg) &#123;</div><div class="line">                this.zbgg = zbgg;</div><div class="line">            &#125;</div><div class="line">            public void setZsjg(String zsjg) &#123;</div><div class="line">                this.zsjg = zsjg;</div><div class="line">            &#125;</div><div class="line">            public void setGgbg(String ggbg) &#123;</div><div class="line">                this.ggbg = ggbg;</div><div class="line">            &#125;</div><div class="line">            public void setZbwj(String zbwj) &#123;</div><div class="line">                this.zbwj = zbwj;</div><div class="line">            &#125;</div><div class="line">            public void setZbdy(String zbdy) &#123;</div><div class="line">                this.zbdy = zbdy;</div><div class="line">            &#125;</div><div class="line">            public void setZbxx(String zbxx) &#123;</div><div class="line">                this.zbxx = zbxx;</div><div class="line">            &#125;</div><div class="line">            public void setKzj(String kzj) &#123;</div><div class="line">                this.kzj = kzj;</div><div class="line">            &#125;</div><div class="line">            public void setLot(String lot) &#123;</div><div class="line">                this.lot = lot;</div><div class="line">            &#125;</div><div class="line">            public void setWebtype(String webtype) &#123;</div><div class="line">                this.webtype = webtype;</div><div class="line">            &#125;</div><div class="line">            public void setRemark(String remark) &#123;</div><div class="line">                this.remark = remark;</div><div class="line">            &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">**********************************************************************</div><div class="line">package main;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseDB;</div><div class="line">import Utils.UseExcel;</div><div class="line">import Utils.UseString;</div><div class="line">import extend.example.GetFirstLetter;</div><div class="line"></div><div class="line"></div><div class="line">/**更新时间：2016.12.18</div><div class="line"> *      </div><div class="line"> * 任务流程</div><div class="line"> *           @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class GoTask &#123;</div><div class="line">    </div><div class="line">    </div><div class="line"></div><div class="line">//  private String numScope=&quot;00000-05000&quot;;                                                  //编号范围区间</div><div class="line">//  private String username=&quot;某男子&quot;;                                                                  //程序员名称</div><div class="line">    private String path=&quot;C:/Users/Liu-shuwei/Desktop\\&quot;;                                             //路径</div><div class="line">    private String catalogName=&quot;入库【3.3版,823表(区分程序猿and地区)】&quot;;             //文件名</div><div class="line">    private Boolean areaMatch=false;                                                                    //是否开启区域匹配【默认不开启】</div><div class="line">    private Boolean numMatch=false;                                                                 //是否开启默认匹配【默认不开启】</div><div class="line">    private String useExcel;                                                                                    //使用项目根目录下哪个Excel</div><div class="line">    private String useTable;                                                                                    //使用哪个表的数据【SQLite的话，不存在表则自动创建】</div><div class="line">    </div><div class="line">    public void setPath(String path)&#123;</div><div class="line">        this.path=path;</div><div class="line">    &#125;</div><div class="line">    public void setCatalogName(String cn)&#123;</div><div class="line">        this.catalogName=cn;</div><div class="line">    &#125;</div><div class="line">    public void setAreaMatch(Boolean b)&#123;</div><div class="line">        this.areaMatch=b;</div><div class="line">    &#125;</div><div class="line">    public void setNumMatch(Boolean b)&#123;</div><div class="line">        this.numMatch=b;</div><div class="line">    &#125;</div><div class="line">    public void setUseExcel(String excel)&#123;</div><div class="line">        this.useExcel=excel;</div><div class="line">    &#125;</div><div class="line">    public void setUseTable(String table)&#123;</div><div class="line">        this.useTable=table;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    //任务1： 使用MySQL数据库</div><div class="line">    public void GO(String username,String numScope,String numArea) &#123;    //参数:程序猿，编号范围，地区</div><div class="line">            System.out.println(username+&quot;--------------------------------------------------&gt;Go!&quot;);</div><div class="line">        </div><div class="line">        //执行任务流程</div><div class="line">        try&#123;</div><div class="line">            </div><div class="line">            //一.获取对象</div><div class="line">            UseDB udb = new UseDB(&quot;mysql&quot;);</div><div class="line">            IOFile iof=new IOFile();</div><div class="line">            UseString us = new UseString();</div><div class="line">            </div><div class="line">            GetFirstLetter gfl = new GetFirstLetter();</div><div class="line"></div><div class="line">            GetTableData  gtd = new GetTableData(iof,udb);</div><div class="line">            AlterContent ac = new AlterContent(iof,udb,us,gtd);</div><div class="line">            </div><div class="line">            </div><div class="line">            udb.connDatabase(&quot;batchcreate_file&quot;);//连接数据库</div><div class="line">            </div><div class="line">            </div><div class="line">            //二.创建大目录,往数据库插入模版数据</div><div class="line">            iof.createCatalog(path, catalogName);</div><div class="line">            iof.createCatalog(path+&quot;/&quot;+catalogName, username);</div><div class="line">            String model1_BT =gtd.getModel(&quot;model_file/BackupTask.java&quot;);</div><div class="line">            String model2_RK =gtd.getModel(&quot;model_file/ZhaobGgServiceModel.java&quot;);</div><div class="line">            </div><div class="line">            </div><div class="line">            </div><div class="line">            //三.获取数据表数据，并生成目录and文件</div><div class="line">                //三-1获取所有编号</div><div class="line">                ArrayList&lt;String&gt; numList =gtd.getAllNum(useTable) ; </div><div class="line">                </div><div class="line">                </div><div class="line">                //三-2.遍历所有编号</div><div class="line">                for(int i=0;i&lt;numList.size();i++)&#123;</div><div class="line">                </div><div class="line">                    String num=numList.get(i);                                                      //当前编号</div><div class="line">                    String num_=numList.get(i) .replace(&quot;-&quot;,&quot;_&quot;);                           //编号下划线形态</div><div class="line">                    StringBuilder changePath =new StringBuilder(&quot;&quot;);                                            //变化路径</div><div class="line">                    </div><div class="line">                    //P1:判断是否开启编号范围匹配 and 比较当前编号是否在范围区间</div><div class="line">                    if( numMatch &amp;&amp; !gtd.getMinMaxScope(numScope, us.getInt(num.substring(0,5))))&#123;  //获取前5个数字</div><div class="line">                        continue;</div><div class="line">                    &#125;</div><div class="line">                    //P2:判断是否开启地区匹配 and 进行地区匹配</div><div class="line">                        if(areaMatch)&#123;</div><div class="line">                            String area =udb.select(useTable,&quot;area&quot;,&quot;num=&apos;&quot;+num+&quot;&apos;&quot;);</div><div class="line">                            if(!area.equals(numArea))&#123;</div><div class="line">                                continue;</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                    </div><div class="line">                        </div><div class="line">                        //a.获取当前编号的所有数据，并储存到JavaBean</div><div class="line">                        NumBean numBean =gtd.getNumInformation(useTable, num);</div><div class="line">                        </div><div class="line">                        //b.生成入库文件名，存储进ArrayList</div><div class="line">                         ArrayList&lt;String&gt; ifURLType_list =gtd.getNum_HaveURLRecord(useTable, num);             //获取当前编号所有&quot;含有URL&quot;的字段的类型【例:招标公告 zbgg】</div><div class="line">                         ArrayList&lt;String &gt; rukuName_list=new ArrayList&lt;String&gt;();                                                      //用于储存当前编号所需要的所有入库文件名</div><div class="line">                         StringBuilder rukuName=new StringBuilder(&quot;&quot;);</div><div class="line">                         for(String type:ifURLType_list)&#123;</div><div class="line">                             rukuName.append(gfl.getFirstLetter(numBean.getArea()).toUpperCase()+&quot;_&quot;+num_+&quot;_&quot;+gtd.getTypename(type));   //入库文件完整名【地区首字母(大写)_编号_类型服务名】</div><div class="line">                             rukuName_list.add(rukuName.toString());</div><div class="line">                             rukuName=rukuName.delete(0, rukuName.length());                                                                                //清空</div><div class="line">                         &#125;</div><div class="line">                         </div><div class="line">                        </div><div class="line">                        //d.生成入库子目录</div><div class="line">                        String catalog_1=&quot;入库-&quot;+num.substring(0,5);                                                                  //目录名</div><div class="line">                        changePath.insert(0,path+&quot;/&quot;+catalogName+&quot;/&quot;+username);                                     //子路径1                </div><div class="line">                        iof.createCatalog(changePath.toString(),&quot;入库-&quot;+num.substring(0,5));                          //创建入库子目录【入库-编号】</div><div class="line">                        </div><div class="line">                        </div><div class="line">                        //生成BackupTask.java</div><div class="line">                         changePath.append(&quot;/&quot;+catalog_1);                               //子路径1-2</div><div class="line">                         String sign = &quot;cover&quot;;                                                          //判断当前编号是需要修改还是覆盖【默认是覆盖，带-编号是alter,不带-是cover】</div><div class="line">                            if(i &gt; 0)&#123;                                                                           //大于0的时候进行判断   【顶部位置没有上一个编号】</div><div class="line">                                if(us.getInt(numList.get(i-1).substring(0,5)) == us.getInt(num.substring(0,5)))&#123;            </div><div class="line">                                    sign=&quot;alter&quot;;                                                            //如果和上个编号相等，则修改</div><div class="line">                                &#125;</div><div class="line">                            &#125;</div><div class="line">                            </div><div class="line">                         if(&quot;cover&quot;.equals(sign))&#123;                      //覆盖</div><div class="line">                                    ac.aBackupTask(changePath.toString(),&quot;BackupTask.java&quot;, model1_BT,sign,rukuName_list);</div><div class="line">                         &#125;else if(&quot;alter&quot;.equals(sign))&#123;                //修改</div><div class="line">                             String ageBackupTask=iof.rFileContent(changePath+&quot;/BackupTask.java&quot;,&quot;GBK&quot;);                    //读取已经已经存在的BackupTask.java</div><div class="line">                             ac.aBackupTask(changePath.toString(),&quot;BackupTask.java&quot;,ageBackupTask ,sign,rukuName_list);</div><div class="line">                         &#125;</div><div class="line">                         </div><div class="line">                        </div><div class="line">                        //e.生成入库文件</div><div class="line">                        iof.createCatalog(changePath.toString(),&quot;imp&quot;);          //生成imp目录</div><div class="line">                        changePath.append(&quot;/imp&quot;);                                       //子路径1-2-3</div><div class="line">                        for(int k=0;k&lt;ifURLType_list.size();k++)&#123;                    //根据拥有URL的类型，循环生成入库文件</div><div class="line">                            ac.aRK(changePath.toString(), rukuName_list.get(k)+&quot;.java&quot;, model2_RK,ifURLType_list.get(k),username,numBean);</div><div class="line">                        &#125;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            //四.关闭资源</div><div class="line">            udb.closeAll();</div><div class="line">            </div><div class="line">        &#125;catch(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">//***********************************************************************************************************************************</div><div class="line">    </div><div class="line">    </div><div class="line">    //任务2： 使用SQLite</div><div class="line">        public void GO_SQLite(String username,String numScope,String numArea) &#123; //参数:程序猿，编号范围，地区</div><div class="line">            System.out.println(username+&quot;--------------------------------------------------&gt;Go!&quot;);</div><div class="line">        </div><div class="line">        //执行任务流程</div><div class="line">        try&#123;</div><div class="line">            </div><div class="line">            //一.获取对象</div><div class="line">            UseDB udb = new UseDB(&quot;SQLite&quot;);</div><div class="line">            IOFile iof=new IOFile();</div><div class="line">            UseString us = new UseString();</div><div class="line">            UseExcel ue =new UseExcel();</div><div class="line">            </div><div class="line">            GetFirstLetter gfl = new GetFirstLetter();</div><div class="line"></div><div class="line">            GetTableData  gtd = new GetTableData(iof,udb);</div><div class="line">            AlterContent ac = new AlterContent(iof,udb,us,gtd);</div><div class="line">            </div><div class="line">            </div><div class="line">            udb.connDatabase(&quot;batchcreate_file.db&quot;);                        //连接数据库【若不存在则创建】</div><div class="line">//          gtd.s_CreateTable(useTable);                                            //创建表【article-保存模版,(useTable)-Excel工作薄数据】</div><div class="line">//          gtd.s_InsertExcel(useExcel,useTable);                                //插入Excel数据,【传入excel文件名和使用表名】</div><div class="line">            </div><div class="line">            //二.创建大目录,往数据库插入模版数据</div><div class="line">            iof.createCatalog(path, catalogName);</div><div class="line">            iof.createCatalog(path+&quot;/&quot;+catalogName, username);</div><div class="line">            String model1_BT =gtd.getModel(&quot;model_file/BackupTask.java&quot;);</div><div class="line">            String model2_RK =gtd.getModel(&quot;model_file/ZhaobGgServiceModel.java&quot;);</div><div class="line">            </div><div class="line">            </div><div class="line">            </div><div class="line">            //三.获取数据表数据，并生成目录and文件</div><div class="line">                //三-1获取所有编号</div><div class="line">                ArrayList&lt;String&gt; numList =gtd.getAllNum(useTable) ; </div><div class="line">                </div><div class="line">                </div><div class="line">                //三-2.遍历所有编号</div><div class="line">                for(int i=0;i&lt;numList.size();i++)&#123;</div><div class="line">                </div><div class="line">                    String num=numList.get(i);                                                      //当前编号</div><div class="line">                    String num_=numList.get(i) .replace(&quot;-&quot;,&quot;_&quot;);                           //编号下划线形态</div><div class="line">                    StringBuilder changePath =new StringBuilder(&quot;&quot;);                                            //变化路径</div><div class="line">                    </div><div class="line">                    //P1:判断是否开启编号范围匹配 and 比较当前编号是否在范围区间</div><div class="line">                    if( numMatch &amp;&amp; !gtd.getMinMaxScope(numScope, us.getInt(num.substring(0,5))))&#123;  //获取前5个数字</div><div class="line">                        continue;</div><div class="line">                    &#125;</div><div class="line">                    //P2:判断是否开启地区匹配 and 进行地区匹配</div><div class="line">                        if(areaMatch)&#123;</div><div class="line">                            String area =udb.select(useTable,&quot;area&quot;,&quot;num=&apos;&quot;+num+&quot;&apos;&quot;);</div><div class="line">                            if(!area.equals(numArea))&#123;</div><div class="line">                                continue;</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                    </div><div class="line">                        </div><div class="line">                        //a.获取当前编号的所有数据，并储存到JavaBean</div><div class="line">                        NumBean numBean =gtd.getNumInformation(useTable, num);</div><div class="line">                        </div><div class="line">                        //b.生成入库文件名，存储进ArrayList</div><div class="line">                         ArrayList&lt;String&gt; ifURLType_list =gtd.getNum_HaveURLRecord(useTable, num);             //获取当前编号所有&quot;含有URL&quot;的字段的类型【例:招标公告 zbgg】</div><div class="line">                         ArrayList&lt;String &gt; rukuName_list=new ArrayList&lt;String&gt;();                                                      //用于储存当前编号所需要的所有入库文件名</div><div class="line">                         StringBuilder rukuName=new StringBuilder(&quot;&quot;);</div><div class="line">                         for(String type:ifURLType_list)&#123;</div><div class="line">                             rukuName.append(gfl.getFirstLetter(numBean.getArea()).toUpperCase()+&quot;_&quot;+num_+&quot;_&quot;+gtd.getTypename(type));   //入库文件完整名【地区首字母(大写)_编号_类型服务名】</div><div class="line">                             rukuName_list.add(rukuName.toString());</div><div class="line">                             rukuName=rukuName.delete(0, rukuName.length());                                                                                //清空</div><div class="line">                         &#125;</div><div class="line">                         </div><div class="line">                        </div><div class="line">                        //d.生成入库子目录</div><div class="line">                        String catalog_1=&quot;入库-&quot;+num.substring(0,5);                                                                  //目录名</div><div class="line">                        changePath.insert(0,path+&quot;/&quot;+catalogName+&quot;/&quot;+username);                                     //子路径1                </div><div class="line">                        iof.createCatalog(changePath.toString(),&quot;入库-&quot;+num.substring(0,5));                          //创建入库子目录【入库-编号】</div><div class="line">                        </div><div class="line">                        </div><div class="line">                        //生成BackupTask.java</div><div class="line">                         changePath.append(&quot;/&quot;+catalog_1);                               //子路径1-2</div><div class="line">                         String sign = &quot;cover&quot;;                                                          //判断当前编号是需要修改还是覆盖【默认是覆盖，带-编号是alter,不带-是cover】</div><div class="line">                            if(i &gt; 0)&#123;                                                                           //大于0的时候进行判断   【顶部位置没有上一个编号】</div><div class="line">                                if(us.getInt(numList.get(i-1).substring(0,5)) == us.getInt(num.substring(0,5)))&#123;            </div><div class="line">                                    sign=&quot;alter&quot;;                                                            //如果和上个编号相等，则修改</div><div class="line">                                &#125;</div><div class="line">                            &#125;</div><div class="line">                            </div><div class="line">                         if(&quot;cover&quot;.equals(sign))&#123;                      //覆盖</div><div class="line">                                    ac.aBackupTask(changePath.toString(),&quot;BackupTask.java&quot;, model1_BT,sign,rukuName_list);</div><div class="line">                         &#125;else if(&quot;alter&quot;.equals(sign))&#123;                //修改</div><div class="line">                             String ageBackupTask=iof.rFileContent(changePath+&quot;/BackupTask.java&quot;,&quot;UTF-8&quot;);                  //读取已经已经存在的BackupTask.java</div><div class="line">                             ac.aBackupTask(changePath.toString(),&quot;BackupTask.java&quot;,ageBackupTask ,sign,rukuName_list);</div><div class="line">                         &#125;</div><div class="line">                         </div><div class="line">                        </div><div class="line">                        //e.生成入库文件</div><div class="line">                        iof.createCatalog(changePath.toString(),&quot;imp&quot;);          //生成imp目录</div><div class="line">                        changePath.append(&quot;/imp&quot;);                                       //子路径1-2-3</div><div class="line">                        for(int k=0;k&lt;ifURLType_list.size();k++)&#123;                    //根据拥有URL的类型，循环生成入库文件</div><div class="line">                            ac.aRK(changePath.toString(), rukuName_list.get(k)+&quot;.java&quot;, model2_RK,ifURLType_list.get(k),username,numBean);</div><div class="line">                        &#125;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            //四.关闭资源</div><div class="line">            udb.closeAll();</div><div class="line">            </div><div class="line">        &#125;catch(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">**********************************************************************</div><div class="line"></div><div class="line">package main;</div><div class="line"></div><div class="line">public class test &#123;</div><div class="line">    </div><div class="line"></div><div class="line">    //测试主方法</div><div class="line">    public static void main(String [] args)&#123;</div><div class="line">        long begin=System.currentTimeMillis();</div><div class="line">        </div><div class="line">        //创建任务流程对象</div><div class="line">        GoTask gt= new GoTask();</div><div class="line">            gt.setPath(&quot;C:/Users/Liu-shuwei/Desktop\\&quot;);</div><div class="line">            gt.setCatalogName(&quot;入库【4.0版,823表(完全版-未筛选)】&quot;);</div><div class="line">            gt.setNumMatch(false);      //是否开启编号范围匹配</div><div class="line">            gt.setAreaMatch(false);     //是否开启地区匹配</div><div class="line">        </div><div class="line">        //方式1：使用本地MySQL******************************************************************************************</div><div class="line">        //执行流程(参数:程序猿,编号范围,地区)</div><div class="line">        gt.setUseTable(&quot;webapi3&quot;);  </div><div class="line">        gt.GO(&quot;陈宇&quot;,&quot;02065-02145&quot;,&quot;华中&quot;);</div><div class="line">        gt.GO(&quot;刘聪&quot;,&quot;02396-02461&quot;,&quot;华北&quot;);</div><div class="line">        gt.GO(&quot;房文迪&quot;,&quot;01311-02769&quot;,&quot;华东&quot;);</div><div class="line">//      gt.GO(&quot;林佳法&quot;,&quot;02311-02371&quot;,);</div><div class="line">        gt.GO(&quot;严加远&quot;,&quot;02770-02781&quot;,&quot;华东&quot;);</div><div class="line">        gt.GO(&quot;吴健俊&quot;,&quot;01281-01596&quot;,&quot;西南&quot;);</div><div class="line">        gt.GO(&quot;周盛&quot;,&quot;01597-03456&quot;,&quot;西南&quot;);</div><div class="line">        gt.GO(&quot;占文冲&quot;,&quot;01552-03100&quot;,&quot;西北&quot;);</div><div class="line"></div><div class="line"></div><div class="line">        //方式2：使用SQLite******************************************************************************************************************************</div><div class="line">//      gt.setUseTable(&quot;api&quot;);          //使用表名【SQLite的若不存在会自动创建】</div><div class="line">//      gt.setUseExcel(&quot;8.23.xls&quot;);             //使用哪个Excel【项目根目录/Excel/】</div><div class="line">//      gt.GO_SQLite(&quot;陈宇&quot;,&quot;02065-02145&quot;,&quot;华中&quot;);</div><div class="line">//      gt.GO_SQLite(&quot;刘聪&quot;,&quot;02396-02461&quot;,&quot;华北&quot;);</div><div class="line">//      gt.GO_SQLite(&quot;房文迪&quot;,&quot;01311-02769&quot;,&quot;华东&quot;);</div><div class="line">//      gt.GO_SQLite(&quot;严加远&quot;,&quot;02770-02781&quot;,&quot;华东&quot;);</div><div class="line">//      gt.GO_SQLite(&quot;吴健俊&quot;,&quot;01281-01596&quot;,&quot;西南&quot;);</div><div class="line">//      gt.GO_SQLite(&quot;周盛&quot;,&quot;01597-03456&quot;,&quot;西南&quot;);</div><div class="line">//      gt.GO_SQLite(&quot;占文冲&quot;,&quot;01552-03100&quot;,&quot;西北&quot;);</div><div class="line">        </div><div class="line">        </div><div class="line">        System.out.println(&quot;共花费:&quot;+(double)(System.currentTimeMillis()-begin)/1000+&quot;秒&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<p><br><br></p>
<h3 id="UI包"><a href="#UI包" class="headerlink" title="UI包"></a>UI包</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * </div><div class="line"> */</div><div class="line">package UI;</div><div class="line"></div><div class="line">import java.awt.event.ActionEvent;</div><div class="line">import java.awt.event.ActionListener;</div><div class="line"></div><div class="line">import javax.swing.JButton;</div><div class="line">import javax.swing.JFrame;</div><div class="line">import javax.swing.JOptionPane;</div><div class="line">import javax.swing.JScrollPane;</div><div class="line">import javax.swing.JTextArea;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line"></div><div class="line">/**最后更新：2016.12.18</div><div class="line"> *      修改模版界面</div><div class="line"> * </div><div class="line"> * @author Suvan</div><div class="line"> */</div><div class="line">public class alterModelUI extends JFrame&#123;</div><div class="line">    </div><div class="line">    private JTextArea fileContent;          //多行文本</div><div class="line">    private JScrollPane scrollPane;         //滚动条</div><div class="line">    private JButton saveAlter;              //保存修改按钮</div><div class="line">    </div><div class="line">    //有参构造函数,初始化JFrame,切传入要读取的文件名</div><div class="line">    public alterModelUI(String fileName)&#123;</div><div class="line">        super();</div><div class="line">        this.getContentPane().setLayout(null);//设置容器，并且不设置布局</div><div class="line">        this.setSize(610,500);</div><div class="line">        this.setLocation(0, 300);</div><div class="line">        </div><div class="line">        load(fileName);         //加载界面</div><div class="line">        readFile(fileName); //读取文件,且显示到JTextArea</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法1：加载界面</div><div class="line">    private void load(String fileName)&#123;</div><div class="line">        </div><div class="line">        //1-赋值，构建对象</div><div class="line">        if(fileContent == null)&#123;</div><div class="line">            fileContent = new JTextArea();</div><div class="line">            fileContent.setBounds(0,0,605,400);</div><div class="line">            </div><div class="line">        &#125;if(scrollPane == null)&#123;</div><div class="line">            scrollPane = new JScrollPane(fileContent);</div><div class="line">            scrollPane.setBounds(0,0,605,400);</div><div class="line">        &#125;</div><div class="line">        if(saveAlter == null)&#123;</div><div class="line">            saveAlter = new JButton(&quot;保存修改&quot;);</div><div class="line">            saveAlter.setBounds(220,403,150,50);</div><div class="line">            </div><div class="line">            //A.【保存修改】注册按钮点击事件且添加监听</div><div class="line">            saveAlter.addActionListener(new ActionListener()&#123;</div><div class="line">                public void actionPerformed(ActionEvent e)&#123;</div><div class="line">                    try&#123;</div><div class="line">                        IOFile iof = new IOFile();</div><div class="line"></div><div class="line">                        iof.cFile(&quot;model_file&quot;, fileName, &quot;UTF-8&quot;,fileContent.getText());           //新建文件</div><div class="line">                        </div><div class="line">                        JOptionPane.showMessageDialog(null, &quot;保存成功&quot;, &quot;success&quot;,JOptionPane.WARNING_MESSAGE);  //弹出提示对话框</div><div class="line">                        </div><div class="line">                    &#125;catch(Exception k)&#123;</div><div class="line">                        JOptionPane.showMessageDialog(null, &quot;保存失败,出现异常&quot;, &quot;fail&quot;,JOptionPane.WARNING_MESSAGE);  </div><div class="line">                        k.printStackTrace();</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">            </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        this.add(scrollPane);</div><div class="line">        this.add(saveAlter);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法2：读取文件</div><div class="line">    private void readFile(String fileName)&#123;</div><div class="line">        try&#123;</div><div class="line">            IOFile iof = new IOFile();</div><div class="line">            String content = iof.rFileContent(&quot;model_file/&quot;+fileName, &quot;utf-8&quot;);</div><div class="line">            this.fileContent.setText(content);</div><div class="line">        &#125;catch(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">**********************************************************************</div><div class="line"></div><div class="line">/**</div><div class="line"> * </div><div class="line"> */</div><div class="line">package UI;</div><div class="line"></div><div class="line">import java.awt.event.ActionEvent;</div><div class="line">import java.awt.event.ActionListener;</div><div class="line">import java.io.File;</div><div class="line"></div><div class="line">import javax.swing.JButton;</div><div class="line">import javax.swing.JFileChooser;</div><div class="line">import javax.swing.JFrame;</div><div class="line">import javax.swing.JLabel;</div><div class="line">import javax.swing.JOptionPane;</div><div class="line">import javax.swing.JTextField;</div><div class="line">import javax.swing.filechooser.FileNameExtensionFilter;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseDB;</div><div class="line">import main.GetTableData;</div><div class="line"></div><div class="line">/**最后更新：2016.12.18</div><div class="line"> *      导入excel数据页面</div><div class="line"> * </div><div class="line"> * @author Suvan</div><div class="line"> */</div><div class="line">public class insertUI extends JFrame implements ActionListener&#123;</div><div class="line">    </div><div class="line">    private JTextField excelFilePath;       //excel表格的文件路径</div><div class="line">    private JButton fileChoice;             //文件选择</div><div class="line">    private JButton beginInsert;            //开始导入</div><div class="line">    </div><div class="line">    //无参构造函数</div><div class="line">    public insertUI()&#123;</div><div class="line">        super();</div><div class="line">        this.getContentPane().setLayout(null);  //获取Container容器,装载JFrame窗体,且设置空布局</div><div class="line">        this.setTitle(&quot;导入excel表数据&quot;);                //标题</div><div class="line">        this.setSize(300,200);                              //面积</div><div class="line">        this.setLocation(610, 0);                           //位置</div><div class="line">        </div><div class="line">        this.load();    //加载界面</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法1: 加载界面</div><div class="line">    private void load()&#123;</div><div class="line">        </div><div class="line">        //1.构建组件    </div><div class="line">        JLabel lb_excelFilePath = new JLabel(&quot;excel文件路径:&quot;);</div><div class="line">        lb_excelFilePath.setBounds(20,30,100,25);           //设置x,y【屏幕坐标】,width,height【组件宽高】</div><div class="line">        </div><div class="line">        if(excelFilePath == null)&#123;</div><div class="line">            excelFilePath = new JTextField();               </div><div class="line">            excelFilePath.setBounds(20, 60, 220, 25);   </div><div class="line">        &#125;</div><div class="line">        if(fileChoice == null)&#123;</div><div class="line">            fileChoice = new JButton(&quot;...&quot;);</div><div class="line">            fileChoice.setBounds(240,60,25,25);</div><div class="line">            </div><div class="line">            fileChoice.addActionListener(this);                 //注册按钮监听事件</div><div class="line">        &#125;</div><div class="line">        if(beginInsert == null)&#123;</div><div class="line">            beginInsert = new JButton(&quot;开始导入&quot;);</div><div class="line">            beginInsert.setBounds(100,100,90,35);</div><div class="line">            </div><div class="line">            beginInsert.addActionListener(this);                //注册按钮监听事件</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //2.为窗体添加组件</div><div class="line">        this.add(lb_excelFilePath);         this.add(excelFilePath);</div><div class="line">        this.add(fileChoice);</div><div class="line">        this.add(beginInsert);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    //方法2.按钮点击事件</div><div class="line">    public void actionPerformed(ActionEvent e)&#123;</div><div class="line">        </div><div class="line">        if(&quot;...&quot;.equals(e.getActionCommand()))&#123;</div><div class="line">            //A.构建文件选择器</div><div class="line">             JFileChooser fc = new JFileChooser(); </div><div class="line">             fc.setFileSelectionMode(JFileChooser.FILES_ONLY);//设置只能选择文件</div><div class="line">             fc.setFileFilter(new FileNameExtensionFilter(&quot;只支持Excel97-2003 工作簿(*.xls)&quot;,&quot;xls&quot;));     //【&quot;提示信息&quot;,&quot;支持类型&quot;】-文件过滤器</div><div class="line">             </div><div class="line">             int result = fc.showOpenDialog(this);                  //弹出打开文件对话框</div><div class="line">//           int resut =fc.showSaveDialog(this);                        //弹出&quot;保存文件&quot;对话框</div><div class="line">              if( result == JFileChooser.APPROVE_OPTION)&#123;   //表示获得选中对象</div><div class="line">                  File f = fc.getSelectedFile();</div><div class="line">                 excelFilePath.setText(fc.getSelectedFile().getPath()); //  获得文件路径设置到JTestField</div><div class="line">              &#125;</div><div class="line">              </div><div class="line">        &#125;else if(&quot;开始导入&quot;.equals(e.getActionCommand()))&#123;</div><div class="line">            if(excelFilePath.getText().length()&gt;2)&#123;</div><div class="line">                try&#123;</div><div class="line">                    UseDB udb = new UseDB(&quot;SQLite&quot;);</div><div class="line">                    IOFile iof = new IOFile();</div><div class="line">                    GetTableData  gtd = new GetTableData(iof,udb);</div><div class="line">                    </div><div class="line">                    udb.connDatabase(&quot;batchcreate_file.db&quot;);                        //连接数据库【若不存在则创建】    </div><div class="line">                    gtd.s_InsertExcel(excelFilePath.getText());                              //导入Excel数据,【传入excel文件名和使用表名】</div><div class="line"></div><div class="line">                    JOptionPane.showMessageDialog(null, &quot;导入成功！&quot;, &quot;success&quot;,JOptionPane.PLAIN_MESSAGE);                                                  //提示信息</div><div class="line">                &#125;catch(Exception k)&#123;</div><div class="line">                    JOptionPane.showMessageDialog(null, &quot;抱歉,导入失败,出现异常！&quot;, &quot;fail&quot;,JOptionPane.ERROR_MESSAGE);                                 //错误信息</div><div class="line">                    k.printStackTrace();</div><div class="line">                &#125;</div><div class="line">            &#125;else&#123;</div><div class="line">                JOptionPane.showMessageDialog(null, &quot;大兄弟,请选择目录or手动填写目录！&quot;, &quot;success&quot;,JOptionPane.WARNING_MESSAGE);   //警告信息</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        insertUI i = new insertUI();</div><div class="line">        i.setVisible(true);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">**********************************************************************</div><div class="line">package UI;</div><div class="line"></div><div class="line">import java.awt.Color;</div><div class="line">import java.awt.Graphics;</div><div class="line">import java.awt.event.ActionEvent;</div><div class="line">import java.awt.event.ActionListener;</div><div class="line"></div><div class="line">import javax.swing.JButton;</div><div class="line">import javax.swing.JCheckBox;</div><div class="line">import javax.swing.JComboBox;</div><div class="line">import javax.swing.JFrame;</div><div class="line">import javax.swing.JLabel;</div><div class="line">import javax.swing.JOptionPane;</div><div class="line">import javax.swing.JPanel;</div><div class="line">import javax.swing.JTextField;</div><div class="line"></div><div class="line">import Utils.IOFile;</div><div class="line">import Utils.UseDB;</div><div class="line">import main.GoTask;</div><div class="line"></div><div class="line">/**最后更新:2016.12.18</div><div class="line"> *      主界面     </div><div class="line"> * </div><div class="line"> *@author Suvan</div><div class="line"> */</div><div class="line">public class mainUI  extends JFrame implements ActionListener&#123;</div><div class="line">        </div><div class="line">    private  JComboBox&lt;String&gt; db_table;                //选择数据表 -组合框</div><div class="line">    private JButton db_insertTable;                         //&quot;导入数据&quot;-按钮</div><div class="line">    private JButton model_alterB;                               //&quot;修改模版2&quot;-按钮 【BackTaskup.java】</div><div class="line">    private JButton model_alterZ;                               //&quot;修改模版2&quot;-按钮【ZhaoGgServiceModel.java】</div><div class="line">    </div><div class="line">    private JButton go;                                             //&quot;开始&quot;-按钮</div><div class="line">    </div><div class="line">    private JLabel model1;                                          //BackTaskup.java模版</div><div class="line">    private JLabel model2;                                          //ZhaoGgServiceModel.java模版</div><div class="line">    private JTextField path;                                        //目录路径</div><div class="line">    private JTextField catologName;                         //目录名</div><div class="line">    private JTextField userName;                                //程序猿</div><div class="line">    private JTextField beginNum;                                //开始编号</div><div class="line">    private JTextField endNum;                                  //结束编号</div><div class="line">    private JTextField area;                                            //地区</div><div class="line">    </div><div class="line">    private JCheckBox match_num;                            //是否开启编号范围匹配</div><div class="line">    private JCheckBox match_area;                           //是否开启地区匹配</div><div class="line">    </div><div class="line"></div><div class="line">    </div><div class="line">    //无参构造函数  </div><div class="line">    public mainUI()&#123;</div><div class="line">        super();</div><div class="line">        this.getContentPane().setLayout(null);  //获取Container容器,装载JFrame窗体,且设置空布局</div><div class="line">        this.setTitle(&quot;BatchCreate 4.0&quot;);               //设置标题</div><div class="line">        this.setSize(610,300);                              //设置宽,高</div><div class="line">        </div><div class="line">        this.getLeft();                                             //界面左模块</div><div class="line">        this.getRight();                                            //界面右模块</div><div class="line">    </div><div class="line">        this.ageRecord(&quot;read&quot;);                         //读取填写记录</div><div class="line">        </div><div class="line">        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);                //关闭窗口即退出程序</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法1：界面左模块</div><div class="line">    private void  getLeft()&#123;</div><div class="line">        </div><div class="line">        //1.构建组件</div><div class="line">        model1 = new JLabel(&quot;BackTask.java&quot;);                               //标签</div><div class="line">        model1.setBounds(5,100,150,25);</div><div class="line">        model2 = new JLabel(&quot;ZhaoGgServiceModel.java&quot;);         //标签</div><div class="line">        model2.setBounds(5,180,150,25);</div><div class="line">        </div><div class="line">        if(db_table ==null)&#123;        </div><div class="line">            db_table = new JComboBox&lt;String&gt;();                         //组合框</div><div class="line">            db_table.setBounds(5,20,150,25);//x,y【坐标】,width,height【宽,高】</div><div class="line"></div><div class="line">                try&#123;</div><div class="line">                    UseDB udb =new UseDB(&quot;SQLite&quot;);</div><div class="line">                    udb.connDatabase(&quot;batchcreate_file.db&quot;);    </div><div class="line">                    String [] table=udb.selectSQL(&quot;SELECT name FROM SQLITE_MASTER WHERE type=&apos;table&apos;ORDER BY name&quot;).split(&quot;&amp;&amp;&quot;);</div><div class="line">                    for(int i=0;i&lt;table.length;i++)&#123;</div><div class="line">                        if(&quot;article&quot;.equals(table[i]))  continue;       //去除article表【模版表】</div><div class="line">                        db_table.addItem(table[i]);</div><div class="line">                    &#125;</div><div class="line">                    </div><div class="line">                    udb.closeAll();</div><div class="line">                &#125;catch(Exception e)&#123;</div><div class="line">                    e.printStackTrace();</div><div class="line">                &#125;</div><div class="line">        &#125;</div><div class="line">        if(db_insertTable == null)&#123;                                 </div><div class="line">            db_insertTable = new JButton(&quot;导入数据&quot;);                   //按钮</div><div class="line">            db_insertTable.setBounds(175,20,100,25);                        //设置x,y【屏幕坐标】,width,height【组件宽高】</div><div class="line">            </div><div class="line">            db_insertTable.addActionListener(this);                         //注册按钮点击事件</div><div class="line">        &#125;</div><div class="line">        if(model_alterB == null)&#123;                                           </div><div class="line">            model_alterB = new JButton(&quot;修改模版1&quot;);                        //按钮</div><div class="line">            model_alterB.setBounds(175,100,100,25);</div><div class="line">            </div><div class="line">            model_alterB.addActionListener(this);                       </div><div class="line">        &#125;</div><div class="line">        if(model_alterZ == null)&#123;</div><div class="line">            model_alterZ = new JButton(&quot;修改模版2&quot;);                        //按钮</div><div class="line">            model_alterZ.setBounds(175,180,100,25);</div><div class="line">            </div><div class="line">            model_alterZ.addActionListener(this);                           </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        JPanel panel_1 = new JPanel()&#123;                                          //画垂直分割线【分隔左右模块】</div><div class="line">            public void paint(Graphics g)&#123;</div><div class="line">                super.paint(g);</div><div class="line">                g.setColor(Color.GRAY);</div><div class="line">                 g.drawLine(0,0,0,300); //(x,y)点到(x,y)点</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        panel_1.setBounds(280, 0, 1, 300);</div><div class="line">        </div><div class="line">        </div><div class="line">        //2.添加组件</div><div class="line">        this.add(panel_1);</div><div class="line">        this.add(db_table)  ;       this.add(db_insertTable);</div><div class="line">        this.add(model1);           this.add(model_alterB);</div><div class="line">        this.add(model2);           this.add(model_alterZ);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法2:界面右模块</div><div class="line">    private void getRight()&#123;</div><div class="line">        </div><div class="line">        //1.构建组件</div><div class="line">        JLabel lb_path = new JLabel(&quot;目录路径&quot;);                                        //标签</div><div class="line">        JLabel lb_catologName = new JLabel(&quot;目录名&quot;);                          //标签</div><div class="line">        JLabel lb_userName = new JLabel(&quot;程序猿&quot;);                                 //标签</div><div class="line">        JLabel lb_beginNum = new JLabel(&quot;开始编号    ----&quot;);                    //标签</div><div class="line">        JLabel lb_endNum = new JLabel(&quot;终止编号&quot;);                              //标签</div><div class="line">        JLabel lb_area = new JLabel(&quot;地区&quot;);                                              //标签</div><div class="line">        </div><div class="line">        lb_path.setBounds(290,20,60,25);                        //设置x,y【屏幕坐标】,width,height【组件宽高】                                </div><div class="line">        lb_catologName.setBounds(290,50,55,25);</div><div class="line">        lb_userName.setBounds(285,100,55,25);</div><div class="line">        lb_beginNum.setBounds(285,145,90,25);</div><div class="line">        lb_endNum.setBounds(380,145,55,25);</div><div class="line">        lb_area.setBounds(285,220,55,25);</div><div class="line">        </div><div class="line">        if(path == null)&#123;</div><div class="line">            path  = new JTextField();                                   //单行文本</div><div class="line">            path.setBounds(350,20,220,25);</div><div class="line">        &#125;</div><div class="line">        if(catologName == null)&#123;</div><div class="line">            catologName = new JTextField();                  //单行文本</div><div class="line">            catologName.setBounds(350,50,220,25);</div><div class="line">        &#125;</div><div class="line">        if(userName == null)&#123;</div><div class="line">            userName = new JTextField();                            //单行文本</div><div class="line">            userName.setBounds(330,100,100,25);</div><div class="line">        &#125;</div><div class="line">        if(beginNum == null)&#123;</div><div class="line">            beginNum = new JTextField();                            //单行文本</div><div class="line">            beginNum.setBounds(285,175,50,25);</div><div class="line">        &#125;</div><div class="line">        if(endNum == null)&#123;</div><div class="line">            endNum = new JTextField();                          //单行文本</div><div class="line">            endNum.setBounds(380,175,50,25);</div><div class="line">        &#125;</div><div class="line">        if(area == null)&#123;</div><div class="line">            area = new JTextField();                                    //单行文本</div><div class="line">            area.setBounds(330,220,100,25);;</div><div class="line">        &#125;</div><div class="line">        if(match_num == null)&#123;</div><div class="line">            match_num = new JCheckBox(&quot;是否开启编号范围匹配&quot;);         //复选按钮</div><div class="line">            match_num.setBounds(440,110,200,25);</div><div class="line">        &#125;</div><div class="line">        if(match_area == null)&#123;</div><div class="line">            match_area = new JCheckBox(&quot;是否开启区域匹配&quot;);             //复选按钮</div><div class="line">            match_area.setBounds(440,140,150,25);</div><div class="line">        &#125;</div><div class="line">        if(go == null)&#123;</div><div class="line">            go = new JButton(&quot;开始&quot;);                                      //按钮</div><div class="line">            go.setBounds(440,190,145,50);</div><div class="line">            </div><div class="line">            go.addActionListener(this);                                     //注册按钮点击事件</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        JPanel panel_1 = new JPanel()&#123;                                  //画水平分割线【分隔右模块的上下】</div><div class="line">            public void paint(Graphics g)&#123;</div><div class="line">                super.paint(g);</div><div class="line">                g.setColor(Color.GRAY);</div><div class="line">                 g.drawLine(0,0,300,0); //(x,y)点到(x,y)点</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        panel_1.setBounds(280, 90, 320, 1);</div><div class="line">        </div><div class="line">        JPanel panel_2 = new JPanel()&#123;                                //画水垂直割线【分隔右模块的下部分的左右】</div><div class="line">            public void paint(Graphics g)&#123;</div><div class="line">                super.paint(g);</div><div class="line">                g.setColor(Color.GRAY);</div><div class="line">                 g.drawLine(0,0,0,300); //(x,y)点到(x,y)点</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        panel_2.setBounds(435, 90, 1, 300);</div><div class="line">        </div><div class="line">        </div><div class="line">        //2.添加组件</div><div class="line">        this.add(panel_1);</div><div class="line">        this.add(panel_2);</div><div class="line">        this.add(lb_path);                      this.add(path);</div><div class="line">        this.add(lb_catologName);       this.add(catologName);</div><div class="line">        this.add(lb_userName);          this.add(userName);</div><div class="line">        this.add(lb_beginNum);          this.add(beginNum);</div><div class="line">        this.add(lb_endNum);                this.add(endNum);</div><div class="line">        this.add(lb_area);                      this.add(area);</div><div class="line">        this.add(match_num);</div><div class="line">        this.add(match_area);</div><div class="line">        this.add(go);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line"></div><div class="line">    //方法3.读取上次记录</div><div class="line">    public void ageRecord(String state)&#123;    //参数:状态</div><div class="line">        </div><div class="line">            IOFile iof = new IOFile();</div><div class="line">        try&#123;</div><div class="line">            </div><div class="line">            if(&quot;read&quot;.equals(state))&#123;               //处理读取状态</div><div class="line">                </div><div class="line">                //A-读取文件内容,转成utf-8格式</div><div class="line">                String content=iof.rFileContent(&quot;Data/record.suvan&quot;, &quot;UTF-8&quot;);          </div><div class="line">                </div><div class="line">                //B-处理数据,得到数组</div><div class="line">                String [] result =content.split(&quot;\n&quot;);  //以换行符作为分隔符,每一行为1个数组元素</div><div class="line">                for(int i=0;i&lt;result.length;i++)&#123;</div><div class="line">                    result[i]=result[i].substring(result[i].indexOf(&quot;&lt;[&quot;)+2, result[i].lastIndexOf(&quot;]&gt;&quot;));  //</div><div class="line">                &#125;</div><div class="line">                </div><div class="line">                //C-将数据设置到相应组件</div><div class="line">                path.setText(result[0]);</div><div class="line">                catologName.setText(result[1]);</div><div class="line">                userName.setText(result[2]);</div><div class="line">                beginNum.setText(result[3]);</div><div class="line">                endNum.setText(result[4]);</div><div class="line">                area.setText(result[5]);</div><div class="line">                </div><div class="line">            &#125;else if(&quot;save&quot;.equals(state))&#123; //处理保存状态</div><div class="line">                </div><div class="line">                //点击开始即保存数据到record.suvan文件</div><div class="line">                StringBuilder sb =new StringBuilder();</div><div class="line">                sb.append(&quot;path:&lt;[&quot;+path.getText()+&quot;]&gt;\n&quot;);</div><div class="line">                sb.append(&quot;catologName:&lt;[&quot;+catologName.getText()+&quot;]&gt;\n&quot;);</div><div class="line">                sb.append(&quot;userName:&lt;[&quot;+userName.getText()+&quot;]&gt;\n&quot;);</div><div class="line">                sb.append(&quot;beginNum:&lt;[&quot;+beginNum.getText()+&quot;]&gt;\n&quot;);</div><div class="line">                sb.append(&quot;endNum:&lt;[&quot;+endNum.getText()+&quot;]&gt;\n&quot;);</div><div class="line">                sb.append(&quot;area:&lt;[&quot;+area.getText()+&quot;]&gt;\n&quot;);</div><div class="line">                </div><div class="line">                iof.cFile(&quot;Data&quot;, &quot;record.suvan&quot;, &quot;UTF-8&quot;,sb.toString());</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            </div><div class="line">        &#125;catch(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法4:事件点击</div><div class="line">    public void actionPerformed(ActionEvent e)&#123;</div><div class="line">        </div><div class="line">        if(&quot;导入数据&quot;.equals(e.getActionCommand()))&#123;</div><div class="line">            insertUI i = new insertUI();</div><div class="line">            i.setVisible(true);</div><div class="line">            </div><div class="line">        &#125;else if(&quot;修改模版1&quot;.equals(e.getActionCommand()))&#123;</div><div class="line">                //A1-BackupTask模版界面</div><div class="line">                alterModelUI a1 = new alterModelUI(&quot;BackupTask.java&quot;);//加载界面,且传入要读取的文件名</div><div class="line">                    a1.setTitle(&quot;BackTask.java模版&quot;);</div><div class="line">                    a1.setVisible(true);</div><div class="line">                </div><div class="line">                //A2-BackupTask语法修改界面</div><div class="line">//              alterModelUI a2 =new alterModelUI(&quot;BackupTask.txt&quot;);</div><div class="line">//                  a2.setLocation(a1.getX()+a1.getWidth(), a1.getY()); //基于a1的坐标进行设定</div><div class="line">//                  a2.setTitle(&quot;语义修改&quot;);</div><div class="line">//                  a2.setVisible(true);</div><div class="line">                </div><div class="line">        &#125;else if(&quot;修改模版2&quot;.equals(e.getActionCommand()))&#123;</div><div class="line">                //B1-ZhaobGgServiceModel模版界面</div><div class="line">                alterModelUI b1 = new alterModelUI(&quot;ZhaobGgServiceModel.java&quot;);</div><div class="line">                    b1.setTitle(&quot;ZhaoGgServiceModel.java模版&quot;);</div><div class="line">                    b1.setVisible(true);</div><div class="line">                </div><div class="line">                //B2-ZhaobGgServiceModel语法修改界面</div><div class="line">//              alterModelUI b2 = new alterModelUI(&quot;ZhaobGgServiceModel.txt&quot;);</div><div class="line">//                  b2.setTitle(&quot;语义修改&quot;);;</div><div class="line">//                  b2.setLocation(b1.getX()+b1.getWidth(), b1.getY()); //基于a1的坐标进行设定</div><div class="line">//                  b2.setVisible(true);</div><div class="line">            </div><div class="line">        &#125;else if(&quot;开始&quot;.equals(e.getActionCommand()))&#123;</div><div class="line">            //1.保存数据</div><div class="line">            this.ageRecord(&quot;save&quot;);</div><div class="line">            </div><div class="line">            //2.复选框判断</div><div class="line">            boolean numSign =true;  //开启了编号范围匹配,则必须填写开始和结束编号</div><div class="line">            boolean areaSign = true;//开启了地区匹配,则必须填写地区</div><div class="line">            if(match_num.isSelected())&#123;</div><div class="line">                if(beginNum.getText().length()&lt;1 || endNum.getText().length()&lt;1)&#123;</div><div class="line">                    numSign = false;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            if(match_area.isSelected())&#123;</div><div class="line">                if(area.getText().length()&lt;1)&#123;</div><div class="line">                    areaSign =false;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            //3.执行自动生成操作</div><div class="line">            if(path.getText().length()&gt;1 &amp;&amp; catologName.getText().length()&gt;1 &amp;&amp; userName.getText().length()&gt;0 )&#123;</div><div class="line">                    if(numSign &amp;&amp; areaSign)&#123;</div><div class="line">                        GoTask gt= new GoTask();</div><div class="line">                        gt.setPath(path.getText());                                                             //C:/Users/Liu-shuwei/Desktop\\</div><div class="line">                        gt.setCatalogName(catologName.getText());                           //入库【4.0版,823表(完全版-未筛选)】</div><div class="line">                        gt.setNumMatch(match_num.isSelected());                             //是否开启编号范围匹配</div><div class="line">                        gt.setAreaMatch(match_area.isSelected());                               //是否开启地区匹配</div><div class="line">                        gt.setUseTable(db_table.getSelectedItem().toString());          //使用表名【SQLite的若不存在会自动创建】</div><div class="line">                        </div><div class="line">                        gt.GO_SQLite(userName.getText(),beginNum.getText()+&quot;-&quot;+endNum.getText(), area.getText());</div><div class="line">//                      gt.GO_SQLite(&quot;陈宇&quot;,&quot;02065-02145&quot;,&quot;华中&quot;);</div><div class="line">                        JOptionPane.showMessageDialog(null, &quot;生成完毕！&quot;, &quot;success&quot;,JOptionPane.PLAIN_MESSAGE);  </div><div class="line">                    &#125;else&#123;</div><div class="line">                        JOptionPane.showMessageDialog(null, &quot;开启了编号范围匹配 or 地区匹配\n则必须填写相应字段！&quot;, &quot;falil&quot;,JOptionPane.ERROR_MESSAGE);  </div><div class="line">                    &#125;</div><div class="line">            &#125;else&#123;</div><div class="line">                JOptionPane.showMessageDialog(null, &quot;抱歉,路径,文件名,程序猿不能为空！&quot;, &quot;falil&quot;,JOptionPane.ERROR_MESSAGE);  </div><div class="line">            &#125;       </div><div class="line">        &#125;   </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    public static void main(String [] args)&#123;</div><div class="line">        try&#123;</div><div class="line">            mainUI m = new mainUI();</div><div class="line">            m.setVisible(true);</div><div class="line">        &#125;catch(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">**********************************************************************</div><div class="line"></div><div class="line">package UI;</div><div class="line"></div><div class="line">import java.awt.Color;</div><div class="line">import java.awt.Container;</div><div class="line">import java.awt.Dimension;</div><div class="line">import java.awt.event.ActionEvent;</div><div class="line">import java.awt.event.ActionListener;</div><div class="line">import java.util.TimerTask;</div><div class="line"></div><div class="line">import javax.swing.JFrame;</div><div class="line">import javax.swing.JProgressBar;</div><div class="line">import javax.swing.Timer;</div><div class="line">import javax.swing.event.ChangeEvent;</div><div class="line">import javax.swing.event.ChangeListener;</div><div class="line"></div><div class="line"></div><div class="line">/**最后更新：2016.12.17</div><div class="line"> *          进度条页面，可根据需求配置定时器 【在项目中未实现】</div><div class="line"> * @author Suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class ProgressBar implements ActionListener,ChangeListener&#123;      //Change事件，让类能够实现接收和处理的Change事件</div><div class="line">    </div><div class="line">    </div><div class="line">        private JFrame frame=null;</div><div class="line">        private JProgressBar progressbar;</div><div class="line">        public Timer timer;</div><div class="line"></div><div class="line">        //1.无参构造函数，用于初始化界面</div><div class="line">        public ProgressBar()&#123;</div><div class="line">             </div><div class="line">                if(frame == null)&#123;</div><div class="line">                    frame=new JFrame(&quot;进度条&quot;);//窗体</div><div class="line">                    frame.setBounds(100, 100, 400, 130);    //x,y 坐标,width,height</div><div class="line">                    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);   //点击X健，退出程序且关闭线程</div><div class="line">                &#125;</div><div class="line">                if(progressbar == null)&#123;</div><div class="line">                    progressbar = new JProgressBar();//创建进度条实例,</div><div class="line">                    progressbar.setOrientation(JProgressBar.HORIZONTAL); //设置水平</div><div class="line">                    </div><div class="line">                    progressbar.setMinimum(0);                  //设置最小值</div><div class="line">                    progressbar.setMaximum(100);                //设置最大值</div><div class="line">                    progressbar.setValue(0);                            //设置当前进度</div><div class="line">                    progressbar.setBackground(Color.pink);//设置进度条颜色</div><div class="line">                    progressbar.setStringPainted(true);     //设置stringPainted属性值，该属性确定进度条是否应该呈现字符串</div><div class="line">                    progressbar.setBorderPainted(true);     // 设置 borderPainted 属性，如果进度条是否绘制其边框</div><div class="line">                    progressbar.setPreferredSize(new Dimension(300,20));//setSize是设定的固定大小，而setPreferredSize仅仅是设置最好的大小,new Dimension(500,20)，设置精准的尺寸</div><div class="line">                    </div><div class="line">                    progressbar.addChangeListener(this);    //注册Change事件</div><div class="line">                &#125;</div><div class="line">                    </div><div class="line">                    //创建容器</div><div class="line">                    Container contentPanel=frame.getContentPane();</div><div class="line">                    contentPanel.add(progressbar);</div><div class="line">                   </div><div class="line">                    //定时器</div><div class="line">                    if(timer == null)&#123;</div><div class="line">                        timer = new Timer(100,this);</div><div class="line">                    &#125;</div><div class="line">                    </div><div class="line">                    //显示窗体</div><div class="line">                    frame.setVisible(true);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        </div><div class="line">        @Override   //监听按钮变化</div><div class="line">        public void actionPerformed(ActionEvent e) &#123;</div><div class="line">            if(e.getSource() ==timer)&#123; </div><div class="line">                int value =progressbar.getValue();</div><div class="line">                if(value &lt;100)&#123;</div><div class="line">                    progressbar.setValue(++value);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //事件监听变化，当ProgressBar类发生变化时候，则回调此函数【观察者模式-初级】</div><div class="line">        public void stateChanged(ChangeEvent e1) &#123;</div><div class="line">            System.out.println(&quot;ProgressBar发生变化了---&gt;&quot;+progressbar.getValue());</div><div class="line">            if(e1.getSource()==progressbar)&#123;</div><div class="line">                if(progressbar.getValue()==100)&#123;</div><div class="line">                    System.out.println(&quot;加载完毕，关闭窗体&quot;);</div><div class="line">                    frame.dispose();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        //显示进度值</div><div class="line">//      public synchronized void GO(int pactent)&#123;</div><div class="line">//           new Thread(new MyThread()).start();  </div><div class="line">//          try&#123;</div><div class="line">//              Thread.sleep(5000);</div><div class="line">//          &#125;catch(Exception e)&#123;</div><div class="line">//              e.printStackTrace();</div><div class="line">//          &#125;</div><div class="line">//      &#125;</div><div class="line">        </div><div class="line">        //关闭窗体,释放所有资源</div><div class="line">        public void closeAll()&#123;</div><div class="line">            frame.dispose();</div><div class="line">            frame=null;</div><div class="line">            progressbar=null;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    public static void main(String[] args)&#123; </div><div class="line">    //1.测试进度条</div><div class="line">        ProgressBar app=new ProgressBar();</div><div class="line">        app.timer.start();</div><div class="line">//      for(int i=0;i&lt;100000000;i++)&#123;</div><div class="line">//          if(i%10000000&gt;=1)&#123;</div><div class="line">//              app.GO((i%10000000));</div><div class="line">//          &#125;       </div><div class="line">//      &#125;</div><div class="line">        //2.测试定时器</div><div class="line">//      Timer timer =new Timer();</div><div class="line">//      timer.schedule(new MyTask(),1*000,5*1000);//任务，1s后开始，每次5s</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //定时器类</div><div class="line">    class MyTask extends TimerTask&#123;</div><div class="line">        public  void run()&#123;</div><div class="line">            System.out.println(&quot;目前进度：&quot;+1+&quot;%&quot;);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    </div><div class="line">    //线程类</div><div class="line">//  class MyThread implements Runnable&#123;</div><div class="line">//</div><div class="line">//      public void run()&#123;</div><div class="line">//          progressbar.setValue(pacent);</div><div class="line">//          frame.repaint();</div><div class="line">//      &#125;</div><div class="line">//  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">//  &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p><br><br></p>
<h3 id="Utils包-1"><a href="#Utils包-1" class="headerlink" title="Utils包"></a>Utils包</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div><div class="line">700</div><div class="line">701</div><div class="line">702</div><div class="line">703</div><div class="line">704</div><div class="line">705</div><div class="line">706</div><div class="line">707</div><div class="line">708</div><div class="line">709</div><div class="line">710</div><div class="line">711</div><div class="line">712</div><div class="line">713</div><div class="line">714</div><div class="line">715</div><div class="line">716</div><div class="line">717</div><div class="line">718</div><div class="line">719</div><div class="line">720</div><div class="line">721</div><div class="line">722</div><div class="line">723</div><div class="line">724</div><div class="line">725</div><div class="line">726</div><div class="line">727</div><div class="line">728</div><div class="line">729</div><div class="line">730</div><div class="line">731</div><div class="line">732</div><div class="line">733</div><div class="line">734</div><div class="line">735</div><div class="line">736</div><div class="line">737</div><div class="line">738</div><div class="line">739</div><div class="line">740</div><div class="line">741</div><div class="line">742</div><div class="line">743</div><div class="line">744</div><div class="line">745</div><div class="line">746</div><div class="line">747</div><div class="line">748</div><div class="line">749</div><div class="line">750</div><div class="line">751</div><div class="line">752</div><div class="line">753</div><div class="line">754</div><div class="line">755</div><div class="line">756</div><div class="line">757</div><div class="line">758</div><div class="line">759</div><div class="line">760</div><div class="line">761</div><div class="line">762</div><div class="line">763</div><div class="line">764</div><div class="line">765</div><div class="line">766</div><div class="line">767</div><div class="line">768</div><div class="line">769</div><div class="line">770</div><div class="line">771</div><div class="line">772</div><div class="line">773</div><div class="line">774</div><div class="line">775</div><div class="line">776</div><div class="line">777</div><div class="line">778</div><div class="line">779</div><div class="line">780</div><div class="line">781</div><div class="line">782</div><div class="line">783</div><div class="line">784</div></pre></td><td class="code"><pre><div class="line">package Utils;</div><div class="line"></div><div class="line">import java.io.BufferedReader;</div><div class="line">import java.io.BufferedWriter;</div><div class="line">import java.io.File;</div><div class="line">import java.io.FileInputStream;</div><div class="line">import java.io.FileOutputStream;</div><div class="line">import java.io.IOException;</div><div class="line">import java.io.InputStream;</div><div class="line">import java.io.InputStreamReader;</div><div class="line">import java.io.OutputStreamWriter;</div><div class="line"></div><div class="line">/** 更新时间： 2016.12.18</div><div class="line"> *   </div><div class="line"> *  数据库封装类</div><div class="line"> *          方法1-读取</div><div class="line"> *          方法2-创建</div><div class="line"> *          方法3-追加内容</div><div class="line"> *              @author suvan</div><div class="line"> *  </div><div class="line"> *      扩展【cpdetector.jar包可以字段判断当前文件的内容编码】</div><div class="line"> */</div><div class="line">public class IOFile &#123;</div><div class="line">    </div><div class="line">        //方法1-1:读取文件内容【字节流】【只适用与读取英文，数字，无法设置编码格式】</div><div class="line">        public String rFileContent(String filePath) throws IOException&#123; //参数:文件路径,编码格式</div><div class="line">            </div><div class="line">            String content=&quot;&quot;;</div><div class="line">            InputStream inf=new FileInputStream(filePath);</div><div class="line">            for(int i=0;i&lt;inf.available();i++)&#123;</div><div class="line">                content+=(char)inf.read();</div><div class="line">            &#125;</div><div class="line">            </div><div class="line"></div><div class="line">            return &quot;\&apos;&quot;+content+&quot;\&apos;&quot;;   </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法1-2:读取文件内容【字符流】【可以设置编码，读取中文，英文，数字】</div><div class="line">          public String rFileContent(String filePath,String encoding) throws IOException&#123; //参数: 路径,编码格式</div><div class="line">                    StringBuilder sb =new StringBuilder();</div><div class="line">                    </div><div class="line">                    File f=new File(filePath);//定位文件【小弊端，没有文件的话会自动新建】</div><div class="line">                    </div><div class="line">                    FileInputStream fip=new FileInputStream(f);</div><div class="line">                    InputStreamReader isw=new InputStreamReader(fip,encoding);</div><div class="line">                    BufferedReader br = new BufferedReader(isw);</div><div class="line">                    </div><div class="line">                    while(isw.ready())&#123;</div><div class="line">                        sb.append((char)isw.read());</div><div class="line">                    &#125;</div><div class="line">                    </div><div class="line">                return sb.toString();   </div><div class="line">           &#125;        </div><div class="line">        </div><div class="line">         //方法2-3： 读取InputStream</div><div class="line">         public String readInputStream(InputStream is) throws IOException&#123;</div><div class="line">                </div><div class="line">             InputStreamReader isr = new InputStreamReader(is);</div><div class="line">             BufferedReader br = new BufferedReader(isr);  </div><div class="line">             </div><div class="line">             StringBuffer sbf = new StringBuffer();     </div><div class="line">             String tmp = &quot;&quot;;     </div><div class="line">                while((tmp = br.readLine())!=null)&#123;     </div><div class="line">                    sbf.append(tmp);     </div><div class="line">                &#125;     </div><div class="line">                return sbf.toString();</div><div class="line">         &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法3-1: 创建目录</div><div class="line">        public void createCatalog(String path,String catalogName)&#123;//参数：路径，目录名</div><div class="line">            </div><div class="line">            File d=new File(path+&quot;/&quot;+catalogName);</div><div class="line">            d.mkdir();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法3-2: 创建文件,写入内容</div><div class="line">        public void cFile(String path,String fileName,String encoding,String content) throws IOException&#123; //参数：路径,文件名.格式,编码格式,文件内容</div><div class="line">            File f=new File(path+&quot;/&quot;+fileName);</div><div class="line">            </div><div class="line">            FileOutputStream fop= new FileOutputStream(f);</div><div class="line">            OutputStreamWriter osw=new OutputStreamWriter(fop,encoding);</div><div class="line">            BufferedWriter writer = new BufferedWriter(osw);</div><div class="line">            writer.append(content);</div><div class="line">            writer.close();</div><div class="line">            fop.close();</div><div class="line">            System.out.println( &quot;*********************&quot;+fileName+&quot;成功创建！&quot;);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法3-3:追加文件内容【若不存在文件，则会在路径path下，新建filnName文件】</div><div class="line">        public void addContentFile(String path,String fileName,String content) throws IOException&#123; //参数：路径，文件名，追加的内容</div><div class="line">            File f=new File(path+&quot;/&quot;+fileName); </div><div class="line"></div><div class="line">            FileOutputStream fs = new FileOutputStream(f,true);</div><div class="line">            OutputStreamWriter osw = new OutputStreamWriter(fs);</div><div class="line">            BufferedWriter out = new BufferedWriter(osw);     </div><div class="line">                    </div><div class="line">            out.write(content);     </div><div class="line">            out.close();     </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">&#125;</div><div class="line"></div><div class="line">**********************************************************************</div><div class="line"></div><div class="line">package Utils;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line">import java.io.UnsupportedEncodingException;</div><div class="line">import java.sql.Connection;</div><div class="line">import java.sql.DriverManager;</div><div class="line">import java.sql.PreparedStatement;</div><div class="line">import java.sql.ResultSet;</div><div class="line">import java.sql.ResultSetMetaData;</div><div class="line">import java.sql.SQLException;</div><div class="line">import java.sql.Statement;</div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line"></div><div class="line">/** 更新时间： 2016.12.08</div><div class="line"> *   </div><div class="line"> *  数据库封装类</div><div class="line"> *          单例模式,【兼容MySQL(导入mysql-connector-java-5.1.38-bin.jar)和SQLite(导入sqlite-jdbc-3.15.1.jar)】</div><div class="line"> *          方法1-基础使用</div><div class="line"> *          方法2-查询 【SELECT】</div><div class="line"> *          方法3-插入【INSERT】</div><div class="line"> *          方法4-执行SQL语句</div><div class="line"> *              </div><div class="line"> *              @author suvan</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class UseDB &#123;</div><div class="line">    </div><div class="line">    //静态成员变量，支持单例模式</div><div class="line">    private static  volatile UseDB udb = null;</div><div class="line">    </div><div class="line">    </div><div class="line">    private static String databaseType;  //数据库类型【例如:Mysql,Oracle,SQLite之类的】</div><div class="line">    </div><div class="line">    private String drive;                            //数据库驱动</div><div class="line">    private String link;                             //【mysql—JDBC链接+IP地址+端口】</div><div class="line"></div><div class="line">    private String username;                  //用户名</div><div class="line">    private String password;                    //密码</div><div class="line">    </div><div class="line">    private Connection conn=null;</div><div class="line">    private Statement st=null;</div><div class="line">    private PreparedStatement pst=null;</div><div class="line">    private ResultSet rs=null;</div><div class="line">    private ResultSetMetaData rsmd=null;//获取列的信息</div><div class="line">    </div><div class="line">    private String sql; //sql语句</div><div class="line">    </div><div class="line">        </div><div class="line">        //有参构造函数进行赋值</div><div class="line">        public UseDB(String dbType)&#123;</div><div class="line">        </div><div class="line">            this.databaseType=dbType.toLowerCase(); //设定当前工具类使用什么类型的数据库</div><div class="line">            </div><div class="line">            if(&quot;mysql&quot;.equals(databaseType))&#123;   //转换为小写匹配</div><div class="line">                </div><div class="line">                this.drive=&quot;com.mysql.jdbc.Driver&quot;;             </div><div class="line">                this.link=&quot;jdbc:mysql://127.0.0.1:3306/&quot;;     </div><div class="line">                this.username=&quot;root&quot;;                                   </div><div class="line">                this.password=&quot;liushuwei&quot;;                  </div><div class="line">                </div><div class="line">            &#125;else if(&quot;sqlite&quot;.equals(databaseType))&#123;</div><div class="line">                </div><div class="line">                this.drive=&quot;org.sqlite.JDBC&quot;;                       //数据库驱动</div><div class="line">                this.link=&quot;jdbc:sqlite:SQLite/&quot;;     //jdbc:sqlite:+路径【默认项目根目录/SQLite】+数据库名</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    </div><div class="line">        </div><div class="line">        </div><div class="line">        </div><div class="line">        //A-1.懒汉式(加双重校验锁):【单例设计模式，获取实例,节约系统资源，提高性能】 ,项目中使用UseDB udb =UseDB.getInstance(&quot;javareptile&quot;);获取实例</div><div class="line">        public static synchronized UseDB getInstance() throws IOException,ClassNotFoundException,SQLException&#123;</div><div class="line">            if(udb == null)&#123;</div><div class="line">                    synchronized(UseDB.class)&#123;</div><div class="line">                        if(udb ==null)&#123;  //2   双重校验锁，实现延迟加载，解决线程并发，使用volatile指令静止重拍序列化</div><div class="line">                            udb = new UseDB(databaseType);</div><div class="line">                            udb.connDatabase(&quot;javareptile&quot;);</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">            &#125;</div><div class="line">            return udb;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line"></div><div class="line">        //方法1: 连接database数据库</div><div class="line">        public void connDatabase(String database)  throws SQLException,ClassNotFoundException&#123; //参数：数据库名称</div><div class="line">             Class.forName(drive);</div><div class="line">             if(&quot;mysql&quot;.equals(databaseType))&#123;</div><div class="line">                 conn=DriverManager.getConnection(link+database+&quot;?characterEncoding=UTF-8&amp;useSSL=false&quot;,username,password); </div><div class="line">             &#125;else if(&quot;sqlite&quot;.equals(databaseType))&#123;</div><div class="line">                 conn=DriverManager.getConnection(link+database);   </div><div class="line">             &#125;</div><div class="line"></div><div class="line">             st=conn.createStatement();</div><div class="line">//           System.out.println(&quot;数据库连接成功......&quot;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        //访法1-2: 使用database数据库                                </div><div class="line">        public void useDatabase(String database) throws SQLException&#123;//参数: 数据库名称</div><div class="line">            </div><div class="line">                sql=&quot;USE &quot;+database+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line"></div><div class="line">            System.out.println(&quot;********************目前使用&quot;+database+&quot;数据库**************************&quot;);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法1-3关闭所有对象</div><div class="line">        public void closeAll() throws SQLException&#123;</div><div class="line">            </div><div class="line">            if(rs!=null)  rs.close();//关闭ResultSet</div><div class="line">            if(pst!=null)   pst.close();    //关闭PreparedStatement</div><div class="line">            if(st!=null) st.close();//关闭Statement</div><div class="line">            if(conn!=null)  conn.close(); //关闭Connection</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    </div><div class="line">        </div><div class="line">//**************************************************************************************************************************************************************************        </div><div class="line">        </div><div class="line">        //方法2-1:查询table表中record字段满足condition条件的值,返回查询内容【字段值】 ，不能用于 * 查询</div><div class="line">        public String select(String table,String record,String condition)throws SQLException&#123;//参数: 表名,字段名,WHERE条件</div><div class="line">                StringBuilder sb= new StringBuilder();</div><div class="line">                </div><div class="line">                sql=&quot;SELECT &quot;+record+&quot; FROM &quot; +table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                ResultSetMetaData rsm =rs.getMetaData(); //获得列集</div><div class="line">                while(rs.next())&#123;</div><div class="line">                    sb.append(rs.getString(record));</div><div class="line">                &#125;</div><div class="line"></div><div class="line">            return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-2:查询table表中record字段满足condition条件的值,打印到控制台，并返回一个字符串【&amp;换列】</div><div class="line">                public String select(String table,String record,String condition,char o)throws SQLException&#123;//参数: 表名,字段名,WHERE条件</div><div class="line">                        StringBuilder sb= new StringBuilder();</div><div class="line">                        </div><div class="line">                        sql=&quot;SELECT * FROM &quot; +table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                        rs=st.executeQuery(sql);</div><div class="line">                        rsmd=rs.getMetaData();</div><div class="line">                        while(rs.next())&#123;</div><div class="line">                            for(int i=1;i&lt;=rsmd.getColumnCount();i++)&#123;  //获取总列数 数据字段从1开始</div><div class="line">                                if(rs.getString(i).equals(&quot;&quot;))&#123;</div><div class="line">                                    sb.append(&quot;-0-&amp;&quot;);</div><div class="line">                                &#125;else&#123;</div><div class="line">                                    sb.append(rs.getString(i)+&quot;&amp;&quot;);</div><div class="line">                                &#125;</div><div class="line">                                System.out.print(rs.getString(i)+&quot;\t&quot;);  //输出每个字段值，间隔一个Tab长度</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line"></div><div class="line">                    return sb.toString();</div><div class="line">                &#125;</div><div class="line">        </div><div class="line">        //方法2-3:查询table所有数据的数据,打印到控制台，并返回一个字符串 【&amp;换列，##换行】</div><div class="line">        public String select(String table) throws SQLException&#123;//参数: 表名</div><div class="line">                StringBuilder sb= new StringBuilder();</div><div class="line">                </div><div class="line">                sql=&quot;SELECT * FROM &quot; +table+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                rsmd =rs.getMetaData(); //获得列集</div><div class="line">                </div><div class="line">                    while(rs.next())&#123;//光标移动</div><div class="line">                        for(int i=1;i&lt;=rsmd.getColumnCount();i++)&#123;  //获取总列数</div><div class="line">                            sb.append(rs.getString(i)+&quot;&amp;&quot;);</div><div class="line">                            System.out.print(rs.getString(i)+&quot;\t&quot;);  //输出每个字段值，间隔一个Tab长度</div><div class="line">                        &#125;</div><div class="line">                        System.out.println();//换行</div><div class="line">                        sb.append(&quot;##&quot;);</div><div class="line">                    &#125;</div><div class="line">    </div><div class="line">            </div><div class="line">                return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">            </div><div class="line">        </div><div class="line">        //方法2-4:查询table表,record字段的所有记录值(所有行)【##换行】</div><div class="line">        public String selectAllColumn(String table,String record) throws SQLException&#123;</div><div class="line">            StringBuilder sb= new StringBuilder();</div><div class="line">            </div><div class="line">             sql=&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot;;&quot;;</div><div class="line">             rs=st.executeQuery(sql);</div><div class="line">             while(rs.next())&#123;</div><div class="line">                 sb.append(rs.getString(1)+&quot;##&quot;);</div><div class="line">             &#125;</div><div class="line">             </div><div class="line">            return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-5:查询table表,record字段的所有记录值(所有行),用ArrayList保存</div><div class="line">                public List&lt;String&gt; selectAllColumn_list(String table,String record) throws SQLException&#123;</div><div class="line">                    List&lt;String&gt; list = new ArrayList&lt;String&gt;();</div><div class="line">                     sql=&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot;;&quot;;</div><div class="line">                     rs=st.executeQuery(sql);</div><div class="line">                     while(rs.next())&#123;</div><div class="line">                         list.add(rs.getString(1));</div><div class="line">                     &#125;</div><div class="line">                     </div><div class="line">                    return list;</div><div class="line">                &#125;</div><div class="line">        </div><div class="line">        //方法2-6：查询table表,满足content条件【具有唯一性】，有记录的字段直接返回记录值,没有则返回null</div><div class="line">        public String selectIfExist_CheckRecord(String table,String record,String condition) throws SQLException&#123;//参数: 表名,字段名，条件</div><div class="line">                </div><div class="line">                sql=&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                String record_content=null;</div><div class="line">                if(rs.next())&#123;</div><div class="line">                    record_content=rs.getString(1);</div><div class="line">                &#125;</div><div class="line"></div><div class="line">            return record_content;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        //方法2-7:查询table表,根据条件condition【具有唯一性】,判断整行记录那个字段拥有记录，有记录的字段返回字段名和值【&amp;&amp;&amp;&amp;&amp;分隔】</div><div class="line">        public ArrayList&lt;String&gt; selectIfExist_CheckRecord(String table,String condition,char o) throws SQLException&#123;//参数: 表名，条件,*</div><div class="line">            </div><div class="line">            ArrayList&lt;String&gt; al = new ArrayList&lt;String&gt;();</div><div class="line">                </div><div class="line">                sql=&quot;SELECT * FROM &quot;+table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                System.out.println(sql);</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                rsmd=rs.getMetaData();</div><div class="line"></div><div class="line">                while(rs.next())&#123;</div><div class="line">                    for(int i=1;i&lt;=rsmd.getColumnCount();i++)&#123;  </div><div class="line">                        al.add(rsmd.getColumnName(i));//只要列名</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">            return al;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-8: 查询table表,满足条件condition的,返回规定范围行数的记录的列名【&amp;分隔每列】</div><div class="line">        public ArrayList&lt;String&gt; selectAskinformation_Scope(String table,String condition,String scope) throws SQLException&#123; //参数:表名,条件,范围行数【使用-进行分隔,例如1-5】</div><div class="line">//              StringBuilder sb= new StringBuilder();</div><div class="line">                ArrayList&lt;String&gt; alist = new  ArrayList&lt;String&gt;();</div><div class="line">                </div><div class="line">                String [] scope_arrays =scope.split(&quot;-&quot;);</div><div class="line">                int begin=Integer.parseInt(scope_arrays[0]);</div><div class="line">                int end=Integer.parseInt(scope_arrays[1]);</div><div class="line">                </div><div class="line">                sql=&quot;SELECT * FROM &quot;+table+&quot; WHERE &quot;+condition+&quot;;&quot;;</div><div class="line">                rs=st.executeQuery(sql);</div><div class="line">                rsmd=rs.getMetaData();</div><div class="line">                while(rs.next())&#123;</div><div class="line">                    for(int i=begin;i&lt;=end;i++)&#123; //遍历范围区间的字段</div><div class="line">                        if(rs.getString(i)==null || rs.getString(i).length()&lt;2) continue;</div><div class="line">                        alist.add(rsmd.getColumnName(i));//只要列名</div><div class="line">                    &#125;       </div><div class="line">                &#125;</div><div class="line"></div><div class="line">            return alist;   </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-9：查询table所有记录总数，返回记录总数</div><div class="line">        public int select_allCount(String table) throws SQLException&#123;//参数：表名</div><div class="line">            </div><div class="line">            </div><div class="line">            sql=&quot;SELECT count(*)  FROM &quot; +table+&quot;;&quot;;</div><div class="line">            rs=st.executeQuery(sql);</div><div class="line">            rs.next();</div><div class="line">            </div><div class="line">            int recordCount =Integer.parseInt(rs.getString(1));</div><div class="line"></div><div class="line">            return recordCount;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">//**************************************************************************************************************************************************************************</div><div class="line">        </div><div class="line">        //方法3-1: 往table表插入整行数据【按顺序依次匹配第1列到最后1列】</div><div class="line">        public void insert(String table,String content) throws SQLException&#123;//参数: 表名,内容</div><div class="line">                    String sql=&quot;INSERT OR IGNORE  INTO  &quot;+table+&quot; VALUES(&quot;+content+&quot;);&quot;;//去重插入【应用于SQLite】遇到重复就跳过OR IGNORE</div><div class="line">                    int i=st.executeUpdate(sql);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法3-2: 往table表record字段,插入一行content数据【少量数据(标题，日期等)】【多字段插入   ,分隔字段     ,号分隔内容】</div><div class="line">        public void insert(String table,String record,String content) throws SQLException&#123;//参数: 表名,字段,内容</div><div class="line">                    String sql=&quot;INSERT INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+content+&quot;);&quot;;</div><div class="line">                    int i=st.executeUpdate(sql);</div><div class="line">                    if(i!=-1)&#123;</div><div class="line">//                      System.out.println(&quot;*****************&quot;+table+&quot;表INSERT成功！****************&quot;);</div><div class="line">                    &#125;</div><div class="line">        &#125;</div><div class="line">                </div><div class="line">        //方法3-3:往table表record，插入一行content数据 【大量数据(文章，文本内容)】【,分隔字段 &amp;&amp;&amp;&amp;&amp; 分隔内容   ,分隔占位符】</div><div class="line">        public void insert(String table,String record,String content,String mark) throws SQLException, UnsupportedEncodingException&#123;//参数值: 表名,字段,内容，占位符(?)</div><div class="line">//                  content =new String(content.getBytes(),&quot;UTF-8&quot;);</div><div class="line">            </div><div class="line">                    String [] content_Arrays=content.split(&quot;&amp;&amp;&amp;&amp;&amp;&quot;);//分隔内容存入数组</div><div class="line">                    String [] mark_Arrays = mark.split(&quot;,&quot;);</div><div class="line">                    </div><div class="line">                    //判断是否存在相同记录，如果存在则不执行插入【以第一条record为准】</div><div class="line">                    String first_record=record.substring(0,record.indexOf(&quot;,&quot;));</div><div class="line">                    sql  =&quot;SELECT &quot;+record+&quot; FROM &quot;+table+&quot; WHERE &quot;+first_record+&quot;=&apos;&quot;+content_Arrays[0]+&quot;&apos;;&quot;;</div><div class="line">                    rs=st.executeQuery(sql);</div><div class="line">                        </div><div class="line">                        if(rs.next())&#123;//光标移动</div><div class="line">                            //存在相同记录</div><div class="line">                            System.out.println(&quot;**********************很抱歉，&quot;+table+&quot;表已经存在&quot;+content_Arrays[0]+&quot;记录,INSERT失败,不进行重复插入！*************************8888&quot;);</div><div class="line">                        &#125;else&#123;</div><div class="line">                            //不存在相同记录</div><div class="line">//                          System.out.println(&quot;**********************&quot;+table+&quot;表中不存在&quot;+content_Arrays[0]+&quot;记录,正在进行INSERT。。。。。。。。。。。。。&quot;);</div><div class="line">                            sql=&quot;INSERT INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+mark+&quot;);&quot;;</div><div class="line">                            </div><div class="line">                            pst=conn.prepareStatement(sql);</div><div class="line">                            </div><div class="line">                            for(int i=1;i&lt;=mark_Arrays.length;i++)&#123;//根据占位符个数【?的数量】进行循环: ?号个数            </div><div class="line">                                pst.setString(i,mark_Arrays[i-1]);</div><div class="line">                            &#125;</div><div class="line">                            </div><div class="line">                            pst.executeUpdate();</div><div class="line">//                          System.out.println(&quot;*****************&quot;+table+&quot;表INSERT成功！****************&quot;);</div><div class="line">                        &#125;</div><div class="line">            &#125;</div><div class="line">        </div><div class="line">        //方法3-4(去重插入1)： 添加唯一索引,使用INSERT INTO ... ON DUPLICATE KEY UPDATE ..【重复插入时更新】</div><div class="line">        public void insertUpdate(String table,String record,String content,String UpdateConent) throws SQLException&#123;//参数: 表名,字段,内容,更新内容</div><div class="line">            String sql=&quot;INSERT INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+content+&quot;) ON DUPLICATE KEY UPDATE &quot;+UpdateConent+&quot;;&quot;;</div><div class="line">            int i=st.executeUpdate(sql);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法3-5(去重插入2): 添加唯一索引,使用INSERT IGNORE INTO...【存在相同数据，就跳过该数据】</div><div class="line">        public void insertInGore(String table,String record,String content) throws SQLException&#123;//参数: 表名,字段,内容,更新内容</div><div class="line">                String sql=&quot;INSERT IGNORE INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+content+&quot;);&quot;;</div><div class="line">                int i=st.executeUpdate(sql);</div><div class="line">        &#125;       </div><div class="line">        </div><div class="line">        //方法3-6(去重插入3):添加唯一索引,使用REPLACE INTO【不重复和INSERT的功能一样,有重复就使用新纪录值替换原来记记录值】</div><div class="line">                                                                                         //【表中必须有唯一索引，而且不为空字段，否则就和INSERT完全一样】【将DELETE和INSERT和操作合二唯一】</div><div class="line">        public void insertReplace(String table,String record,String content) throws SQLException&#123;//参数: 表名,字段,内容</div><div class="line">            String sql=&quot;REPLACE INTO &quot;+table+&quot;(&quot;+record+&quot;) VALUES(&quot;+content+&quot;);&quot;;</div><div class="line">            int i=st.executeUpdate(sql);</div><div class="line">            //执行REPLACE后，系统返回所受影响行数，=1说明表中没有重复记录，=2则说明有，&gt;2说明有多个唯一索引，有多条记录被删除和插入。</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法3-6(去重插入4)：使用dual【虚表去重】【度娘度娘....】</div><div class="line">        </div><div class="line"></div><div class="line">//**************************************************************************************************************************************************************************</div><div class="line">        </div><div class="line">        //方法4-1：【执行创建语句】</div><div class="line">        public void createSQL(String sql) throws SQLException&#123;</div><div class="line">            st.executeUpdate(sql);  </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法4-2：【执行插入语句】</div><div class="line">        public void insertSQL(String sql) throws SQLException&#123;</div><div class="line">            st.executeUpdate(sql);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法4-3：【执行查找语句】</div><div class="line">        public String selectSQL(String sql) throws SQLException&#123;</div><div class="line">            StringBuilder sb = new StringBuilder();</div><div class="line">            </div><div class="line">            rs = st.executeQuery(sql);</div><div class="line">            rsmd=rs.getMetaData();</div><div class="line">            while(rs.next())&#123;</div><div class="line">                for(int i=1;i&lt;=rsmd.getColumnCount();i++)&#123;</div><div class="line">                    System.out.print(rsmd.getColumnName(i)+&quot;:&quot;+rs.getString(i)+&quot;\t&quot;);</div><div class="line">                    sb.append(rs.getString(i)+&quot;&amp;&amp;&quot;);</div><div class="line">                &#125;</div><div class="line">                System.out.println();//换行</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法4-4:【执行更新操作】</div><div class="line">        public void updateSQL(String sql) throws SQLException&#123;</div><div class="line">            conn.setAutoCommit(false);//禁止自动提交</div><div class="line">            st.executeUpdate(sql);</div><div class="line">            conn.commit();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法4-5:【执行删除操作】</div><div class="line">        public void deleteSQL(String sql) throws SQLException&#123;</div><div class="line">            conn.setAutoCommit(false);//禁止自动提交</div><div class="line">            st.executeUpdate(sql);</div><div class="line">            conn.commit();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //**************************************************************************************************************************************************************************</div><div class="line">        </div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">**********************************************************************</div><div class="line"></div><div class="line">package Utils;</div><div class="line"></div><div class="line">import java.io.File;</div><div class="line">import java.io.IOException;</div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.HashMap;</div><div class="line"></div><div class="line">import jxl.Cell;</div><div class="line">import jxl.Sheet;</div><div class="line">import jxl.Workbook;</div><div class="line">import jxl.read.biff.BiffException;</div><div class="line">import jxl.write.Label;</div><div class="line">import jxl.write.WritableSheet;</div><div class="line">import jxl.write.WritableWorkbook;</div><div class="line">import jxl.write.WriteException;</div><div class="line"></div><div class="line">/**更新时间:2016.12.13</div><div class="line"> *          操作Excel工作薄</div><div class="line"> *              方法1：使用jxl.jar   【创建和读取excel】</div><div class="line"> *              方法2：使用poi.jar 【创建和读取excel】</div><div class="line"> *      @author Suvan</div><div class="line"> */</div><div class="line">public class UseExcel &#123;</div><div class="line">    </div><div class="line">    </div><div class="line">    //方法1-2：创建Excel文件，写入数据</div><div class="line">    public   void createExcel() throws IOException,WriteException&#123;</div><div class="line">        //1.新建文件，设置目录</div><div class="line">        File xlsFile = new File(&quot;C:\\Users\\Liu-shuwei\\Desktop\\jxl.xls&quot;); </div><div class="line">        </div><div class="line">        //2.创建工作簿</div><div class="line">        WritableWorkbook workbook = Workbook.createWorkbook(xlsFile);</div><div class="line">        </div><div class="line">        //3.创建工作表</div><div class="line">         WritableSheet sheet = workbook.createSheet(&quot;sheet1&quot;, 0);</div><div class="line">          for (int row = 0; row &lt; 10; row++)&#123;   </div><div class="line">             for (int col = 0; col &lt; 10; col++) &#123;</div><div class="line">                 </div><div class="line">                 //第col列【从0开始】，第row行【从0开始】，数据</div><div class="line">                 Label lb = new Label(col,row,&quot;数据【&quot;+col+&quot;列&quot;+row+&quot;行】&quot;);</div><div class="line">                 sheet.addCell(lb);  // 向工作表中添加数据</div><div class="line">             &#125;</div><div class="line">          &#125;</div><div class="line">          </div><div class="line">          //4.写入数据</div><div class="line">          workbook.write();</div><div class="line">          </div><div class="line">          //5.关闭流</div><div class="line">          workbook.close();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法1-2：读取Excel</div><div class="line">    public  HashMap [] getExcel(String filePath) throws IOException,BiffException&#123;  //返回数组[HashMap&lt;“rows”，ArrayList&gt;]  </div><div class="line">    </div><div class="line">        //1.定位文件</div><div class="line">        File xlsFile = new File(filePath);</div><div class="line">        </div><div class="line">        //2.获得工作薄对象</div><div class="line">        Workbook workbook = Workbook.getWorkbook(xlsFile);</div><div class="line">        </div><div class="line">        //3.获得所有工作表</div><div class="line">        Sheet [] sheets = workbook.getSheets();</div><div class="line">        </div><div class="line">            //构建用于保存数据的数组,无序哈希表,有序集合</div><div class="line">            HashMap [] sheets_map=new HashMap[sheets.length];                       </div><div class="line">            </div><div class="line">        </div><div class="line">        //4.遍历工作表</div><div class="line">        if(sheets != null)&#123;</div><div class="line">            for(int s =0;s&lt;sheets.length;s++)&#123;</div><div class="line">                </div><div class="line">                //读取所有rows【所有行】     </div><div class="line">                HashMap&lt;Integer,ArrayList&gt; rows_map = new HashMap&lt;Integer,ArrayList&gt;();</div><div class="line">                for(int row =0 ;row&lt;sheets[s].getRows();row++)&#123;</div><div class="line">                    Cell    [] cells =sheets[s].getRow(row);                                        //获取整行数据,保存进数组,Sheet.getColumn()是获取整列</div><div class="line">                    </div><div class="line">                    </div><div class="line">                    //读取所有列列数据</div><div class="line">                    ArrayList&lt;String&gt; cols_list = new ArrayList&lt;String&gt;();</div><div class="line">                    for(int col = 0;col &lt; sheets[s].getColumns();col++)&#123;</div><div class="line">//                      System.out.printf(&quot;%10s&quot;,sheets[s].getCell(col,row).getContents());</div><div class="line">                        cols_list.add(sheets[s].getCell(col,row).getContents());        //储存每列【每个单元格】数据</div><div class="line">                    &#125;</div><div class="line">                    rows_map.put(row, cols_list);                                                   //储存每行数据                            </div><div class="line">                &#125;</div><div class="line">                sheets_map[s]=rows_map;                                                          //储存每个工作表示数据</div><div class="line">                </div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    </div><div class="line"></div><div class="line">        workbook.close();</div><div class="line">        return sheets_map;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //方法1-3：读取UseExcel表格,返回拥有的工作表名</div><div class="line">    public ArrayList&lt;String&gt; getExcelSheetsName(String filePath) throws IOException, BiffException&#123;</div><div class="line">        //1.创建ArrayList对象用于储存表名</div><div class="line">        ArrayList&lt;String&gt; alist= new ArrayList&lt;String&gt;();</div><div class="line">        </div><div class="line">    </div><div class="line">        //2.定位Excel,获得工作薄对象</div><div class="line">        File xlsFile = new File(filePath);</div><div class="line">        Workbook workbook = Workbook.getWorkbook(xlsFile);</div><div class="line">        </div><div class="line">        //3.获取所有工作表名</div><div class="line">        for(Sheet sheet:workbook.getSheets())&#123;</div><div class="line">            alist.add(sheet.getName());</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        return alist;</div><div class="line">    &#125;</div><div class="line">//************************************************************************************************************************</div><div class="line">    //方法2-1：poi创建excel</div><div class="line">//  public static void createExcel_poi() throws IOException&#123;</div><div class="line">//          //1.创建工作簿</div><div class="line">//          HSSFWorkbook workbook =new HSSFWorkbook();</div><div class="line">//          </div><div class="line">//          //2.创建工作表</div><div class="line">//          HSSFSheet sheet = workbook.createSheet(&quot;suvan&quot;);</div><div class="line">//          for(int row =0;row&lt;10;row++)&#123;</div><div class="line">//              HSSFRow rows = sheet.createRow(row);</div><div class="line">//              for(int col=0;col&lt;10;col++)&#123;</div><div class="line">//                  //向工作表添加数据</div><div class="line">//                  rows.createCell(col).setCellValue(&quot;数据第&quot;+row+&quot;行-&quot;+col+&quot;列&quot;);</div><div class="line">//              &#125;</div><div class="line">//          &#125;</div><div class="line">//          </div><div class="line">//          //3.创建文件</div><div class="line">//          File xlsFile = new File(&quot;C:\\Users\\Liu-shuwei\\Desktop\\suvan.xls&quot;);</div><div class="line">//          FileOutputStream xlsStream = new FileOutputStream(xlsFile);</div><div class="line">//          workbook.write(xlsStream);</div><div class="line">//          workbook.close();</div><div class="line">//  &#125;</div><div class="line">//  </div><div class="line">    //方法2-2:poi读取excel文件</div><div class="line">//  public static void readExcel_poi() throws EncryptedDocumentException, InvalidFormatException, IOException&#123;</div><div class="line">//      //1.定位文件</div><div class="line">//      File xlsFile = new File(&quot;C:\\Users\\Liu-shuwei\\Desktop\\第5周-8.23.xls&quot;);</div><div class="line">//      //2.获得工作薄【WorkbookFactory位于poi-ooxml-3.14-20160307.jar】</div><div class="line">//      org.apache.poi.ss.usermodel.Workbook workbook =WorkbookFactory.create(xlsFile);</div><div class="line">//      //3.获得工作表个数</div><div class="line">//      int sheetCount = workbook.getNumberOfSheets();</div><div class="line">//      ///4.遍历工作表</div><div class="line">//      for(int i=0;i&lt;sheetCount;i++)&#123;</div><div class="line">//           //a.选择工作表</div><div class="line">//          Sheet sheet = workbook.getSheetAt(i);</div><div class="line">//          </div><div class="line">//          //b.获取总行数和列数</div><div class="line">//          int rows =sheet.getLastRowNum()+1;          //总行数</div><div class="line">//          Row tmp = sheet.getRow(0);</div><div class="line">//          if(tmp == null) continue;</div><div class="line">//          int cols = tmp.getPhysicalNumberOfCells();  //总列数</div><div class="line">//</div><div class="line">//          //c.读取数据</div><div class="line">//          for(int row =0;row&lt;rows;row++)&#123;</div><div class="line">//              Row r = sheet.getRow(row);</div><div class="line">//              for(int col=0;col&lt;cols;col++)&#123;</div><div class="line">//                  if(r.getCell(col)!=null)&#123;</div><div class="line">//                      r.getCell(col).setCellType(Cell.CELL_TYPE_STRING); //设置Cell类型，然后就可以把纯数字作为String类型读出来</div><div class="line">//                      System.out.printf(&quot;%10s&quot;,r.getCell(col).getStringCellValue());</div><div class="line">//                  &#125;</div><div class="line">//              &#125;</div><div class="line">//      </div><div class="line">//              System.out.println();//换行</div><div class="line">//          &#125;</div><div class="line">//      &#125;</div><div class="line">//      </div><div class="line">//      workbook.close();</div><div class="line">//  &#125;</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">**********************************************************************</div><div class="line"></div><div class="line">package Utils;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.regex.Matcher;</div><div class="line">import java.util.regex.Pattern;</div><div class="line"></div><div class="line">/**更新时间:2016.12.03</div><div class="line"> *          操作字符串</div><div class="line"> *              方法1：转换</div><div class="line"> *              方法2：判断</div><div class="line"> *              方法3：正则表达式</div><div class="line"> *              方法4：格式化</div><div class="line"> *              方法5：获取</div><div class="line"> *      @author Suvan</div><div class="line"> */</div><div class="line">public class UseString &#123;</div><div class="line">    </div><div class="line">    //方法1-1:将首字母变为大写</div><div class="line">        public String UpFirstString(String content)&#123; //参数: 内容</div><div class="line">            String firstLetter=content.substring(0,1);</div><div class="line">            content=content.replaceFirst(firstLetter,firstLetter.toUpperCase());//替换首字母</div><div class="line">            </div><div class="line">            return content;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法1-2:将首字母变为小写</div><div class="line">        public String LowFirstString(String content)&#123; //参数: 内容</div><div class="line">            String firstLetter=content.substring(0,1);</div><div class="line">            content=content.replaceFirst(firstLetter,firstLetter.toLowerCase());//替换首字母</div><div class="line">            </div><div class="line">            return content;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法1-3:将字符串变为int类型</div><div class="line">        public int getInt(String content)&#123;</div><div class="line">            return Integer.parseInt(content);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法1-4:字符串转码</div><div class="line">        public String getTranscoding(String content,String encoding) throws IOException&#123;</div><div class="line">            byte[] t_content = content.getBytes(encoding);</div><div class="line">            String newS = new String(t_content,encoding);</div><div class="line">            return newS;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法2-1：判断num编号属否在scope区间里面，返回布尔类型参数【true--属于，false--不属于】</div><div class="line">        public Boolean getMinMaxScope(String scope,int num)&#123;//参数：范围，编号</div><div class="line">            Boolean sign = false;//判断标识，默认为true</div><div class="line">            </div><div class="line">            String [] scope_arrays = scope.split(&quot;-&quot;);</div><div class="line">            int minScope =Integer.parseInt(scope_arrays[0]);</div><div class="line">            int maxScope =Integer.parseInt(scope_arrays[1]);</div><div class="line">            </div><div class="line">                if(minScope &lt;= num &amp;&amp; num &lt;= maxScope)&#123;</div><div class="line">                    sign =true;</div><div class="line">                &#125;</div><div class="line">            </div><div class="line">            return sign;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法3-1：正则表达式</div><div class="line">        public ArrayList&lt;String&gt; getRegexResult(String content,String pattern)&#123;</div><div class="line">                </div><div class="line">                ArrayList&lt;String&gt; alist = new ArrayList&lt;String&gt;();</div><div class="line">            //1.创建Pattern对象</div><div class="line">                Pattern p = Pattern.compile(pattern);</div><div class="line">            </div><div class="line">                //2.创建Matcher对象</div><div class="line">                Matcher m = p.matcher(content);</div><div class="line">                if(m.find())&#123;  //如果有发现的话</div><div class="line">                    System.out.println(m.groupCount());</div><div class="line">                    for(int i=0;i&lt;m.groupCount();i++)&#123;</div><div class="line">                        System.out.println(m.group(i));</div><div class="line">                        alist.add(m.group(i));</div><div class="line">                    &#125;</div><div class="line">                &#125;else&#123;</div><div class="line">                    System.out.println(&quot;很抱歉,没有找到任何匹配&quot;);</div><div class="line">                &#125;</div><div class="line">                System.out.println(&quot;***********************************************&quot;);</div><div class="line">                return alist;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法4-1：格式化输出语句【应放在项目里的使用类】</div><div class="line">        private void print(String msg, Object... args) &#123;</div><div class="line">            //%d是一个占位符，标识一个字符串型的数据，%10d是数字的左侧留10个空格，对齐用 %s也是一个占位符，标识一个字符串型的数据</div><div class="line">            System.out.println(String.format(msg, args));</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法4-2：得到拼接的SQL语句</div><div class="line">        public String getSQL(ArrayList&lt;String&gt; data_list)&#123;</div><div class="line">            StringBuilder sb =new StringBuilder(&quot;&apos;&quot;);</div><div class="line">            for(int c=0;c&lt;data_list.size();c++)&#123;</div><div class="line">                sb.append(data_list.get(c)+&quot;&apos;,&apos;&quot;);</div><div class="line">            &#125;</div><div class="line">            sb.substring(sb.lastIndexOf(&quot;,&quot;));</div><div class="line">            </div><div class="line">            return sb.toString();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        //方法5-1：</div><div class="line">        public long getTime()&#123;</div><div class="line">            //获得的是自1970-1-01 00:00:00.000 到当前时刻的时间距离【毫秒】</div><div class="line">            return System.currentTimeMillis();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p><br><br><br><br><br></p>
<h1 id="5-3版【2017-1-9】"><a href="#5-3版【2017-1-9】" class="headerlink" title="5.3版【2017.1.9】"></a>5.3版【2017.1.9】</h1><p><br></p>
<p>5.3更新：</p>
<ol>
<li>导入完excel数据，实现主窗体实现异步刷新【导入完可以直接生成】</li>
<li>JFileChooser默认启动路径为电脑桌面</li>
<li>加入事务处理，SQLite批量插入速度提升10倍+</li>
<li>优化写细节操作，提升操作友好度</li>
<li>自动生成文档(部分生成详细情况可以自己试下)【若出现-的顺序不同，则需要走自主调整excel表的顺序】</li>
</ol>
<p><br><br></p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><br></p>
<ol>
<li>在main.AlterContent加入了生成文档操作</li>
<li>main.GoTask删除了MYSQL的流程</li>
<li>Utils.UseDB的insert取消自动提交，需要自主根据需要commit事务</li>
<li>UI.insertUI里加入成员变量，可控制mainUI</li>
</ol>
<hr>
<p><br><br><br><br><br></p>
<h1 id="5-4版【2017-1-9下午】"><a href="#5-4版【2017-1-9下午】" class="headerlink" title="5.4版【2017.1.9下午】"></a>5.4版【2017.1.9下午】</h1><p><br></p>
<p>5.3更新：</p>
<ol>
<li>添加双模式生成【分配模式 and 集成模式】,文件目录以(入库[双模式],接口(生成包名)，文档分开布局)</li>
<li>文档依旧保留开头编号【用于区分，以后要删除再自己删除】</li>
<li>该版本保留5.3特性，建议把自己相应任务编号内的添加进去，再用此表导入生成.</li>
</ol>
<p><br><br></p>
<h2 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h2><p><br></p>
<ol>
<li>在main.GoTask加入组双模式</li>
<li>UI.mainUI里面加入文件ButtonGroup(按钮组)和JRadioButton(单选按钮),并添加相应事件逻辑</li>
</ol>
<hr>
<p><br><br><br><br><br></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/MyProject/" rel="tag"># MyProject</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/12/29/Life_2016 年总结/" rel="next" title="2016 年总结">
                <i class="fa fa-chevron-left"></i> 2016 年总结
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/01/10/VPS_使用 VPS + Shadowsocks 科学上网/" rel="prev" title="使用 VPS + Shadowsocks 科学上网">
                使用 VPS + Shadowsocks 科学上网 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/suvan-min.jpg"
               alt="刘淑玮" />
          <p class="site-author-name" itemprop="name">刘淑玮</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">52</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>
   
        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        


        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/Suvan-L" target="_blank" title="GitHub"">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:liushuwei0925@gmail.com" target="_blank" title="Gmail"">
                  
                    <i class="fa fa-fw fa-envelope"></i>
                  
                  Gmail
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#目录"><span class="nav-number">2.</span> <span class="nav-text">目录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#版本1-0【2016-8-27】"><span class="nav-number">2.1.</span> <span class="nav-text">版本1.0【2016.8.27】</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-testMain-java"><span class="nav-number">2.1.1.</span> <span class="nav-text">1.testMain.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-TaskFlow-java"><span class="nav-number">2.1.2.</span> <span class="nav-text">2. TaskFlow.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-UseDB-java"><span class="nav-number">2.1.3.</span> <span class="nav-text">3. UseDB.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-IOFile-java"><span class="nav-number">2.1.4.</span> <span class="nav-text">4. IOFile.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-ChangeFile-java"><span class="nav-number">2.1.5.</span> <span class="nav-text">5. ChangeFile.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-两套java文件模版"><span class="nav-number">2.1.6.</span> <span class="nav-text">6. 两套java文件模版</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#a-BackupTaskt-java"><span class="nav-number">2.1.6.1.</span> <span class="nav-text">a. BackupTaskt.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#b-ZhaobGgServiceModel-java"><span class="nav-number">2.1.6.2.</span> <span class="nav-text">b. ZhaobGgServiceModel.java</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-设计数据库"><span class="nav-number">2.1.7.</span> <span class="nav-text">7.设计数据库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#版本2-0【2016-11-15】"><span class="nav-number">2.2.</span> <span class="nav-text">版本2.0【2016.11.15】</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-testMain-java和TaskFlow-java"><span class="nav-number">2.3.</span> <span class="nav-text">1. testMain.java和TaskFlow.java</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-UseDB-java-IOFile-java和ChangeFile-java"><span class="nav-number">2.4.</span> <span class="nav-text">2. UseDB.java,IOFile.java和ChangeFile.java</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-BackupTask-java和ZhaobGgServiceModel-java模版"><span class="nav-number">2.4.1.</span> <span class="nav-text">3. BackupTask.java和ZhaobGgServiceModel.java模版</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-两个表webapi和article"><span class="nav-number">2.4.2.</span> <span class="nav-text">4.两个表webapi和article</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#版本【3-0】-2016-11-27"><span class="nav-number">3.</span> <span class="nav-text">版本【3.0】 2016.11.27</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-目录结构："><span class="nav-number">3.0.1.</span> <span class="nav-text">1. 目录结构：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-代码"><span class="nav-number">3.0.2.</span> <span class="nav-text">2. 代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#版本4-0【2016-12-13】"><span class="nav-number">4.</span> <span class="nav-text">版本4.0【2016.12.13】</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#main包"><span class="nav-number">4.1.</span> <span class="nav-text">main包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-GetTableData-java"><span class="nav-number">4.2.</span> <span class="nav-text">2.GetTableData.java</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Utils包"><span class="nav-number">4.3.</span> <span class="nav-text">Utils包</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#版本5-0【2016-12-18】"><span class="nav-number">5.</span> <span class="nav-text">版本5.0【2016.12.18】</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Code【贴上所有代码】"><span class="nav-number">5.1.</span> <span class="nav-text">Code【贴上所有代码】</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UI包"><span class="nav-number">5.1.1.</span> <span class="nav-text">UI包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Utils包-1"><span class="nav-number">5.1.2.</span> <span class="nav-text">Utils包</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-3版【2017-1-9】"><span class="nav-number">6.</span> <span class="nav-text">5.3版【2017.1.9】</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#代码"><span class="nav-number">6.1.</span> <span class="nav-text">代码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-4版【2017-1-9下午】"><span class="nav-number">7.</span> <span class="nav-text">5.4版【2017.1.9下午】</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#代码-1"><span class="nav-number">7.1.</span> <span class="nav-text">代码</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script> <!--博客量统计-->
<div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Suvan</span>
</div>


<div class="powered-by">
   
  <!--
    由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
    -->
</div>

<div class="theme-info">
	能力决定走的多快，心态决定走的多远

  <!-- 主题
    主题 -
    <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
      NexT.Mist
    </a>
  -->
</div>


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.1"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.1"></script>


  

</body>
</html>
